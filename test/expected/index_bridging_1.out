CREATE SCHEMA index_bridging;
SET SESSION search_path = 'index_bridging';
CREATE EXTENSION orioledb;
\set VERBOSITY terse
CREATE EXTENSION pageinspect;
ERROR:  extension "pageinspect" is not available
\set VERBOSITY default
CREATE FUNCTION btree_index_content(index name)
	RETURNS TABLE (ctid tid, htid tid, tids tid[]) AS $$
	SELECT ctid, htid, tids FROM
			generate_series(2,
							(pg_relation_size(index::regclass) /
							current_setting('block_size')::BIGINT)) p,
			LATERAL bt_page_items(index, p - 1)
		ORDER BY ctid
$$ LANGUAGE SQL;
ERROR:  function bt_page_items(name, bigint) does not exist
LINE 7:    LATERAL bt_page_items(index, p - 1)
                   ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CREATE FUNCTION hash_index_content(index name) RETURNS TABLE (ctid tid) AS $$
	SELECT ctid FROM
		generate_series(2,
						(pg_relation_size(index::regclass) /
						 current_setting('block_size')::BIGINT)) p,
		LATERAL hash_page_type(get_raw_page(index, p - 1)) pt,
		LATERAL hash_page_items(get_raw_page(index, p - 1))
		WHERE pt = 'bucket'
		ORDER BY ctid
$$ LANGUAGE SQL;
ERROR:  function get_raw_page(name, bigint) does not exist
LINE 6:   LATERAL hash_page_type(get_raw_page(index, p - 1)) pt,
                                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CREATE FUNCTION gist_index_content(index name)
	RETURNS TABLE (ctid tid, keys text) AS $$
	SELECT ctid, keys FROM
			generate_series(1,
							(pg_relation_size(index::regclass) /
							current_setting('block_size')::BIGINT)) p,
			LATERAL gist_page_items(get_raw_page(index, p - 1), index::regclass)
		ORDER BY ctid
$$ LANGUAGE SQL;
ERROR:  function get_raw_page(name, bigint) does not exist
LINE 7:    LATERAL gist_page_items(get_raw_page(index, p - 1), index...
                                   ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CREATE TABLE o_test_ix_ams (
	i int NOT NULL,
	j int4[],
	p point,
	pk1 int,
	pk2 int
) USING orioledb;
SELECT orioledb_table_description('o_test_ix_ams'::regclass);
                orioledb_table_description                 
-----------------------------------------------------------
 Compress = -1, Primary compress = -1, TOAST compress = -1+
  Column |      Type | Collation | Nullable | Droped      +
       i |   integer |    (null) |    false |  false      +
       j | integer[] |    (null) |     true |  false      +
       p |     point |    (null) |     true |  false      +
     pk1 |   integer |    (null) |     true |  false      +
     pk2 |   integer |    (null) |     true |  false      +
 
(1 row)

\d+ o_test_ix_ams
                            Table "index_bridging.o_test_ix_ams"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
 pk1    | integer   |           |          |         | plain    |              | 
 pk2    | integer   |           |          |         | plain    |              | 

SELECT orioledb_tbl_indices('o_test_ix_ams'::regclass, true);
                orioledb_tbl_indices                 
-----------------------------------------------------
 Index ctid_primary                                 +
     Index type: primary, unique, ctid              +
     Leaf tuple size: 6, non-leaf tuple size: 1     +
     Non-leaf tuple fields: ctid                    +
     Leaf tuple fields: ctid, i, j, p, pk1, pk2     +
 Index toast                                        +
     Index type: secondary                          +
     Leaf tuple size: 4, non-leaf tuple size: 3     +
     Non-leaf tuple fields: ctid, attnum, chunknum  +
     Leaf tuple fields: ctid, attnum, chunknum, data+
 
(1 row)

INSERT INTO o_test_ix_ams VALUES (1, ARRAY[2,3], point(4, 5), 6, 7);
SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                            orioledb_tbl_structure                            
------------------------------------------------------------------------------
 Index ctid_primary contents                                                 +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                         +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty         +
     Leftmost, Rightmost                                                     +
   Chunk 0: offset = 0, location = 256, hikey location = 64                  +
     Item 0: offset = 264, tuple = ('(0,1)', '1', '{2,3}', '(4,5)', '6', '7')+
                                                                             +
 Index toast: not loaded                                                     +
 
(1 row)

EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams;
        QUERY PLAN         
---------------------------
 Seq Scan on o_test_ix_ams
(1 row)

SELECT * FROM o_test_ix_ams;
 i |   j   |   p   | pk1 | pk2 
---+-------+-------+-----+-----
 1 | {2,3} | (4,5) |   6 |   7
(1 row)

SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                            orioledb_tbl_structure                            
------------------------------------------------------------------------------
 Index ctid_primary contents                                                 +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                         +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty         +
     Leftmost, Rightmost                                                     +
   Chunk 0: offset = 0, location = 256, hikey location = 64                  +
     Item 0: offset = 264, tuple = ('(0,1)', '1', '{2,3}', '(4,5)', '6', '7')+
                                                                             +
 Index toast: not loaded                                                     +
 
(1 row)

CREATE INDEX o_test_ix_ams_ix1 on o_test_ix_ams using btree (j) WITH (orioledb_index = off, deduplicate_items = off);
WARNING:  using bridged btree index for orioledb
DETAIL:  This feature is intended for testing purposes and is not recommended for normal usage.
NOTICE:  index bridging is enabled for orioledb table 'o_test_ix_ams'
DETAIL:  index access method 'btree' is requested with index bridging for OrioleDB table
SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
ERROR:  function btree_index_content(unknown) does not exist
LINE 1: SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
\d+ o_test_ix_ams
                            Table "index_bridging.o_test_ix_ams"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
 pk1    | integer   |           |          |         | plain    |              | 
 pk2    | integer   |           |          |         | plain    |              | 
Indexes:
    "o_test_ix_ams_ix1" btree (j) WITH (orioledb_index=off, deduplicate_items=off)
Options: index_bridging=true

SELECT orioledb_tbl_indices('o_test_ix_ams'::regclass, true);
                        orioledb_tbl_indices                         
---------------------------------------------------------------------
 Index ctid_primary                                                 +
     Index type: primary, unique, ctid                              +
     Leaf tuple size: 7, non-leaf tuple size: 1                     +
     Non-leaf tuple fields: ctid                                    +
     Leaf tuple fields: ctid, index_bridging_ctid, i, j, p, pk1, pk2+
 Index index_bridge                                                 +
     Index type: secondary                                          +
     Leaf tuple size: 2, non-leaf tuple size: 1                     +
     Non-leaf tuple fields: index_bridging_ctid                     +
     Leaf tuple fields: index_bridging_ctid, ctid                   +
 Index toast                                                        +
     Index type: secondary                                          +
     Leaf tuple size: 4, non-leaf tuple size: 3                     +
     Non-leaf tuple fields: ctid, attnum, chunknum                  +
     Leaf tuple fields: ctid, attnum, chunknum, data                +
 
(1 row)

SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
ERROR:  function btree_index_content(unknown) does not exist
LINE 1: SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams ORDER BY j;
                     QUERY PLAN                      
-----------------------------------------------------
 Index Scan using o_test_ix_ams_ix1 on o_test_ix_ams
(1 row)

SELECT * FROM o_test_ix_ams ORDER BY j;
 i |   j   |   p   | pk1 | pk2 
---+-------+-------+-----+-----
 1 | {2,3} | (4,5) |   6 |   7
(1 row)

COMMIT;
SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                                orioledb_tbl_structure                                 
---------------------------------------------------------------------------------------
 Index ctid_primary contents                                                          +
 Page 0: level = 0, maxKeyLen = 6, nVacatedBytes = 0                                  +
 state = free, datoid equal, relnode equal, ix_type = primary, clean                  +
     Leftmost, Rightmost                                                              +
   Chunk 0: offset = 0, location = 256, hikey location = 64                           +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,1)', '1', '{2,3}', '(4,5)', '6', '7')+
                                                                                      +
 Index index_bridge contents                                                          +
 Page 0: level = 0, maxKeyLen = 6, nVacatedBytes = 0                                  +
 state = free, datoid equal, relnode equal, ix_type = bridge, clean                   +
     Leftmost, Rightmost                                                              +
   Chunk 0: offset = 0, location = 256, hikey location = 64                           +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,1)')                                 +
                                                                                      +
 Index toast: not loaded                                                              +
 
(1 row)

INSERT INTO o_test_ix_ams VALUES (10, ARRAY[20,30], point(40, 50), 60, 70);
SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                                    orioledb_tbl_structure                                    
----------------------------------------------------------------------------------------------
 Index ctid_primary contents                                                                 +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                         +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty                         +
     Leftmost, Rightmost                                                                     +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                  +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,1)', '1', '{2,3}', '(4,5)', '6', '7')       +
     Item 1: offset = 360, tuple = ('(0,2)', '(0,2)', '10', '{20,30}', '(40,50)', '60', '70')+
                                                                                             +
 Index index_bridge contents                                                                 +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                         +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty                          +
     Leftmost, Rightmost                                                                     +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                  +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,1)')                                        +
     Item 1: offset = 296, tuple = ('(0,2)', '(0,2)')                                        +
                                                                                             +
 Index toast: not loaded                                                                     +
 
(1 row)

SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
ERROR:  function btree_index_content(unknown) does not exist
LINE 1: SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams ORDER BY j;
                     QUERY PLAN                      
-----------------------------------------------------
 Index Scan using o_test_ix_ams_ix1 on o_test_ix_ams
(1 row)

SELECT * FROM o_test_ix_ams ORDER BY j;
 i  |    j    |    p    | pk1 | pk2 
----+---------+---------+-----+-----
  1 | {2,3}   | (4,5)   |   6 |   7
 10 | {20,30} | (40,50) |  60 |  70
(2 rows)

EXPLAIN (COSTS OFF)
	SELECT j FROM o_test_ix_ams ORDER BY j;
                        QUERY PLAN                        
----------------------------------------------------------
 Index Only Scan using o_test_ix_ams_ix1 on o_test_ix_ams
(1 row)

SELECT j FROM o_test_ix_ams ORDER BY j;
    j    
---------
 {2,3}
 {20,30}
(2 rows)

COMMIT;
SELECT orioledb_tbl_indices('o_test_ix_ams'::regclass, true);
                        orioledb_tbl_indices                         
---------------------------------------------------------------------
 Index ctid_primary                                                 +
     Index type: primary, unique, ctid                              +
     Leaf tuple size: 7, non-leaf tuple size: 1                     +
     Non-leaf tuple fields: ctid                                    +
     Leaf tuple fields: ctid, index_bridging_ctid, i, j, p, pk1, pk2+
 Index index_bridge                                                 +
     Index type: secondary                                          +
     Leaf tuple size: 2, non-leaf tuple size: 1                     +
     Non-leaf tuple fields: index_bridging_ctid                     +
     Leaf tuple fields: index_bridging_ctid, ctid                   +
 Index toast                                                        +
     Index type: secondary                                          +
     Leaf tuple size: 4, non-leaf tuple size: 3                     +
     Non-leaf tuple fields: ctid, attnum, chunknum                  +
     Leaf tuple fields: ctid, attnum, chunknum, data                +
 
(1 row)

ALTER TABLE o_test_ix_ams ADD PRIMARY KEY (pk2, pk1);
SELECT orioledb_tbl_indices('o_test_ix_ams'::regclass, true);
                     orioledb_tbl_indices                      
---------------------------------------------------------------
 Index o_test_ix_ams_pkey                                     +
     Index type: primary, unique                              +
     Leaf tuple size: 6, non-leaf tuple size: 2               +
     Non-leaf tuple fields: pk2, pk1                          +
     Leaf tuple fields: index_bridging_ctid, i, j, p, pk1, pk2+
 Index index_bridge                                           +
     Index type: secondary                                    +
     Leaf tuple size: 3, non-leaf tuple size: 1               +
     Non-leaf tuple fields: index_bridging_ctid               +
     Leaf tuple fields: index_bridging_ctid, pk2, pk1         +
 Index toast                                                  +
     Index type: secondary                                    +
     Leaf tuple size: 5, non-leaf tuple size: 4               +
     Non-leaf tuple fields: pk2, pk1, attnum, chunknum        +
     Leaf tuple fields: pk2, pk1, attnum, chunknum, data      +
 
(1 row)

SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                               orioledb_tbl_structure                                
-------------------------------------------------------------------------------------
 Index o_test_ix_ams_pkey contents                                                  +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                +
 state = free, datoid equal, relnode equal, ix_type = primary, clean                +
     Leftmost, Rightmost                                                            +
   Chunk 0: offset = 0, location = 256, hikey location = 64, hikey = ('70', '60')   +
     Item 0: offset = 264, tuple = ('(0,1)', '1', '{2,3}', '(4,5)', '6', '7')       +
   Chunk 1: offset = 1, location = 360, hikey location = 72                         +
     Item 1: offset = 368, tuple = ('(0,2)', '10', '{20,30}', '(40,50)', '60', '70')+
                                                                                    +
 Index index_bridge: not loaded                                                     +
 Index toast: not loaded                                                            +
 
(1 row)

EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams;
        QUERY PLAN         
---------------------------
 Seq Scan on o_test_ix_ams
(1 row)

SELECT * FROM o_test_ix_ams;
 i  |    j    |    p    | pk1 | pk2 
----+---------+---------+-----+-----
  1 | {2,3}   | (4,5)   |   6 |   7
 10 | {20,30} | (40,50) |  60 |  70
(2 rows)

SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
ERROR:  function btree_index_content(unknown) does not exist
LINE 1: SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams ORDER BY j;
                     QUERY PLAN                      
-----------------------------------------------------
 Index Scan using o_test_ix_ams_ix1 on o_test_ix_ams
(1 row)

SELECT * FROM o_test_ix_ams ORDER BY j;
 i  |    j    |    p    | pk1 | pk2 
----+---------+---------+-----+-----
  1 | {2,3}   | (4,5)   |   6 |   7
 10 | {20,30} | (40,50) |  60 |  70
(2 rows)

COMMIT;
SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                               orioledb_tbl_structure                                
-------------------------------------------------------------------------------------
 Index o_test_ix_ams_pkey contents                                                  +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                +
 state = free, datoid equal, relnode equal, ix_type = primary, clean                +
     Leftmost, Rightmost                                                            +
   Chunk 0: offset = 0, location = 256, hikey location = 64, hikey = ('70', '60')   +
     Item 0: offset = 264, tuple = ('(0,1)', '1', '{2,3}', '(4,5)', '6', '7')       +
   Chunk 1: offset = 1, location = 360, hikey location = 72                         +
     Item 1: offset = 368, tuple = ('(0,2)', '10', '{20,30}', '(40,50)', '60', '70')+
                                                                                    +
 Index index_bridge contents                                                        +
 Page 0: level = 0, maxKeyLen = 6, nVacatedBytes = 0                                +
 state = free, datoid equal, relnode equal, ix_type = bridge, clean                 +
     Leftmost, Rightmost                                                            +
   Chunk 0: offset = 0, location = 256, hikey location = 64, hikey = ('(0,2)')      +
     Item 0: offset = 264, tuple = ('(0,1)', '7', '6')                              +
   Chunk 1: offset = 1, location = 296, hikey location = 72                         +
     Item 1: offset = 304, tuple = ('(0,2)', '70', '60')                            +
                                                                                    +
 Index toast: not loaded                                                            +
 
(1 row)

INSERT INTO o_test_ix_ams VALUES (100, ARRAY[200,300], point(400, 500), 600, 700);
SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                                   orioledb_tbl_structure                                   
--------------------------------------------------------------------------------------------
 Index o_test_ix_ams_pkey contents                                                         +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                       +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty                       +
     Leftmost, Rightmost                                                                   +
   Chunk 0: offset = 0, location = 256, hikey location = 64, hikey = ('70', '60')          +
     Item 0: offset = 264, tuple = ('(0,1)', '1', '{2,3}', '(4,5)', '6', '7')              +
   Chunk 1: offset = 1, location = 360, hikey location = 72                                +
     Item 1: offset = 368, tuple = ('(0,2)', '10', '{20,30}', '(40,50)', '60', '70')       +
     Item 2: offset = 464, tuple = ('(0,3)', '100', '{200,300}', '(400,500)', '600', '700')+
                                                                                           +
 Index index_bridge contents                                                               +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                       +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty                        +
     Leftmost, Rightmost                                                                   +
   Chunk 0: offset = 0, location = 256, hikey location = 64, hikey = ('(0,2)')             +
     Item 0: offset = 264, tuple = ('(0,1)', '7', '6')                                     +
   Chunk 1: offset = 1, location = 296, hikey location = 72                                +
     Item 1: offset = 304, tuple = ('(0,2)', '70', '60')                                   +
     Item 2: offset = 336, tuple = ('(0,3)', '700', '600')                                 +
                                                                                           +
 Index toast: not loaded                                                                   +
 
(1 row)

EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams;
        QUERY PLAN         
---------------------------
 Seq Scan on o_test_ix_ams
(1 row)

SELECT * FROM o_test_ix_ams;
  i  |     j     |     p     | pk1 | pk2 
-----+-----------+-----------+-----+-----
   1 | {2,3}     | (4,5)     |   6 |   7
  10 | {20,30}   | (40,50)   |  60 |  70
 100 | {200,300} | (400,500) | 600 | 700
(3 rows)

SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
ERROR:  function btree_index_content(unknown) does not exist
LINE 1: SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams ORDER BY j;
                     QUERY PLAN                      
-----------------------------------------------------
 Index Scan using o_test_ix_ams_ix1 on o_test_ix_ams
(1 row)

SELECT * FROM o_test_ix_ams ORDER BY j;
  i  |     j     |     p     | pk1 | pk2 
-----+-----------+-----------+-----+-----
   1 | {2,3}     | (4,5)     |   6 |   7
  10 | {20,30}   | (40,50)   |  60 |  70
 100 | {200,300} | (400,500) | 600 | 700
(3 rows)

COMMIT;
SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                                   orioledb_tbl_structure                                   
--------------------------------------------------------------------------------------------
 Index o_test_ix_ams_pkey contents                                                         +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                       +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty                       +
     Leftmost, Rightmost                                                                   +
   Chunk 0: offset = 0, location = 256, hikey location = 64, hikey = ('70', '60')          +
     Item 0: offset = 264, tuple = ('(0,1)', '1', '{2,3}', '(4,5)', '6', '7')              +
   Chunk 1: offset = 1, location = 360, hikey location = 72                                +
     Item 1: offset = 368, tuple = ('(0,2)', '10', '{20,30}', '(40,50)', '60', '70')       +
     Item 2: offset = 464, tuple = ('(0,3)', '100', '{200,300}', '(400,500)', '600', '700')+
                                                                                           +
 Index index_bridge contents                                                               +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                       +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty                        +
     Leftmost, Rightmost                                                                   +
   Chunk 0: offset = 0, location = 256, hikey location = 64, hikey = ('(0,2)')             +
     Item 0: offset = 264, tuple = ('(0,1)', '7', '6')                                     +
   Chunk 1: offset = 1, location = 296, hikey location = 72                                +
     Item 1: offset = 304, tuple = ('(0,2)', '70', '60')                                   +
     Item 2: offset = 336, tuple = ('(0,3)', '700', '600')                                 +
                                                                                           +
 Index toast: not loaded                                                                   +
 
(1 row)

SELECT orioledb_tbl_indices('o_test_ix_ams'::regclass, true);
                     orioledb_tbl_indices                      
---------------------------------------------------------------
 Index o_test_ix_ams_pkey                                     +
     Index type: primary, unique                              +
     Leaf tuple size: 6, non-leaf tuple size: 2               +
     Non-leaf tuple fields: pk2, pk1                          +
     Leaf tuple fields: index_bridging_ctid, i, j, p, pk1, pk2+
 Index index_bridge                                           +
     Index type: secondary                                    +
     Leaf tuple size: 3, non-leaf tuple size: 1               +
     Non-leaf tuple fields: index_bridging_ctid               +
     Leaf tuple fields: index_bridging_ctid, pk2, pk1         +
 Index toast                                                  +
     Index type: secondary                                    +
     Leaf tuple size: 5, non-leaf tuple size: 4               +
     Non-leaf tuple fields: pk2, pk1, attnum, chunknum        +
     Leaf tuple fields: pk2, pk1, attnum, chunknum, data      +
 
(1 row)

ALTER TABLE o_test_ix_ams DROP CONSTRAINT o_test_ix_ams_pkey;
SELECT orioledb_tbl_indices('o_test_ix_ams'::regclass, true);
                        orioledb_tbl_indices                         
---------------------------------------------------------------------
 Index ctid_primary                                                 +
     Index type: primary, unique, ctid                              +
     Leaf tuple size: 7, non-leaf tuple size: 1                     +
     Non-leaf tuple fields: ctid                                    +
     Leaf tuple fields: ctid, index_bridging_ctid, i, j, p, pk1, pk2+
 Index index_bridge                                                 +
     Index type: secondary                                          +
     Leaf tuple size: 2, non-leaf tuple size: 1                     +
     Non-leaf tuple fields: index_bridging_ctid                     +
     Leaf tuple fields: index_bridging_ctid, ctid                   +
 Index toast                                                        +
     Index type: secondary                                          +
     Leaf tuple size: 4, non-leaf tuple size: 3                     +
     Non-leaf tuple fields: ctid, attnum, chunknum                  +
     Leaf tuple fields: ctid, attnum, chunknum, data                +
 
(1 row)

EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams;
        QUERY PLAN         
---------------------------
 Seq Scan on o_test_ix_ams
(1 row)

SELECT * FROM o_test_ix_ams;
  i  |     j     |     p     | pk1 | pk2 
-----+-----------+-----------+-----+-----
   1 | {2,3}     | (4,5)     |   6 |   7
  10 | {20,30}   | (40,50)   |  60 |  70
 100 | {200,300} | (400,500) | 600 | 700
(3 rows)

SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                                       orioledb_tbl_structure                                        
-----------------------------------------------------------------------------------------------------
 Index ctid_primary contents                                                                        +
 Page 0: level = 0, maxKeyLen = 6, nVacatedBytes = 0                                                +
 state = free, datoid equal, relnode equal, ix_type = primary, clean                                +
     Leftmost, Rightmost                                                                            +
   Chunk 0: offset = 0, location = 256, hikey location = 72, hikey = ('(0,2)')                      +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,1)', '1', '{2,3}', '(4,5)', '6', '7')              +
   Chunk 1: offset = 1, location = 360, hikey location = 80, hikey = ('(0,3)')                      +
     Item 1: offset = 368, tuple = ('(0,2)', '(0,2)', '10', '{20,30}', '(40,50)', '60', '70')       +
   Chunk 2: offset = 2, location = 464, hikey location = 88                                         +
     Item 2: offset = 472, tuple = ('(0,3)', '(0,3)', '100', '{200,300}', '(400,500)', '600', '700')+
                                                                                                    +
 Index index_bridge: not loaded                                                                     +
 Index toast: not loaded                                                                            +
 
(1 row)

SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
ERROR:  function btree_index_content(unknown) does not exist
LINE 1: SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams ORDER BY j;
                     QUERY PLAN                      
-----------------------------------------------------
 Index Scan using o_test_ix_ams_ix1 on o_test_ix_ams
(1 row)

SELECT * FROM o_test_ix_ams ORDER BY j;
  i  |     j     |     p     | pk1 | pk2 
-----+-----------+-----------+-----+-----
   1 | {2,3}     | (4,5)     |   6 |   7
  10 | {20,30}   | (40,50)   |  60 |  70
 100 | {200,300} | (400,500) | 600 | 700
(3 rows)

COMMIT;
SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                                       orioledb_tbl_structure                                        
-----------------------------------------------------------------------------------------------------
 Index ctid_primary contents                                                                        +
 Page 0: level = 0, maxKeyLen = 6, nVacatedBytes = 0                                                +
 state = free, datoid equal, relnode equal, ix_type = primary, clean                                +
     Leftmost, Rightmost                                                                            +
   Chunk 0: offset = 0, location = 256, hikey location = 72, hikey = ('(0,2)')                      +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,1)', '1', '{2,3}', '(4,5)', '6', '7')              +
   Chunk 1: offset = 1, location = 360, hikey location = 80, hikey = ('(0,3)')                      +
     Item 1: offset = 368, tuple = ('(0,2)', '(0,2)', '10', '{20,30}', '(40,50)', '60', '70')       +
   Chunk 2: offset = 2, location = 464, hikey location = 88                                         +
     Item 2: offset = 472, tuple = ('(0,3)', '(0,3)', '100', '{200,300}', '(400,500)', '600', '700')+
                                                                                                    +
 Index index_bridge contents                                                                        +
 Page 0: level = 0, maxKeyLen = 6, nVacatedBytes = 0                                                +
 state = free, datoid equal, relnode equal, ix_type = bridge, clean                                 +
     Leftmost, Rightmost                                                                            +
   Chunk 0: offset = 0, location = 256, hikey location = 72, hikey = ('(0,2)')                      +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,1)')                                               +
   Chunk 1: offset = 1, location = 296, hikey location = 80, hikey = ('(0,3)')                      +
     Item 1: offset = 304, tuple = ('(0,2)', '(0,2)')                                               +
   Chunk 2: offset = 2, location = 336, hikey location = 88                                         +
     Item 2: offset = 344, tuple = ('(0,3)', '(0,3)')                                               +
                                                                                                    +
 Index toast: not loaded                                                                            +
 
(1 row)

SELECT orioledb_table_description('o_test_ix_ams'::regclass);
                orioledb_table_description                 
-----------------------------------------------------------
 Compress = -1, Primary compress = -1, TOAST compress = -1+
  Column |      Type | Collation | Nullable | Droped      +
       i |   integer |    (null) |    false |  false      +
       j | integer[] |    (null) |     true |  false      +
       p |     point |    (null) |     true |  false      +
     pk1 |   integer |    (null) |    false |  false      +
     pk2 |   integer |    (null) |    false |  false      +
 
(1 row)

SELECT orioledb_tbl_indices('o_test_ix_ams'::regclass, true);
                        orioledb_tbl_indices                         
---------------------------------------------------------------------
 Index ctid_primary                                                 +
     Index type: primary, unique, ctid                              +
     Leaf tuple size: 7, non-leaf tuple size: 1                     +
     Non-leaf tuple fields: ctid                                    +
     Leaf tuple fields: ctid, index_bridging_ctid, i, j, p, pk1, pk2+
 Index index_bridge                                                 +
     Index type: secondary                                          +
     Leaf tuple size: 2, non-leaf tuple size: 1                     +
     Non-leaf tuple fields: index_bridging_ctid                     +
     Leaf tuple fields: index_bridging_ctid, ctid                   +
 Index toast                                                        +
     Index type: secondary                                          +
     Leaf tuple size: 4, non-leaf tuple size: 3                     +
     Non-leaf tuple fields: ctid, attnum, chunknum                  +
     Leaf tuple fields: ctid, attnum, chunknum, data                +
 
(1 row)

ALTER TABLE o_test_ix_ams ALTER j TYPE int USING 200-j[1];
SELECT orioledb_table_description('o_test_ix_ams'::regclass);
                orioledb_table_description                 
-----------------------------------------------------------
 Compress = -1, Primary compress = -1, TOAST compress = -1+
  Column |    Type | Collation | Nullable | Droped        +
       i | integer |    (null) |    false |  false        +
       j | integer |    (null) |     true |  false        +
       p |   point |    (null) |     true |  false        +
     pk1 | integer |    (null) |    false |  false        +
     pk2 | integer |    (null) |    false |  false        +
 
(1 row)

SELECT orioledb_tbl_indices('o_test_ix_ams'::regclass, true);
                        orioledb_tbl_indices                         
---------------------------------------------------------------------
 Index ctid_primary                                                 +
     Index type: primary, unique, ctid                              +
     Leaf tuple size: 7, non-leaf tuple size: 1                     +
     Non-leaf tuple fields: ctid                                    +
     Leaf tuple fields: ctid, index_bridging_ctid, i, j, p, pk1, pk2+
 Index index_bridge                                                 +
     Index type: secondary                                          +
     Leaf tuple size: 2, non-leaf tuple size: 1                     +
     Non-leaf tuple fields: index_bridging_ctid                     +
     Leaf tuple fields: index_bridging_ctid, ctid                   +
 Index toast                                                        +
     Index type: secondary                                          +
     Leaf tuple size: 4, non-leaf tuple size: 3                     +
     Non-leaf tuple fields: ctid, attnum, chunknum                  +
     Leaf tuple fields: ctid, attnum, chunknum, data                +
 
(1 row)

EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams;
        QUERY PLAN         
---------------------------
 Seq Scan on o_test_ix_ams
(1 row)

SELECT * FROM o_test_ix_ams;
  i  |  j  |     p     | pk1 | pk2 
-----+-----+-----------+-----+-----
   1 | 198 | (4,5)     |   6 |   7
  10 | 180 | (40,50)   |  60 |  70
 100 |   0 | (400,500) | 600 | 700
(3 rows)

SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
ERROR:  function btree_index_content(unknown) does not exist
LINE 1: SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams ORDER BY j;
                     QUERY PLAN                      
-----------------------------------------------------
 Index Scan using o_test_ix_ams_ix1 on o_test_ix_ams
(1 row)

SELECT * FROM o_test_ix_ams ORDER BY j;
  i  |  j  |     p     | pk1 | pk2 
-----+-----+-----------+-----+-----
 100 |   0 | (400,500) | 600 | 700
  10 | 180 | (40,50)   |  60 |  70
   1 | 198 | (4,5)     |   6 |   7
(3 rows)

COMMIT;
SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                                   orioledb_tbl_structure                                    
---------------------------------------------------------------------------------------------
 Index ctid_primary contents                                                                +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                        +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty                        +
     Leftmost, Rightmost                                                                    +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                 +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,1)', '1', '198', '(4,5)', '6', '7')        +
     Item 1: offset = 336, tuple = ('(0,2)', '(0,2)', '10', '180', '(40,50)', '60', '70')   +
     Item 2: offset = 408, tuple = ('(0,3)', '(0,3)', '100', '0', '(400,500)', '600', '700')+
                                                                                            +
 Index index_bridge contents                                                                +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                        +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty                         +
     Leftmost, Rightmost                                                                    +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                 +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,1)')                                       +
     Item 1: offset = 296, tuple = ('(0,2)', '(0,2)')                                       +
     Item 2: offset = 328, tuple = ('(0,3)', '(0,3)')                                       +
                                                                                            +
 Index toast: not loaded                                                                    +
 
(1 row)

ALTER TABLE o_test_ix_ams ADD COLUMN k int;
SELECT orioledb_tbl_indices('o_test_ix_ams'::regclass, true);
                          orioledb_tbl_indices                          
------------------------------------------------------------------------
 Index ctid_primary                                                    +
     Index type: primary, unique, ctid                                 +
     Leaf tuple size: 8, non-leaf tuple size: 1                        +
     Non-leaf tuple fields: ctid                                       +
     Leaf tuple fields: ctid, index_bridging_ctid, i, j, p, pk1, pk2, k+
 Index index_bridge                                                    +
     Index type: secondary                                             +
     Leaf tuple size: 2, non-leaf tuple size: 1                        +
     Non-leaf tuple fields: index_bridging_ctid                        +
     Leaf tuple fields: index_bridging_ctid, ctid                      +
 Index toast                                                           +
     Index type: secondary                                             +
     Leaf tuple size: 4, non-leaf tuple size: 3                        +
     Non-leaf tuple fields: ctid, attnum, chunknum                     +
     Leaf tuple fields: ctid, attnum, chunknum, data                   +
 
(1 row)

SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
ERROR:  function btree_index_content(unknown) does not exist
LINE 1: SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams ORDER BY j;
                     QUERY PLAN                      
-----------------------------------------------------
 Index Scan using o_test_ix_ams_ix1 on o_test_ix_ams
(1 row)

SELECT * FROM o_test_ix_ams ORDER BY j;
  i  |  j  |     p     | pk1 | pk2 | k 
-----+-----+-----------+-----+-----+---
 100 |   0 | (400,500) | 600 | 700 |  
  10 | 180 | (40,50)   |  60 |  70 |  
   1 | 198 | (4,5)     |   6 |   7 |  
(3 rows)

COMMIT;
SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                                      orioledb_tbl_structure                                       
---------------------------------------------------------------------------------------------------
 Index ctid_primary contents                                                                      +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                              +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty                              +
     Leftmost, Rightmost                                                                          +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                       +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,1)', '1', '198', '(4,5)', '6', '7', null)        +
     Item 1: offset = 336, tuple = ('(0,2)', '(0,2)', '10', '180', '(40,50)', '60', '70', null)   +
     Item 2: offset = 408, tuple = ('(0,3)', '(0,3)', '100', '0', '(400,500)', '600', '700', null)+
                                                                                                  +
 Index index_bridge contents                                                                      +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                              +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty                               +
     Leftmost, Rightmost                                                                          +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                       +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,1)')                                             +
     Item 1: offset = 296, tuple = ('(0,2)', '(0,2)')                                             +
     Item 2: offset = 328, tuple = ('(0,3)', '(0,3)')                                             +
                                                                                                  +
 Index toast: not loaded                                                                          +
 
(1 row)

\d+ o_test_ix_ams
                           Table "index_bridging.o_test_ix_ams"
 Column |  Type   | Collation | Nullable | Default | Storage | Stats target | Description 
--------+---------+-----------+----------+---------+---------+--------------+-------------
 i      | integer |           | not null |         | plain   |              | 
 j      | integer |           |          |         | plain   |              | 
 p      | point   |           |          |         | plain   |              | 
 pk1    | integer |           | not null |         | plain   |              | 
 pk2    | integer |           | not null |         | plain   |              | 
 k      | integer |           |          |         | plain   |              | 
Indexes:
    "o_test_ix_ams_ix1" btree (j) WITH (orioledb_index=off, deduplicate_items=off)
Options: index_bridging=true

-- Don't update bridge_index when updated column not indexed by any bridged index
UPDATE o_test_ix_ams SET p = point(i * 40 + 1, i * 5);
SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                                       orioledb_tbl_structure                                       
----------------------------------------------------------------------------------------------------
 Index ctid_primary contents                                                                       +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                               +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty                               +
     Leftmost, Rightmost                                                                           +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                        +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,1)', '1', '198', '(41,5)', '6', '7', null)        +
     Item 1: offset = 344, tuple = ('(0,2)', '(0,2)', '10', '180', '(401,50)', '60', '70', null)   +
     Item 2: offset = 424, tuple = ('(0,3)', '(0,3)', '100', '0', '(4001,500)', '600', '700', null)+
                                                                                                   +
 Index index_bridge contents                                                                       +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                               +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty                                +
     Leftmost, Rightmost                                                                           +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                        +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,1)')                                              +
     Item 1: offset = 296, tuple = ('(0,2)', '(0,2)')                                              +
     Item 2: offset = 328, tuple = ('(0,3)', '(0,3)')                                              +
                                                                                                   +
 Index toast: not loaded                                                                           +
 
(1 row)

SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
ERROR:  function btree_index_content(unknown) does not exist
LINE 1: SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams ORDER BY j;
                     QUERY PLAN                      
-----------------------------------------------------
 Index Scan using o_test_ix_ams_ix1 on o_test_ix_ams
(1 row)

SELECT * FROM o_test_ix_ams ORDER BY j;
  i  |  j  |     p      | pk1 | pk2 | k 
-----+-----+------------+-----+-----+---
 100 |   0 | (4001,500) | 600 | 700 |  
  10 | 180 | (401,50)   |  60 |  70 |  
   1 | 198 | (41,5)     |   6 |   7 |  
(3 rows)

COMMIT;
-- Now it should update bridging_ctid-s
UPDATE o_test_ix_ams SET j = j/2 + 1000;
SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                                        orioledb_tbl_structure                                         
-------------------------------------------------------------------------------------------------------
 Index ctid_primary contents                                                                          +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                                  +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty                                  +
     Leftmost, Rightmost                                                                              +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                           +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,4)', '1', '1099', '(41,5)', '6', '7', null)          +
     Item 1: offset = 344, tuple = ('(0,2)', '(0,5)', '10', '1090', '(401,50)', '60', '70', null)     +
     Item 2: offset = 424, tuple = ('(0,3)', '(0,6)', '100', '1000', '(4001,500)', '600', '700', null)+
                                                                                                      +
 Index index_bridge contents                                                                          +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                                  +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty                                   +
     Leftmost, Rightmost                                                                              +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                           +
     Item 0: deleted, offset = 272, tuple = ('(0,1)', '(0,1)')                                        +
     Item 1: deleted, offset = 304, tuple = ('(0,2)', '(0,2)')                                        +
     Item 2: deleted, offset = 336, tuple = ('(0,3)', '(0,3)')                                        +
     Item 3: offset = 368, tuple = ('(0,4)', '(0,1)')                                                 +
     Item 4: offset = 400, tuple = ('(0,5)', '(0,2)')                                                 +
     Item 5: offset = 432, tuple = ('(0,6)', '(0,3)')                                                 +
                                                                                                      +
 Index toast: not loaded                                                                              +
 
(1 row)

-- Rows with new bridging_ctid now not stored in o_test_ix_ams_ix1
SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
ERROR:  function btree_index_content(unknown) does not exist
LINE 1: SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams ORDER BY j;
                     QUERY PLAN                      
-----------------------------------------------------
 Index Scan using o_test_ix_ams_ix1 on o_test_ix_ams
(1 row)

SELECT * FROM o_test_ix_ams ORDER BY j;
  i  |  j   |     p      | pk1 | pk2 | k 
-----+------+------------+-----+-----+---
 100 | 1000 | (4001,500) | 600 | 700 |  
  10 | 1090 | (401,50)   |  60 |  70 |  
   1 | 1099 | (41,5)     |   6 |   7 |  
(3 rows)

COMMIT;
-- After reindex new rows should be visible
REINDEX INDEX o_test_ix_ams_ix1;
SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
ERROR:  function btree_index_content(unknown) does not exist
LINE 1: SELECT * FROM btree_index_content('o_test_ix_ams_ix1');
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams ORDER BY j;
                     QUERY PLAN                      
-----------------------------------------------------
 Index Scan using o_test_ix_ams_ix1 on o_test_ix_ams
(1 row)

SELECT * FROM o_test_ix_ams ORDER BY j;
  i  |  j   |     p      | pk1 | pk2 | k 
-----+------+------------+-----+-----+---
 100 | 1000 | (4001,500) | 600 | 700 |  
  10 | 1090 | (401,50)   |  60 |  70 |  
   1 | 1099 | (41,5)     |   6 |   7 |  
(3 rows)

COMMIT;
CREATE INDEX o_test_ix_ams_ix2 on o_test_ix_ams using btree (k) WITH (orioledb_index = off, deduplicate_items = off);
WARNING:  using bridged btree index for orioledb
DETAIL:  This feature is intended for testing purposes and is not recommended for normal usage.
SELECT orioledb_tbl_indices('o_test_ix_ams'::regclass, true);
                          orioledb_tbl_indices                          
------------------------------------------------------------------------
 Index ctid_primary                                                    +
     Index type: primary, unique, ctid                                 +
     Leaf tuple size: 8, non-leaf tuple size: 1                        +
     Non-leaf tuple fields: ctid                                       +
     Leaf tuple fields: ctid, index_bridging_ctid, i, j, p, pk1, pk2, k+
 Index index_bridge                                                    +
     Index type: secondary                                             +
     Leaf tuple size: 2, non-leaf tuple size: 1                        +
     Non-leaf tuple fields: index_bridging_ctid                        +
     Leaf tuple fields: index_bridging_ctid, ctid                      +
 Index toast                                                           +
     Index type: secondary                                             +
     Leaf tuple size: 4, non-leaf tuple size: 3                        +
     Non-leaf tuple fields: ctid, attnum, chunknum                     +
     Leaf tuple fields: ctid, attnum, chunknum, data                   +
 
(1 row)

SELECT * FROM btree_index_content('o_test_ix_ams_ix2');
ERROR:  function btree_index_content(unknown) does not exist
LINE 1: SELECT * FROM btree_index_content('o_test_ix_ams_ix2');
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams ORDER BY k;
                     QUERY PLAN                      
-----------------------------------------------------
 Index Scan using o_test_ix_ams_ix2 on o_test_ix_ams
(1 row)

SELECT * FROM o_test_ix_ams ORDER BY k;
  i  |  j   |     p      | pk1 | pk2 | k 
-----+------+------------+-----+-----+---
   1 | 1099 | (41,5)     |   6 |   7 |  
  10 | 1090 | (401,50)   |  60 |  70 |  
 100 | 1000 | (4001,500) | 600 | 700 |  
(3 rows)

COMMIT;
SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                                        orioledb_tbl_structure                                         
-------------------------------------------------------------------------------------------------------
 Index ctid_primary contents                                                                          +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                                  +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty                                  +
     Leftmost, Rightmost                                                                              +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                           +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,4)', '1', '1099', '(41,5)', '6', '7', null)          +
     Item 1: offset = 344, tuple = ('(0,2)', '(0,5)', '10', '1090', '(401,50)', '60', '70', null)     +
     Item 2: offset = 424, tuple = ('(0,3)', '(0,6)', '100', '1000', '(4001,500)', '600', '700', null)+
                                                                                                      +
 Index index_bridge contents                                                                          +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                                  +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty                                   +
     Leftmost, Rightmost                                                                              +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                           +
     Item 0: deleted, offset = 272, tuple = ('(0,1)', '(0,1)')                                        +
     Item 1: deleted, offset = 304, tuple = ('(0,2)', '(0,2)')                                        +
     Item 2: deleted, offset = 336, tuple = ('(0,3)', '(0,3)')                                        +
     Item 3: offset = 368, tuple = ('(0,4)', '(0,1)')                                                 +
     Item 4: offset = 400, tuple = ('(0,5)', '(0,2)')                                                 +
     Item 5: offset = 432, tuple = ('(0,6)', '(0,3)')                                                 +
                                                                                                      +
 Index toast: not loaded                                                                              +
 
(1 row)

INSERT INTO o_test_ix_ams VALUES (1000, 2000, point(4000, 5000), 6000, 7000, 8000);
SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                                           orioledb_tbl_structure                                            
-------------------------------------------------------------------------------------------------------------
 Index ctid_primary contents                                                                                +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                                        +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty                                        +
     Leftmost, Rightmost                                                                                    +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                                 +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,4)', '1', '1099', '(41,5)', '6', '7', null)                +
     Item 1: offset = 344, tuple = ('(0,2)', '(0,5)', '10', '1090', '(401,50)', '60', '70', null)           +
     Item 2: offset = 424, tuple = ('(0,3)', '(0,6)', '100', '1000', '(4001,500)', '600', '700', null)      +
     Item 3: offset = 504, tuple = ('(0,4)', '(0,7)', '1000', '2000', '(4000,5000)', '6000', '7000', '8000')+
                                                                                                            +
 Index index_bridge contents                                                                                +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                                        +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty                                         +
     Leftmost, Rightmost                                                                                    +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                                 +
     Item 0: deleted, offset = 272, tuple = ('(0,1)', '(0,1)')                                              +
     Item 1: deleted, offset = 304, tuple = ('(0,2)', '(0,2)')                                              +
     Item 2: deleted, offset = 336, tuple = ('(0,3)', '(0,3)')                                              +
     Item 3: offset = 368, tuple = ('(0,4)', '(0,1)')                                                       +
     Item 4: offset = 400, tuple = ('(0,5)', '(0,2)')                                                       +
     Item 5: offset = 432, tuple = ('(0,6)', '(0,3)')                                                       +
     Item 6: offset = 464, tuple = ('(0,7)', '(0,4)')                                                       +
                                                                                                            +
 Index toast: not loaded                                                                                    +
 
(1 row)

SELECT * FROM btree_index_content('o_test_ix_ams_ix2');
ERROR:  function btree_index_content(unknown) does not exist
LINE 1: SELECT * FROM btree_index_content('o_test_ix_ams_ix2');
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams ORDER BY k;
                     QUERY PLAN                      
-----------------------------------------------------
 Index Scan using o_test_ix_ams_ix2 on o_test_ix_ams
(1 row)

SELECT * FROM o_test_ix_ams ORDER BY k;
  i   |  j   |      p      | pk1  | pk2  |  k   
------+------+-------------+------+------+------
 1000 | 2000 | (4000,5000) | 6000 | 7000 | 8000
    1 | 1099 | (41,5)      |    6 |    7 |     
   10 | 1090 | (401,50)    |   60 |   70 |     
  100 | 1000 | (4001,500)  |  600 |  700 |     
(4 rows)

COMMIT;
DROP INDEX o_test_ix_ams_ix2;
UPDATE o_test_ix_ams SET k = j WHERE i < 1000;
UPDATE o_test_ix_ams SET k = 8000 WHERE i = 1000;
CREATE INDEX o_test_ix_ams_hash_ix ON o_test_ix_ams USING hash (k);
\d+ o_test_ix_ams
                           Table "index_bridging.o_test_ix_ams"
 Column |  Type   | Collation | Nullable | Default | Storage | Stats target | Description 
--------+---------+-----------+----------+---------+---------+--------------+-------------
 i      | integer |           | not null |         | plain   |              | 
 j      | integer |           |          |         | plain   |              | 
 p      | point   |           |          |         | plain   |              | 
 pk1    | integer |           | not null |         | plain   |              | 
 pk2    | integer |           | not null |         | plain   |              | 
 k      | integer |           |          |         | plain   |              | 
Indexes:
    "o_test_ix_ams_hash_ix" hash (k)
    "o_test_ix_ams_ix1" btree (j) WITH (orioledb_index=off, deduplicate_items=off)
Options: index_bridging=true

SELECT orioledb_tbl_indices('o_test_ix_ams'::regclass, true);
                          orioledb_tbl_indices                          
------------------------------------------------------------------------
 Index ctid_primary                                                    +
     Index type: primary, unique, ctid                                 +
     Leaf tuple size: 8, non-leaf tuple size: 1                        +
     Non-leaf tuple fields: ctid                                       +
     Leaf tuple fields: ctid, index_bridging_ctid, i, j, p, pk1, pk2, k+
 Index index_bridge                                                    +
     Index type: secondary                                             +
     Leaf tuple size: 2, non-leaf tuple size: 1                        +
     Non-leaf tuple fields: index_bridging_ctid                        +
     Leaf tuple fields: index_bridging_ctid, ctid                      +
 Index toast                                                           +
     Index type: secondary                                             +
     Leaf tuple size: 4, non-leaf tuple size: 3                        +
     Non-leaf tuple fields: ctid, attnum, chunknum                     +
     Leaf tuple fields: ctid, attnum, chunknum, data                   +
 
(1 row)

SELECT * FROM hash_index_content('o_test_ix_ams_hash_ix');
ERROR:  function hash_index_content(unknown) does not exist
LINE 1: SELECT * FROM hash_index_content('o_test_ix_ams_hash_ix');
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams WHERE k = 8000;
                       QUERY PLAN                        
---------------------------------------------------------
 Index Scan using o_test_ix_ams_hash_ix on o_test_ix_ams
   Index Cond: (k = 8000)
(2 rows)

SELECT * FROM o_test_ix_ams WHERE k = 8000;
  i   |  j   |      p      | pk1  | pk2  |  k   
------+------+-------------+------+------+------
 1000 | 2000 | (4000,5000) | 6000 | 7000 | 8000
(1 row)

COMMIT;
-- Test bitmap scans
BEGIN;
SET LOCAL enable_seqscan = off;
SET LOCAL enable_indexscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams WHERE j < 2100;
                  QUERY PLAN                  
----------------------------------------------
 Custom Scan (o_scan) on o_test_ix_ams
   Bitmap heap scan
   Recheck Cond: (j < 2100)
   ->  Bitmap Index Scan on o_test_ix_ams_ix1
         Index Cond: (j < 2100)
(5 rows)

SELECT * FROM o_test_ix_ams WHERE j < 2100;
  i   |  j   |      p      | pk1  | pk2  |  k   
------+------+-------------+------+------+------
    1 | 1099 | (41,5)      |    6 |    7 | 1099
   10 | 1090 | (401,50)    |   60 |   70 | 1090
  100 | 1000 | (4001,500)  |  600 |  700 | 1000
 1000 | 2000 | (4000,5000) | 6000 | 7000 | 8000
(4 rows)

COMMIT;
BEGIN;
SET LOCAL enable_seqscan = off;
SET LOCAL enable_indexscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams WHERE k = 8000;
                    QUERY PLAN                    
--------------------------------------------------
 Custom Scan (o_scan) on o_test_ix_ams
   Bitmap heap scan
   Recheck Cond: (k = 8000)
   ->  Bitmap Index Scan on o_test_ix_ams_hash_ix
         Index Cond: (k = 8000)
(5 rows)

SELECT * FROM o_test_ix_ams WHERE k = 8000;
  i   |  j   |      p      | pk1  | pk2  |  k   
------+------+-------------+------+------+------
 1000 | 2000 | (4000,5000) | 6000 | 7000 | 8000
(1 row)

COMMIT;
SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                                           orioledb_tbl_structure                                            
-------------------------------------------------------------------------------------------------------------
 Index ctid_primary contents                                                                                +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                                        +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty                                        +
     Leftmost, Rightmost                                                                                    +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                                 +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,4)', '1', '1099', '(41,5)', '6', '7', '1099')              +
     Item 1: offset = 344, tuple = ('(0,2)', '(0,5)', '10', '1090', '(401,50)', '60', '70', '1090')         +
     Item 2: offset = 424, tuple = ('(0,3)', '(0,6)', '100', '1000', '(4001,500)', '600', '700', '1000')    +
     Item 3: offset = 504, tuple = ('(0,4)', '(0,7)', '1000', '2000', '(4000,5000)', '6000', '7000', '8000')+
                                                                                                            +
 Index index_bridge contents                                                                                +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                                        +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty                                         +
     Leftmost, Rightmost                                                                                    +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                                 +
     Item 0: deleted, offset = 272, tuple = ('(0,1)', '(0,1)')                                              +
     Item 1: deleted, offset = 304, tuple = ('(0,2)', '(0,2)')                                              +
     Item 2: deleted, offset = 336, tuple = ('(0,3)', '(0,3)')                                              +
     Item 3: offset = 368, tuple = ('(0,4)', '(0,1)')                                                       +
     Item 4: offset = 400, tuple = ('(0,5)', '(0,2)')                                                       +
     Item 5: offset = 432, tuple = ('(0,6)', '(0,3)')                                                       +
     Item 6: offset = 464, tuple = ('(0,7)', '(0,4)')                                                       +
                                                                                                            +
 Index toast: not loaded                                                                                    +
 
(1 row)

ALTER TABLE o_test_ix_ams ADD COLUMN r int4[];
SELECT orioledb_tbl_indices('o_test_ix_ams'::regclass, true);
                           orioledb_tbl_indices                            
---------------------------------------------------------------------------
 Index ctid_primary                                                       +
     Index type: primary, unique, ctid                                    +
     Leaf tuple size: 9, non-leaf tuple size: 1                           +
     Non-leaf tuple fields: ctid                                          +
     Leaf tuple fields: ctid, index_bridging_ctid, i, j, p, pk1, pk2, k, r+
 Index index_bridge                                                       +
     Index type: secondary                                                +
     Leaf tuple size: 2, non-leaf tuple size: 1                           +
     Non-leaf tuple fields: index_bridging_ctid                           +
     Leaf tuple fields: index_bridging_ctid, ctid                         +
 Index toast                                                              +
     Index type: secondary                                                +
     Leaf tuple size: 4, non-leaf tuple size: 3                           +
     Non-leaf tuple fields: ctid, attnum, chunknum                        +
     Leaf tuple fields: ctid, attnum, chunknum, data                      +
 
(1 row)

SELECT attname, atthasmissing, atthasdef FROM pg_attribute WHERE attrelid = 'o_test_ix_ams'::regclass;
 attname  | atthasmissing | atthasdef 
----------+---------------+-----------
 tableoid | f             | f
 cmax     | f             | f
 xmax     | f             | f
 cmin     | f             | f
 xmin     | f             | f
 ctid     | f             | f
 i        | f             | f
 j        | f             | f
 p        | f             | f
 pk1      | f             | f
 pk2      | f             | f
 k        | f             | f
 r        | f             | f
(13 rows)

SELECT orioledb_table_description('o_test_ix_ams'::regclass);
                orioledb_table_description                 
-----------------------------------------------------------
 Compress = -1, Primary compress = -1, TOAST compress = -1+
  Column |      Type | Collation | Nullable | Droped      +
       i |   integer |    (null) |    false |  false      +
       j |   integer |    (null) |     true |  false      +
       p |     point |    (null) |     true |  false      +
     pk1 |   integer |    (null) |    false |  false      +
     pk2 |   integer |    (null) |    false |  false      +
       k |   integer |    (null) |     true |  false      +
       r | integer[] |    (null) |     true |  false      +
 
(1 row)

\d+ o_test_ix_ams
                            Table "index_bridging.o_test_ix_ams"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer   |           |          |         | plain    |              | 
 p      | point     |           |          |         | plain    |              | 
 pk1    | integer   |           | not null |         | plain    |              | 
 pk2    | integer   |           | not null |         | plain    |              | 
 k      | integer   |           |          |         | plain    |              | 
 r      | integer[] |           |          |         | extended |              | 
Indexes:
    "o_test_ix_ams_hash_ix" hash (k)
    "o_test_ix_ams_ix1" btree (j) WITH (orioledb_index=off, deduplicate_items=off)
Options: index_bridging=true

SELECT *, r IS NULL FROM o_test_ix_ams;
  i   |  j   |      p      | pk1  | pk2  |  k   | r | ?column? 
------+------+-------------+------+------+------+---+----------
    1 | 1099 | (41,5)      |    6 |    7 | 1099 |   | t
   10 | 1090 | (401,50)    |   60 |   70 | 1090 |   | t
  100 | 1000 | (4001,500)  |  600 |  700 | 1000 |   | t
 1000 | 2000 | (4000,5000) | 6000 | 7000 | 8000 |   | t
(4 rows)

SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                                              orioledb_tbl_structure                                               
-------------------------------------------------------------------------------------------------------------------
 Index ctid_primary contents                                                                                      +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                                              +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty                                              +
     Leftmost, Rightmost                                                                                          +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                                       +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,4)', '1', '1099', '(41,5)', '6', '7', '1099', null)              +
     Item 1: offset = 344, tuple = ('(0,2)', '(0,5)', '10', '1090', '(401,50)', '60', '70', '1090', null)         +
     Item 2: offset = 424, tuple = ('(0,3)', '(0,6)', '100', '1000', '(4001,500)', '600', '700', '1000', null)    +
     Item 3: offset = 504, tuple = ('(0,4)', '(0,7)', '1000', '2000', '(4000,5000)', '6000', '7000', '8000', null)+
                                                                                                                  +
 Index index_bridge contents                                                                                      +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                                              +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty                                               +
     Leftmost, Rightmost                                                                                          +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                                       +
     Item 0: deleted, offset = 272, tuple = ('(0,1)', '(0,1)')                                                    +
     Item 1: deleted, offset = 304, tuple = ('(0,2)', '(0,2)')                                                    +
     Item 2: deleted, offset = 336, tuple = ('(0,3)', '(0,3)')                                                    +
     Item 3: offset = 368, tuple = ('(0,4)', '(0,1)')                                                             +
     Item 4: offset = 400, tuple = ('(0,5)', '(0,2)')                                                             +
     Item 5: offset = 432, tuple = ('(0,6)', '(0,3)')                                                             +
     Item 6: offset = 464, tuple = ('(0,7)', '(0,4)')                                                             +
                                                                                                                  +
 Index toast: not loaded                                                                                          +
 
(1 row)

UPDATE o_test_ix_ams SET r = ARRAY[(i*8+j)%100, 11];
SELECT orioledb_table_description('o_test_ix_ams'::regclass);
                orioledb_table_description                 
-----------------------------------------------------------
 Compress = -1, Primary compress = -1, TOAST compress = -1+
  Column |      Type | Collation | Nullable | Droped      +
       i |   integer |    (null) |    false |  false      +
       j |   integer |    (null) |     true |  false      +
       p |     point |    (null) |     true |  false      +
     pk1 |   integer |    (null) |    false |  false      +
     pk2 |   integer |    (null) |    false |  false      +
       k |   integer |    (null) |     true |  false      +
       r | integer[] |    (null) |     true |  false      +
 
(1 row)

\d+ o_test_ix_ams
                            Table "index_bridging.o_test_ix_ams"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer   |           |          |         | plain    |              | 
 p      | point     |           |          |         | plain    |              | 
 pk1    | integer   |           | not null |         | plain    |              | 
 pk2    | integer   |           | not null |         | plain    |              | 
 k      | integer   |           |          |         | plain    |              | 
 r      | integer[] |           |          |         | extended |              | 
Indexes:
    "o_test_ix_ams_hash_ix" hash (k)
    "o_test_ix_ams_ix1" btree (j) WITH (orioledb_index=off, deduplicate_items=off)
Options: index_bridging=true

SELECT orioledb_tbl_indices('o_test_ix_ams'::regclass, true);
                           orioledb_tbl_indices                            
---------------------------------------------------------------------------
 Index ctid_primary                                                       +
     Index type: primary, unique, ctid                                    +
     Leaf tuple size: 9, non-leaf tuple size: 1                           +
     Non-leaf tuple fields: ctid                                          +
     Leaf tuple fields: ctid, index_bridging_ctid, i, j, p, pk1, pk2, k, r+
 Index index_bridge                                                       +
     Index type: secondary                                                +
     Leaf tuple size: 2, non-leaf tuple size: 1                           +
     Non-leaf tuple fields: index_bridging_ctid                           +
     Leaf tuple fields: index_bridging_ctid, ctid                         +
 Index toast                                                              +
     Index type: secondary                                                +
     Leaf tuple size: 4, non-leaf tuple size: 3                           +
     Non-leaf tuple fields: ctid, attnum, chunknum                        +
     Leaf tuple fields: ctid, attnum, chunknum, data                      +
 
(1 row)

SELECT orioledb_tbl_structure('o_test_ix_ams'::regclass, 'ne');
                                                orioledb_tbl_structure                                                 
-----------------------------------------------------------------------------------------------------------------------
 Index ctid_primary contents                                                                                          +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                                                  +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty                                                  +
     Leftmost, Rightmost                                                                                              +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                                           +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,4)', '1', '1099', '(41,5)', '6', '7', '1099', '{7,11}')              +
     Item 1: offset = 376, tuple = ('(0,2)', '(0,5)', '10', '1090', '(401,50)', '60', '70', '1090', '{70,11}')        +
     Item 2: offset = 488, tuple = ('(0,3)', '(0,6)', '100', '1000', '(4001,500)', '600', '700', '1000', '{0,11}')    +
     Item 3: offset = 600, tuple = ('(0,4)', '(0,7)', '1000', '2000', '(4000,5000)', '6000', '7000', '8000', '{0,11}')+
                                                                                                                      +
 Index index_bridge contents                                                                                          +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                                                  +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty                                                   +
     Leftmost, Rightmost                                                                                              +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                                           +
     Item 0: deleted, offset = 272, tuple = ('(0,1)', '(0,1)')                                                        +
     Item 1: deleted, offset = 304, tuple = ('(0,2)', '(0,2)')                                                        +
     Item 2: deleted, offset = 336, tuple = ('(0,3)', '(0,3)')                                                        +
     Item 3: offset = 368, tuple = ('(0,4)', '(0,1)')                                                                 +
     Item 4: offset = 400, tuple = ('(0,5)', '(0,2)')                                                                 +
     Item 5: offset = 432, tuple = ('(0,6)', '(0,3)')                                                                 +
     Item 6: offset = 464, tuple = ('(0,7)', '(0,4)')                                                                 +
                                                                                                                      +
 Index toast: not loaded                                                                                              +
 
(1 row)

SELECT * FROM o_test_ix_ams;
  i   |  j   |      p      | pk1  | pk2  |  k   |    r    
------+------+-------------+------+------+------+---------
    1 | 1099 | (41,5)      |    6 |    7 | 1099 | {7,11}
   10 | 1090 | (401,50)    |   60 |   70 | 1090 | {70,11}
  100 | 1000 | (4001,500)  |  600 |  700 | 1000 | {0,11}
 1000 | 2000 | (4000,5000) | 6000 | 7000 | 8000 | {0,11}
(4 rows)

CREATE INDEX o_test_ix_ams_ix3 ON o_test_ix_ams USING gin (r);
BEGIN;
SET LOCAL enable_seqscan = off;
SET LOCAL enable_bitmapscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_ix_ams WHERE r @> array[11, 11];
              QUERY PLAN               
---------------------------------------
 Seq Scan on o_test_ix_ams
   Filter: (r @> '{11,11}'::integer[])
(2 rows)

SELECT * FROM o_test_ix_ams WHERE r @> array[11, 11];
  i   |  j   |      p      | pk1  | pk2  |  k   |    r    
------+------+-------------+------+------+------+---------
    1 | 1099 | (41,5)      |    6 |    7 | 1099 | {7,11}
   10 | 1090 | (401,50)    |   60 |   70 | 1090 | {70,11}
  100 | 1000 | (4001,500)  |  600 |  700 | 1000 | {0,11}
 1000 | 2000 | (4000,5000) | 6000 | 7000 | 8000 | {0,11}
(4 rows)

COMMIT;
CREATE INDEX o_test_ix_ams_ix4 ON o_test_ix_ams USING gist (p);
SELECT * FROM gist_index_content('o_test_ix_ams_ix4');
ERROR:  function gist_index_content(unknown) does not exist
LINE 1: SELECT * FROM gist_index_content('o_test_ix_ams_ix4');
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT p FROM o_test_ix_ams WHERE p <@ box(point(0,0), point(4000, 5000));
                        QUERY PLAN                        
----------------------------------------------------------
 Index Only Scan using o_test_ix_ams_ix4 on o_test_ix_ams
   Index Cond: (p <@ '(4000,5000),(0,0)'::box)
(2 rows)

SELECT p FROM o_test_ix_ams WHERE p <@ box(point(0,0), point(4000, 5000));
      p      
-------------
 (41,5)
 (401,50)
 (4000,5000)
(3 rows)

COMMIT;
CREATE TABLE o_bridging_vacuum_test (id serial primary key, val float, p point) USING orioledb;
INSERT INTO o_bridging_vacuum_test (p) (SELECT point(0.01 * i, 0.02 * i) FROM generate_series(1,5) i);
SELECT orioledb_tbl_structure('o_bridging_vacuum_test'::regclass, 'ne');
                       orioledb_tbl_structure                        
---------------------------------------------------------------------
 Index o_bridging_vacuum_test_pkey contents                         +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty+
     Leftmost, Rightmost                                            +
   Chunk 0: offset = 0, location = 256, hikey location = 64         +
     Item 0: offset = 272, tuple = ('1', null, '(0.01,0.02)')       +
     Item 1: offset = 328, tuple = ('2', null, '(0.02,0.04)')       +
     Item 2: offset = 384, tuple = ('3', null, '(0.03,0.06)')       +
     Item 3: offset = 440, tuple = ('4', null, '(0.04,0.08)')       +
     Item 4: offset = 496, tuple = ('5', null, '(0.05,0.1)')        +
                                                                    +
 Index toast: not loaded                                            +
 
(1 row)

CREATE INDEX o_bridging_vacuum_test_p_idx on o_bridging_vacuum_test using gist(p);
NOTICE:  index bridging is enabled for orioledb table 'o_bridging_vacuum_test'
DETAIL:  index access method 'gist' is supported only via index bridging for OrioleDB table
SELECT orioledb_tbl_structure('o_bridging_vacuum_test'::regclass, 'ne');
                           orioledb_tbl_structure                           
----------------------------------------------------------------------------
 Index o_bridging_vacuum_test_pkey contents                                +
 Page 0: level = 0, maxKeyLen = 4, nVacatedBytes = 0                       +
 state = free, datoid equal, relnode equal, ix_type = primary, clean       +
     Leftmost, Rightmost                                                   +
   Chunk 0: offset = 0, location = 256, hikey location = 80, hikey = ('2') +
     Item 0: offset = 264, tuple = ('(0,1)', '1', null, '(0.01,0.02)')     +
   Chunk 1: offset = 1, location = 328, hikey location = 88, hikey = ('3') +
     Item 1: offset = 336, tuple = ('(0,2)', '2', null, '(0.02,0.04)')     +
   Chunk 2: offset = 2, location = 400, hikey location = 96, hikey = ('4') +
     Item 2: offset = 408, tuple = ('(0,3)', '3', null, '(0.03,0.06)')     +
   Chunk 3: offset = 3, location = 472, hikey location = 104, hikey = ('5')+
     Item 3: offset = 480, tuple = ('(0,4)', '4', null, '(0.04,0.08)')     +
   Chunk 4: offset = 4, location = 544, hikey location = 112               +
     Item 4: offset = 552, tuple = ('(0,5)', '5', null, '(0.05,0.1)')      +
                                                                           +
 Index index_bridge: not loaded                                            +
 Index toast: not loaded                                                   +
 
(1 row)

SELECT * FROM gist_index_content('o_bridging_vacuum_test_p_idx');
ERROR:  function gist_index_content(unknown) does not exist
LINE 1: SELECT * FROM gist_index_content('o_bridging_vacuum_test_p_id...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
DELETE FROM o_bridging_vacuum_test;
SELECT orioledb_tbl_structure('o_bridging_vacuum_test'::regclass, 'ne');
                             orioledb_tbl_structure                             
--------------------------------------------------------------------------------
 Index o_bridging_vacuum_test_pkey contents                                    +
 Page 0: level = 0, maxKeyLen = 4, nVacatedBytes = 320                         +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty           +
     Leftmost, Rightmost                                                       +
   Chunk 0: offset = 0, location = 256, hikey location = 80, hikey = ('2')     +
     Item 0: deleted, offset = 264, tuple = ('(0,1)', '1', null, '(0.01,0.02)')+
   Chunk 1: offset = 1, location = 328, hikey location = 88, hikey = ('3')     +
     Item 1: deleted, offset = 336, tuple = ('(0,2)', '2', null, '(0.02,0.04)')+
   Chunk 2: offset = 2, location = 400, hikey location = 96, hikey = ('4')     +
     Item 2: deleted, offset = 408, tuple = ('(0,3)', '3', null, '(0.03,0.06)')+
   Chunk 3: offset = 3, location = 472, hikey location = 104, hikey = ('5')    +
     Item 3: deleted, offset = 480, tuple = ('(0,4)', '4', null, '(0.04,0.08)')+
   Chunk 4: offset = 4, location = 544, hikey location = 112                   +
     Item 4: deleted, offset = 552, tuple = ('(0,5)', '5', null, '(0.05,0.1)') +
                                                                               +
 Index index_bridge contents                                                   +
 Page 0: level = 0, maxKeyLen = 6, nVacatedBytes = 0                           +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty            +
     Leftmost, Rightmost                                                       +
   Chunk 0: offset = 0, location = 256, hikey location = 80, hikey = ('(0,2)') +
     Item 0: deleted, offset = 264, tuple = ('(0,1)', '1')                     +
   Chunk 1: offset = 1, location = 296, hikey location = 88, hikey = ('(0,3)') +
     Item 1: deleted, offset = 304, tuple = ('(0,2)', '2')                     +
   Chunk 2: offset = 2, location = 336, hikey location = 96, hikey = ('(0,4)') +
     Item 2: deleted, offset = 344, tuple = ('(0,3)', '3')                     +
   Chunk 3: offset = 3, location = 376, hikey location = 104, hikey = ('(0,5)')+
     Item 3: deleted, offset = 384, tuple = ('(0,4)', '4')                     +
   Chunk 4: offset = 4, location = 416, hikey location = 112                   +
     Item 4: deleted, offset = 424, tuple = ('(0,5)', '5')                     +
                                                                               +
 Index toast: not loaded                                                       +
 
(1 row)

SELECT * FROM gist_index_content('o_bridging_vacuum_test_p_idx');
ERROR:  function gist_index_content(unknown) does not exist
LINE 1: SELECT * FROM gist_index_content('o_bridging_vacuum_test_p_id...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
SELECT orioledb_rewind_sync();
 orioledb_rewind_sync 
----------------------
 
(1 row)

VACUUM o_bridging_vacuum_test;
SELECT * FROM o_bridging_vacuum_test WHERE p <@ box(point(0,0), point(1,1));
 id | val | p 
----+-----+---
(0 rows)

SELECT orioledb_tbl_structure('o_bridging_vacuum_test'::regclass, 'ne');
                             orioledb_tbl_structure                             
--------------------------------------------------------------------------------
 Index o_bridging_vacuum_test_pkey contents                                    +
 Page 0: level = 0, maxKeyLen = 4, nVacatedBytes = 320                         +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty           +
     Leftmost, Rightmost                                                       +
   Chunk 0: offset = 0, location = 256, hikey location = 80, hikey = ('2')     +
     Item 0: deleted, offset = 264, tuple = ('(0,1)', '1', null, '(0.01,0.02)')+
   Chunk 1: offset = 1, location = 328, hikey location = 88, hikey = ('3')     +
     Item 1: deleted, offset = 336, tuple = ('(0,2)', '2', null, '(0.02,0.04)')+
   Chunk 2: offset = 2, location = 400, hikey location = 96, hikey = ('4')     +
     Item 2: deleted, offset = 408, tuple = ('(0,3)', '3', null, '(0.03,0.06)')+
   Chunk 3: offset = 3, location = 472, hikey location = 104, hikey = ('5')    +
     Item 3: deleted, offset = 480, tuple = ('(0,4)', '4', null, '(0.04,0.08)')+
   Chunk 4: offset = 4, location = 544, hikey location = 112                   +
     Item 4: deleted, offset = 552, tuple = ('(0,5)', '5', null, '(0.05,0.1)') +
                                                                               +
 Index index_bridge contents                                                   +
 Page 0: level = 0, maxKeyLen = 6, nVacatedBytes = 0                           +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty            +
     Leftmost, Rightmost                                                       +
   Chunk 0: offset = 0, location = 256, hikey location = 64                    +
                                                                               +
 Index toast: not loaded                                                       +
 
(1 row)

SELECT * FROM gist_index_content('o_bridging_vacuum_test_p_idx');
ERROR:  function gist_index_content(unknown) does not exist
LINE 1: SELECT * FROM gist_index_content('o_bridging_vacuum_test_p_id...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
DROP TABLE o_bridging_vacuum_test;
CREATE TABLE o_test_bridging_with_regular_no_pkey (
	i int NOT NULL,
	j int
) USING orioledb WITH (index_bridging);
CREATE INDEX o_test_bridging_with_regular_no_pkey_ix1 on
	o_test_bridging_with_regular_no_pkey using btree (j) WITH (orioledb_index = off);
WARNING:  using bridged btree index for orioledb
DETAIL:  This feature is intended for testing purposes and is not recommended for normal usage.
CREATE INDEX o_test_bridging_with_regular_no_pkey_ix2 on
	o_test_bridging_with_regular_no_pkey using btree (j);
INSERT INTO o_test_bridging_with_regular_no_pkey
	SELECT v, v FROM generate_series(1, 10) v;
ANALYZE o_test_bridging_with_regular_no_pkey;
SELECT orioledb_tbl_indices('o_test_bridging_with_regular_no_pkey'::regclass);
                  orioledb_tbl_indices                  
--------------------------------------------------------
 Index ctid_primary                                    +
     Index type: primary, unique, ctid                 +
     Leaf tuple size: 4, non-leaf tuple size: 1        +
     Non-leaf tuple fields: ctid                       +
     Leaf tuple fields: ctid, index_bridging_ctid, i, j+
 Index o_test_bridging_with_regular_no_pkey_ix2        +
     Index type: secondary                             +
     Leaf tuple size: 2, non-leaf tuple size: 2        +
     Non-leaf tuple fields: j, ctid                    +
     Leaf tuple fields: j, ctid                        +
 
(1 row)

SELECT orioledb_tbl_structure('o_test_bridging_with_regular_no_pkey'::regclass, 'ne');
                       orioledb_tbl_structure                        
---------------------------------------------------------------------
 Index ctid_primary contents                                        +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty+
     Leftmost, Rightmost                                            +
   Chunk 0: offset = 0, location = 256, hikey location = 64         +
     Item 0: offset = 280, tuple = ('(0,1)', '(0,1)', '1', '1')     +
     Item 1: offset = 328, tuple = ('(0,2)', '(0,2)', '2', '2')     +
     Item 2: offset = 376, tuple = ('(0,3)', '(0,3)', '3', '3')     +
     Item 3: offset = 424, tuple = ('(0,4)', '(0,4)', '4', '4')     +
     Item 4: offset = 472, tuple = ('(0,5)', '(0,5)', '5', '5')     +
     Item 5: offset = 520, tuple = ('(0,6)', '(0,6)', '6', '6')     +
     Item 6: offset = 568, tuple = ('(0,7)', '(0,7)', '7', '7')     +
     Item 7: offset = 616, tuple = ('(0,8)', '(0,8)', '8', '8')     +
     Item 8: offset = 664, tuple = ('(0,9)', '(0,9)', '9', '9')     +
     Item 9: offset = 712, tuple = ('(0,10)', '(0,10)', '10', '10') +
                                                                    +
 Index o_test_bridging_with_regular_no_pkey_ix2 contents            +
 Page 0: level = 0, maxKeyLen = 16, nVacatedBytes = 0               +
 state = free, datoid equal, relnode equal, ix_type = regular, dirty+
     Leftmost, Rightmost                                            +
   Chunk 0: offset = 0, location = 256, hikey location = 64         +
     Item 0: offset = 280, tuple = ('1', '(0,1)')                   +
     Item 1: offset = 312, tuple = ('2', '(0,2)')                   +
     Item 2: offset = 344, tuple = ('3', '(0,3)')                   +
     Item 3: offset = 376, tuple = ('4', '(0,4)')                   +
     Item 4: offset = 408, tuple = ('5', '(0,5)')                   +
     Item 5: offset = 440, tuple = ('6', '(0,6)')                   +
     Item 6: offset = 472, tuple = ('7', '(0,7)')                   +
     Item 7: offset = 504, tuple = ('8', '(0,8)')                   +
     Item 8: offset = 536, tuple = ('9', '(0,9)')                   +
     Item 9: offset = 568, tuple = ('10', '(0,10)')                 +
                                                                    +
 Index index_bridge contents                                        +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty +
     Leftmost, Rightmost                                            +
   Chunk 0: offset = 0, location = 256, hikey location = 64         +
     Item 0: offset = 280, tuple = ('(0,1)', '(0,1)')               +
     Item 1: offset = 312, tuple = ('(0,2)', '(0,2)')               +
     Item 2: offset = 344, tuple = ('(0,3)', '(0,3)')               +
     Item 3: offset = 376, tuple = ('(0,4)', '(0,4)')               +
     Item 4: offset = 408, tuple = ('(0,5)', '(0,5)')               +
     Item 5: offset = 440, tuple = ('(0,6)', '(0,6)')               +
     Item 6: offset = 472, tuple = ('(0,7)', '(0,7)')               +
     Item 7: offset = 504, tuple = ('(0,8)', '(0,8)')               +
     Item 8: offset = 536, tuple = ('(0,9)', '(0,9)')               +
     Item 9: offset = 568, tuple = ('(0,10)', '(0,10)')             +
                                                                    +
 Index toast: not loaded                                            +
 
(1 row)

UPDATE o_test_bridging_with_regular_no_pkey SET j = j * 10 WHERE mod(i, 4) = 0;
DELETE FROM o_test_bridging_with_regular_no_pkey WHERE mod(i, 4) = 0;
SELECT orioledb_tbl_structure('o_test_bridging_with_regular_no_pkey'::regclass, 'ne');
                          orioledb_tbl_structure                           
---------------------------------------------------------------------------
 Index ctid_primary contents                                              +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 96                     +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty      +
     Leftmost, Rightmost                                                  +
   Chunk 0: offset = 0, location = 256, hikey location = 64               +
     Item 0: offset = 280, tuple = ('(0,1)', '(0,1)', '1', '1')           +
     Item 1: offset = 328, tuple = ('(0,2)', '(0,2)', '2', '2')           +
     Item 2: offset = 376, tuple = ('(0,3)', '(0,3)', '3', '3')           +
     Item 3: deleted, offset = 424, tuple = ('(0,4)', '(0,11)', '4', '40')+
     Item 4: offset = 472, tuple = ('(0,5)', '(0,5)', '5', '5')           +
     Item 5: offset = 520, tuple = ('(0,6)', '(0,6)', '6', '6')           +
     Item 6: offset = 568, tuple = ('(0,7)', '(0,7)', '7', '7')           +
     Item 7: deleted, offset = 616, tuple = ('(0,8)', '(0,12)', '8', '80')+
     Item 8: offset = 664, tuple = ('(0,9)', '(0,9)', '9', '9')           +
     Item 9: offset = 712, tuple = ('(0,10)', '(0,10)', '10', '10')       +
                                                                          +
 Index o_test_bridging_with_regular_no_pkey_ix2 contents                  +
 Page 0: level = 0, maxKeyLen = 16, nVacatedBytes = 128                   +
 state = free, datoid equal, relnode equal, ix_type = regular, dirty      +
     Leftmost, Rightmost                                                  +
   Chunk 0: offset = 0, location = 256, hikey location = 64               +
     Item 0: offset = 280, tuple = ('1', '(0,1)')                         +
     Item 1: offset = 312, tuple = ('2', '(0,2)')                         +
     Item 2: offset = 344, tuple = ('3', '(0,3)')                         +
     Item 3: deleted, offset = 376, tuple = ('4', '(0,4)')                +
     Item 4: offset = 408, tuple = ('5', '(0,5)')                         +
     Item 5: offset = 440, tuple = ('6', '(0,6)')                         +
     Item 6: offset = 472, tuple = ('7', '(0,7)')                         +
     Item 7: deleted, offset = 504, tuple = ('8', '(0,8)')                +
     Item 8: offset = 536, tuple = ('9', '(0,9)')                         +
     Item 9: offset = 568, tuple = ('10', '(0,10)')                       +
     Item 10: deleted, offset = 600, tuple = ('40', '(0,4)')              +
     Item 11: deleted, offset = 632, tuple = ('80', '(0,8)')              +
                                                                          +
 Index index_bridge contents                                              +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                      +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty       +
     Leftmost, Rightmost                                                  +
   Chunk 0: offset = 0, location = 256, hikey location = 64               +
     Item 0: offset = 280, tuple = ('(0,1)', '(0,1)')                     +
     Item 1: offset = 312, tuple = ('(0,2)', '(0,2)')                     +
     Item 2: offset = 344, tuple = ('(0,3)', '(0,3)')                     +
     Item 3: deleted, offset = 376, tuple = ('(0,4)', '(0,4)')            +
     Item 4: offset = 408, tuple = ('(0,5)', '(0,5)')                     +
     Item 5: offset = 440, tuple = ('(0,6)', '(0,6)')                     +
     Item 6: offset = 472, tuple = ('(0,7)', '(0,7)')                     +
     Item 7: deleted, offset = 504, tuple = ('(0,8)', '(0,8)')            +
     Item 8: offset = 536, tuple = ('(0,9)', '(0,9)')                     +
     Item 9: offset = 568, tuple = ('(0,10)', '(0,10)')                   +
     Item 10: deleted, offset = 600, tuple = ('(0,11)', '(0,4)')          +
     Item 11: deleted, offset = 632, tuple = ('(0,12)', '(0,8)')          +
                                                                          +
 Index toast: not loaded                                                  +
 
(1 row)

CREATE TABLE o_test_bridging_with_regular_pkey (
	i int NOT NULL PRIMARY KEY,
	j int,
	k int
) USING orioledb WITH (index_bridging);
CREATE INDEX o_test_bridging_with_regular_pkey_ix1 on
	o_test_bridging_with_regular_pkey using btree (j) WITH (orioledb_index = off);
WARNING:  using bridged btree index for orioledb
DETAIL:  This feature is intended for testing purposes and is not recommended for normal usage.
CREATE INDEX o_test_bridging_with_regular_pkey_ix2 on
	o_test_bridging_with_regular_pkey using btree (k);
INSERT INTO o_test_bridging_with_regular_pkey
	SELECT v * 1000 + 673, 1000 - v * 100 + 15, v FROM generate_series(1, 10) v;
ANALYZE o_test_bridging_with_regular_pkey;
SELECT orioledb_tbl_structure('o_test_bridging_with_regular_pkey'::regclass, 'ne');
                       orioledb_tbl_structure                        
---------------------------------------------------------------------
 Index o_test_bridging_with_regular_pkey_pkey contents              +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty+
     Leftmost, Rightmost                                            +
   Chunk 0: offset = 0, location = 256, hikey location = 64         +
     Item 0: offset = 280, tuple = ('(0,1)', '1673', '915', '1')    +
     Item 1: offset = 328, tuple = ('(0,2)', '2673', '815', '2')    +
     Item 2: offset = 376, tuple = ('(0,3)', '3673', '715', '3')    +
     Item 3: offset = 424, tuple = ('(0,4)', '4673', '615', '4')    +
     Item 4: offset = 472, tuple = ('(0,5)', '5673', '515', '5')    +
     Item 5: offset = 520, tuple = ('(0,6)', '6673', '415', '6')    +
     Item 6: offset = 568, tuple = ('(0,7)', '7673', '315', '7')    +
     Item 7: offset = 616, tuple = ('(0,8)', '8673', '215', '8')    +
     Item 8: offset = 664, tuple = ('(0,9)', '9673', '115', '9')    +
     Item 9: offset = 712, tuple = ('(0,10)', '10673', '15', '10')  +
                                                                    +
 Index o_test_bridging_with_regular_pkey_ix2 contents               +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                +
 state = free, datoid equal, relnode equal, ix_type = regular, dirty+
     Leftmost, Rightmost                                            +
   Chunk 0: offset = 0, location = 256, hikey location = 64         +
     Item 0: offset = 280, tuple = ('1', '1673')                    +
     Item 1: offset = 304, tuple = ('2', '2673')                    +
     Item 2: offset = 328, tuple = ('3', '3673')                    +
     Item 3: offset = 352, tuple = ('4', '4673')                    +
     Item 4: offset = 376, tuple = ('5', '5673')                    +
     Item 5: offset = 400, tuple = ('6', '6673')                    +
     Item 6: offset = 424, tuple = ('7', '7673')                    +
     Item 7: offset = 448, tuple = ('8', '8673')                    +
     Item 8: offset = 472, tuple = ('9', '9673')                    +
     Item 9: offset = 496, tuple = ('10', '10673')                  +
                                                                    +
 Index index_bridge contents                                        +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty +
     Leftmost, Rightmost                                            +
   Chunk 0: offset = 0, location = 256, hikey location = 64         +
     Item 0: offset = 280, tuple = ('(0,1)', '1673')                +
     Item 1: offset = 312, tuple = ('(0,2)', '2673')                +
     Item 2: offset = 344, tuple = ('(0,3)', '3673')                +
     Item 3: offset = 376, tuple = ('(0,4)', '4673')                +
     Item 4: offset = 408, tuple = ('(0,5)', '5673')                +
     Item 5: offset = 440, tuple = ('(0,6)', '6673')                +
     Item 6: offset = 472, tuple = ('(0,7)', '7673')                +
     Item 7: offset = 504, tuple = ('(0,8)', '8673')                +
     Item 8: offset = 536, tuple = ('(0,9)', '9673')                +
     Item 9: offset = 568, tuple = ('(0,10)', '10673')              +
                                                                    +
 Index toast: not loaded                                            +
 
(1 row)

BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF) SELECT * FROM o_test_bridging_with_regular_pkey ORDER BY k;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Index Scan using o_test_bridging_with_regular_pkey_ix2 on o_test_bridging_with_regular_pkey
(1 row)

SELECT * FROM o_test_bridging_with_regular_pkey ORDER BY k;
   i   |  j  | k  
-------+-----+----
  1673 | 915 |  1
  2673 | 815 |  2
  3673 | 715 |  3
  4673 | 615 |  4
  5673 | 515 |  5
  6673 | 415 |  6
  7673 | 315 |  7
  8673 | 215 |  8
  9673 | 115 |  9
 10673 |  15 | 10
(10 rows)

EXPLAIN (COSTS OFF) SELECT * FROM o_test_bridging_with_regular_pkey ORDER BY j;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Index Scan using o_test_bridging_with_regular_pkey_ix1 on o_test_bridging_with_regular_pkey
(1 row)

SELECT * FROM o_test_bridging_with_regular_pkey ORDER BY j;
   i   |  j  | k  
-------+-----+----
 10673 |  15 | 10
  9673 | 115 |  9
  8673 | 215 |  8
  7673 | 315 |  7
  6673 | 415 |  6
  5673 | 515 |  5
  4673 | 615 |  4
  3673 | 715 |  3
  2673 | 815 |  2
  1673 | 915 |  1
(10 rows)

COMMIT;
CREATE TABLE o_test_bitmap_scans (
	i int NOT NULL,
	j int4[],
	j2 int4[],
	p point
) USING orioledb WITH (index_bridging);
INSERT INTO o_test_bitmap_scans
	SELECT v, ARRAY[v+17,v+33], ARRAY[v+66,v+95], point(v + 5, v + 5) FROM generate_series(1, 10) v;
CREATE INDEX o_test_bitmap_scans_ix1 on o_test_bitmap_scans using hash (j);
CREATE INDEX o_test_bitmap_scans_ix2 on o_test_bitmap_scans using btree (j);
CREATE INDEX o_test_bitmap_scans_ix3 on o_test_bitmap_scans using gin (j);
CREATE INDEX o_test_bitmap_scans_ix4 on o_test_bitmap_scans using gist (p);
CREATE INDEX o_test_bitmap_scans_ix5 on o_test_bitmap_scans using btree (j2) WITH (orioledb_index = off);
WARNING:  using bridged btree index for orioledb
DETAIL:  This feature is intended for testing purposes and is not recommended for normal usage.
BEGIN;
SET LOCAL enable_seqscan = off;
SET LOCAL enable_indexscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_bitmap_scans WHERE j = ARRAY[22,38] OR j = ARRAY[24, 40] OR j > ARRAY[25, 25];
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Custom Scan (o_scan) on o_test_bitmap_scans
   Bitmap heap scan
   Recheck Cond: ((j = '{22,38}'::integer[]) OR (j = '{24,40}'::integer[]) OR (j > '{25,25}'::integer[]))
   ->  BitmapOr
         ->  Bitmap Index Scan on o_test_bitmap_scans_ix1
               Index Cond: (j = '{22,38}'::integer[])
         ->  Bitmap Index Scan on o_test_bitmap_scans_ix1
               Index Cond: (j = '{24,40}'::integer[])
         ->  Bitmap Index Scan on o_test_bitmap_scans_ix2
               Index Cond: (j > '{25,25}'::integer[])
(10 rows)

SELECT * FROM o_test_bitmap_scans WHERE j = ARRAY[22,38] OR j = ARRAY[24, 40] OR j > ARRAY[25, 25];
 i  |    j    |    j2    |    p    
----+---------+----------+---------
  5 | {22,38} | {71,100} | (10,10)
  7 | {24,40} | {73,102} | (12,12)
  8 | {25,41} | {74,103} | (13,13)
  9 | {26,42} | {75,104} | (14,14)
 10 | {27,43} | {76,105} | (15,15)
(5 rows)

COMMIT;
BEGIN;
SET LOCAL enable_seqscan = off;
SET LOCAL enable_indexscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_bitmap_scans WHERE j = ARRAY[19,35];
                     QUERY PLAN                     
----------------------------------------------------
 Custom Scan (o_scan) on o_test_bitmap_scans
   Bitmap heap scan
   Recheck Cond: (j = '{19,35}'::integer[])
   ->  Bitmap Index Scan on o_test_bitmap_scans_ix1
         Index Cond: (j = '{19,35}'::integer[])
(5 rows)

SELECT * FROM o_test_bitmap_scans WHERE j = ARRAY[19,35];
 i |    j    |   j2    |   p   
---+---------+---------+-------
 2 | {19,35} | {68,97} | (7,7)
(1 row)

EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_bitmap_scans WHERE j <@ ARRAY[20, 36, 15];
                     QUERY PLAN                     
----------------------------------------------------
 Custom Scan (o_scan) on o_test_bitmap_scans
   Bitmap heap scan
   Recheck Cond: (j <@ '{20,36,15}'::integer[])
   ->  Bitmap Index Scan on o_test_bitmap_scans_ix3
         Index Cond: (j <@ '{20,36,15}'::integer[])
(5 rows)

SELECT * FROM o_test_bitmap_scans WHERE j <@ ARRAY[20, 36, 15];
 i |    j    |   j2    |   p   
---+---------+---------+-------
 3 | {20,36} | {69,98} | (8,8)
(1 row)

EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_bitmap_scans WHERE j > ARRAY[26, 42];
                     QUERY PLAN                     
----------------------------------------------------
 Custom Scan (o_scan) on o_test_bitmap_scans
   Bitmap heap scan
   Recheck Cond: (j > '{26,42}'::integer[])
   ->  Bitmap Index Scan on o_test_bitmap_scans_ix2
         Index Cond: (j > '{26,42}'::integer[])
(5 rows)

SELECT * FROM o_test_bitmap_scans WHERE j > ARRAY[26, 42];
 i  |    j    |    j2    |    p    
----+---------+----------+---------
 10 | {27,43} | {76,105} | (15,15)
(1 row)

EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_bitmap_scans WHERE j = ARRAY[19,35] OR j <@ ARRAY[20, 36, 15];
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Custom Scan (o_scan) on o_test_bitmap_scans
   Bitmap heap scan
   Recheck Cond: ((j = '{19,35}'::integer[]) OR (j <@ '{20,36,15}'::integer[]))
   ->  BitmapOr
         ->  Bitmap Index Scan on o_test_bitmap_scans_ix1
               Index Cond: (j = '{19,35}'::integer[])
         ->  Bitmap Index Scan on o_test_bitmap_scans_ix3
               Index Cond: (j <@ '{20,36,15}'::integer[])
(8 rows)

SELECT * FROM o_test_bitmap_scans WHERE j = ARRAY[19,35] OR j <@ ARRAY[20, 36, 15];
 i |    j    |   j2    |   p   
---+---------+---------+-------
 2 | {19,35} | {68,97} | (7,7)
 3 | {20,36} | {69,98} | (8,8)
(2 rows)

EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_bitmap_scans WHERE j = ARRAY[19,35] OR j <@ ARRAY[20, 36, 15] OR j > ARRAY[26, 42];
                                                  QUERY PLAN                                                  
--------------------------------------------------------------------------------------------------------------
 Custom Scan (o_scan) on o_test_bitmap_scans
   Bitmap heap scan
   Recheck Cond: ((j = '{19,35}'::integer[]) OR (j > '{26,42}'::integer[]) OR (j <@ '{20,36,15}'::integer[]))
   ->  BitmapOr
         ->  Bitmap Index Scan on o_test_bitmap_scans_ix1
               Index Cond: (j = '{19,35}'::integer[])
         ->  Bitmap Index Scan on o_test_bitmap_scans_ix2
               Index Cond: (j > '{26,42}'::integer[])
         ->  Bitmap Index Scan on o_test_bitmap_scans_ix3
               Index Cond: (j <@ '{20,36,15}'::integer[])
(10 rows)

SELECT * FROM o_test_bitmap_scans WHERE j = ARRAY[19,35] OR j <@ ARRAY[20, 36, 15] OR j > ARRAY[26, 42];
 i  |    j    |    j2    |    p    
----+---------+----------+---------
  2 | {19,35} | {68,97}  | (7,7)
  3 | {20,36} | {69,98}  | (8,8)
 10 | {27,43} | {76,105} | (15,15)
(3 rows)

EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_bitmap_scans
		WHERE  (j > ARRAY[25, 41] OR j2 < ARRAY[68,97]) OR p <@ box(point(8,8), point(10, 10));
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Custom Scan (o_scan) on o_test_bitmap_scans
   Bitmap heap scan
   Recheck Cond: ((p <@ '(10,10),(8,8)'::box) OR (j2 < '{68,97}'::integer[]) OR (j > '{25,41}'::integer[]))
   ->  BitmapOr
         ->  Bitmap Index Scan on o_test_bitmap_scans_ix4
               Index Cond: (p <@ '(10,10),(8,8)'::box)
         ->  Bitmap Index Scan on o_test_bitmap_scans_ix5
               Index Cond: (j2 < '{68,97}'::integer[])
         ->  Bitmap Index Scan on o_test_bitmap_scans_ix2
               Index Cond: (j > '{25,41}'::integer[])
(10 rows)

SELECT * FROM o_test_bitmap_scans
	WHERE (j > ARRAY[25, 41] OR j2 < ARRAY[68,97]) OR p <@ box(point(8,8), point(10, 10));
 i  |    j    |    j2    |    p    
----+---------+----------+---------
  1 | {18,34} | {67,96}  | (6,6)
  3 | {20,36} | {69,98}  | (8,8)
  4 | {21,37} | {70,99}  | (9,9)
  5 | {22,38} | {71,100} | (10,10)
  9 | {26,42} | {75,104} | (14,14)
 10 | {27,43} | {76,105} | (15,15)
(6 rows)

COMMIT;
CREATE TABLE o_test_index_bridging_options (
	i int NOT NULL,
	j int4[],
	p point
) USING orioledb WITH (index_bridging);
CREATE INDEX o_test_index_bridging_options_ix1 ON o_test_index_bridging_options USING btree (i);
\d+ o_test_index_bridging_options
                    Table "index_bridging.o_test_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_index_bridging_options_ix1" btree (i)
Options: index_bridging=true

CREATE INDEX o_test_index_bridging_options_ix2 ON o_test_index_bridging_options USING btree (i) WITH (orioledb_index = off);
WARNING:  using bridged btree index for orioledb
DETAIL:  This feature is intended for testing purposes and is not recommended for normal usage.
\d+ o_test_index_bridging_options
                    Table "index_bridging.o_test_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_index_bridging_options_ix1" btree (i)
    "o_test_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
Options: index_bridging=true

CREATE INDEX o_test_index_bridging_options_ix3 ON o_test_index_bridging_options USING hash (i);
\d+ o_test_index_bridging_options
                    Table "index_bridging.o_test_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_index_bridging_options_ix1" btree (i)
    "o_test_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
    "o_test_index_bridging_options_ix3" hash (i)
Options: index_bridging=true

CREATE INDEX o_test_index_bridging_options_ix4 ON o_test_index_bridging_options USING hash (i) WITH (fillfactor=65);
\d+ o_test_index_bridging_options
                    Table "index_bridging.o_test_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_index_bridging_options_ix1" btree (i)
    "o_test_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
    "o_test_index_bridging_options_ix3" hash (i)
    "o_test_index_bridging_options_ix4" hash (i) WITH (fillfactor='65')
Options: index_bridging=true

CREATE INDEX o_test_index_bridging_options_ix5 ON o_test_index_bridging_options USING gist (p);
\d+ o_test_index_bridging_options
                    Table "index_bridging.o_test_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_index_bridging_options_ix1" btree (i)
    "o_test_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
    "o_test_index_bridging_options_ix3" hash (i)
    "o_test_index_bridging_options_ix4" hash (i) WITH (fillfactor='65')
    "o_test_index_bridging_options_ix5" gist (p)
Options: index_bridging=true

CREATE INDEX o_test_index_bridging_options_ix6 ON o_test_index_bridging_options USING gin (j);
\d+ o_test_index_bridging_options
                    Table "index_bridging.o_test_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_index_bridging_options_ix1" btree (i)
    "o_test_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
    "o_test_index_bridging_options_ix3" hash (i)
    "o_test_index_bridging_options_ix4" hash (i) WITH (fillfactor='65')
    "o_test_index_bridging_options_ix5" gist (p)
    "o_test_index_bridging_options_ix6" gin (j)
Options: index_bridging=true

CREATE INDEX o_test_index_bridging_options_ix7 ON o_test_index_bridging_options USING spgist (p);
\d+ o_test_index_bridging_options
                    Table "index_bridging.o_test_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_index_bridging_options_ix1" btree (i)
    "o_test_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
    "o_test_index_bridging_options_ix3" hash (i)
    "o_test_index_bridging_options_ix4" hash (i) WITH (fillfactor='65')
    "o_test_index_bridging_options_ix5" gist (p)
    "o_test_index_bridging_options_ix6" gin (j)
    "o_test_index_bridging_options_ix7" spgist (p)
Options: index_bridging=true

CREATE INDEX o_test_index_bridging_options_ix8 ON o_test_index_bridging_options USING brin (i);
\d+ o_test_index_bridging_options
                    Table "index_bridging.o_test_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_index_bridging_options_ix1" btree (i)
    "o_test_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
    "o_test_index_bridging_options_ix3" hash (i)
    "o_test_index_bridging_options_ix4" hash (i) WITH (fillfactor='65')
    "o_test_index_bridging_options_ix5" gist (p)
    "o_test_index_bridging_options_ix6" gin (j)
    "o_test_index_bridging_options_ix7" spgist (p)
    "o_test_index_bridging_options_ix8" brin (i)
Options: index_bridging=true

ALTER TABLE o_test_index_bridging_options RESET (index_bridging);
ERROR:  cannot disable 'index_bridging' for a table with bridged indices
\d+ o_test_index_bridging_options
                    Table "index_bridging.o_test_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_index_bridging_options_ix1" btree (i)
    "o_test_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
    "o_test_index_bridging_options_ix3" hash (i)
    "o_test_index_bridging_options_ix4" hash (i) WITH (fillfactor='65')
    "o_test_index_bridging_options_ix5" gist (p)
    "o_test_index_bridging_options_ix6" gin (j)
    "o_test_index_bridging_options_ix7" spgist (p)
    "o_test_index_bridging_options_ix8" brin (i)
Options: index_bridging=true

ALTER TABLE o_test_index_bridging_options SET (index_bridging);
\d+ o_test_index_bridging_options
                    Table "index_bridging.o_test_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_index_bridging_options_ix1" btree (i)
    "o_test_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
    "o_test_index_bridging_options_ix3" hash (i)
    "o_test_index_bridging_options_ix4" hash (i) WITH (fillfactor='65')
    "o_test_index_bridging_options_ix5" gist (p)
    "o_test_index_bridging_options_ix6" gin (j)
    "o_test_index_bridging_options_ix7" spgist (p)
    "o_test_index_bridging_options_ix8" brin (i)
Options: index_bridging=true

ALTER INDEX o_test_index_bridging_options_ix2 RESET (orioledb_index);
ERROR:  Cannot change 'orioledb_index' option for existing indices
\d+ o_test_index_bridging_options
                    Table "index_bridging.o_test_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_index_bridging_options_ix1" btree (i)
    "o_test_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
    "o_test_index_bridging_options_ix3" hash (i)
    "o_test_index_bridging_options_ix4" hash (i) WITH (fillfactor='65')
    "o_test_index_bridging_options_ix5" gist (p)
    "o_test_index_bridging_options_ix6" gin (j)
    "o_test_index_bridging_options_ix7" spgist (p)
    "o_test_index_bridging_options_ix8" brin (i)
Options: index_bridging=true

ALTER INDEX o_test_index_bridging_options_ix1 SET (orioledb_index = off);
ERROR:  Cannot change 'orioledb_index' option for existing indices
\d+ o_test_index_bridging_options
                    Table "index_bridging.o_test_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_index_bridging_options_ix1" btree (i)
    "o_test_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
    "o_test_index_bridging_options_ix3" hash (i)
    "o_test_index_bridging_options_ix4" hash (i) WITH (fillfactor='65')
    "o_test_index_bridging_options_ix5" gist (p)
    "o_test_index_bridging_options_ix6" gin (j)
    "o_test_index_bridging_options_ix7" spgist (p)
    "o_test_index_bridging_options_ix8" brin (i)
Options: index_bridging=true

CREATE TABLE o_test_non_index_bridging_options (
	i int NOT NULL,
	j int4[],
	p point
) USING orioledb;
\d+ o_test_non_index_bridging_options
                  Table "index_bridging.o_test_non_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 

SELECT orioledb_tbl_indices('o_test_non_index_bridging_options'::regclass, true);
                orioledb_tbl_indices                 
-----------------------------------------------------
 Index ctid_primary                                 +
     Index type: primary, unique, ctid              +
     Leaf tuple size: 4, non-leaf tuple size: 1     +
     Non-leaf tuple fields: ctid                    +
     Leaf tuple fields: ctid, i, j, p               +
 Index toast                                        +
     Index type: secondary                          +
     Leaf tuple size: 4, non-leaf tuple size: 3     +
     Non-leaf tuple fields: ctid, attnum, chunknum  +
     Leaf tuple fields: ctid, attnum, chunknum, data+
 
(1 row)

INSERT INTO o_test_non_index_bridging_options
	SELECT v, ARRAY[v+17,v+33], point(v + 5, v + 5) FROM generate_series(1, 10) v;
SELECT orioledb_tbl_structure('o_test_non_index_bridging_options'::regclass, 'ne');
                            orioledb_tbl_structure                             
-------------------------------------------------------------------------------
 Index ctid_primary contents                                                  +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                          +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty          +
     Leftmost, Rightmost                                                      +
   Chunk 0: offset = 0, location = 256, hikey location = 64, hikey = ('(0,5)')+
     Item 0: offset = 264, tuple = ('(0,1)', '1', '{18,34}', '(6,6)')         +
     Item 1: offset = 352, tuple = ('(0,2)', '2', '{19,35}', '(7,7)')         +
     Item 2: offset = 440, tuple = ('(0,3)', '3', '{20,36}', '(8,8)')         +
     Item 3: offset = 528, tuple = ('(0,4)', '4', '{21,37}', '(9,9)')         +
   Chunk 1: offset = 4, location = 616, hikey location = 72                   +
     Item 4: offset = 632, tuple = ('(0,5)', '5', '{22,38}', '(10,10)')       +
     Item 5: offset = 720, tuple = ('(0,6)', '6', '{23,39}', '(11,11)')       +
     Item 6: offset = 808, tuple = ('(0,7)', '7', '{24,40}', '(12,12)')       +
     Item 7: offset = 896, tuple = ('(0,8)', '8', '{25,41}', '(13,13)')       +
     Item 8: offset = 984, tuple = ('(0,9)', '9', '{26,42}', '(14,14)')       +
     Item 9: offset = 1072, tuple = ('(0,10)', '10', '{27,43}', '(15,15)')    +
                                                                              +
 Index toast: not loaded                                                      +
 
(1 row)

SELECT * FROM o_test_non_index_bridging_options;
 i  |    j    |    p    
----+---------+---------
  1 | {18,34} | (6,6)
  2 | {19,35} | (7,7)
  3 | {20,36} | (8,8)
  4 | {21,37} | (9,9)
  5 | {22,38} | (10,10)
  6 | {23,39} | (11,11)
  7 | {24,40} | (12,12)
  8 | {25,41} | (13,13)
  9 | {26,42} | (14,14)
 10 | {27,43} | (15,15)
(10 rows)

ALTER TABLE o_test_non_index_bridging_options RESET (index_bridging);
\d+ o_test_non_index_bridging_options
                  Table "index_bridging.o_test_non_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 

SELECT orioledb_tbl_indices('o_test_non_index_bridging_options'::regclass, true);
                orioledb_tbl_indices                 
-----------------------------------------------------
 Index ctid_primary                                 +
     Index type: primary, unique, ctid              +
     Leaf tuple size: 4, non-leaf tuple size: 1     +
     Non-leaf tuple fields: ctid                    +
     Leaf tuple fields: ctid, i, j, p               +
 Index toast                                        +
     Index type: secondary                          +
     Leaf tuple size: 4, non-leaf tuple size: 3     +
     Non-leaf tuple fields: ctid, attnum, chunknum  +
     Leaf tuple fields: ctid, attnum, chunknum, data+
 
(1 row)

SELECT orioledb_tbl_structure('o_test_non_index_bridging_options'::regclass, 'ne');
                            orioledb_tbl_structure                             
-------------------------------------------------------------------------------
 Index ctid_primary contents                                                  +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                          +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty          +
     Leftmost, Rightmost                                                      +
   Chunk 0: offset = 0, location = 256, hikey location = 64, hikey = ('(0,5)')+
     Item 0: offset = 264, tuple = ('(0,1)', '1', '{18,34}', '(6,6)')         +
     Item 1: offset = 352, tuple = ('(0,2)', '2', '{19,35}', '(7,7)')         +
     Item 2: offset = 440, tuple = ('(0,3)', '3', '{20,36}', '(8,8)')         +
     Item 3: offset = 528, tuple = ('(0,4)', '4', '{21,37}', '(9,9)')         +
   Chunk 1: offset = 4, location = 616, hikey location = 72                   +
     Item 4: offset = 632, tuple = ('(0,5)', '5', '{22,38}', '(10,10)')       +
     Item 5: offset = 720, tuple = ('(0,6)', '6', '{23,39}', '(11,11)')       +
     Item 6: offset = 808, tuple = ('(0,7)', '7', '{24,40}', '(12,12)')       +
     Item 7: offset = 896, tuple = ('(0,8)', '8', '{25,41}', '(13,13)')       +
     Item 8: offset = 984, tuple = ('(0,9)', '9', '{26,42}', '(14,14)')       +
     Item 9: offset = 1072, tuple = ('(0,10)', '10', '{27,43}', '(15,15)')    +
                                                                              +
 Index toast: not loaded                                                      +
 
(1 row)

SELECT * FROM o_test_non_index_bridging_options;
 i  |    j    |    p    
----+---------+---------
  1 | {18,34} | (6,6)
  2 | {19,35} | (7,7)
  3 | {20,36} | (8,8)
  4 | {21,37} | (9,9)
  5 | {22,38} | (10,10)
  6 | {23,39} | (11,11)
  7 | {24,40} | (12,12)
  8 | {25,41} | (13,13)
  9 | {26,42} | (14,14)
 10 | {27,43} | (15,15)
(10 rows)

ALTER TABLE o_test_non_index_bridging_options SET (index_bridging);
\d+ o_test_non_index_bridging_options
                  Table "index_bridging.o_test_non_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Options: index_bridging=true

SELECT orioledb_tbl_indices('o_test_non_index_bridging_options'::regclass, true);
                   orioledb_tbl_indices                    
-----------------------------------------------------------
 Index ctid_primary                                       +
     Index type: primary, unique, ctid                    +
     Leaf tuple size: 5, non-leaf tuple size: 1           +
     Non-leaf tuple fields: ctid                          +
     Leaf tuple fields: ctid, index_bridging_ctid, i, j, p+
 Index index_bridge                                       +
     Index type: secondary                                +
     Leaf tuple size: 2, non-leaf tuple size: 1           +
     Non-leaf tuple fields: index_bridging_ctid           +
     Leaf tuple fields: index_bridging_ctid, ctid         +
 Index toast                                              +
     Index type: secondary                                +
     Leaf tuple size: 4, non-leaf tuple size: 3           +
     Non-leaf tuple fields: ctid, attnum, chunknum        +
     Leaf tuple fields: ctid, attnum, chunknum, data      +
 
(1 row)

SELECT orioledb_tbl_structure('o_test_non_index_bridging_options'::regclass, 'ne');
                               orioledb_tbl_structure                                
-------------------------------------------------------------------------------------
 Index ctid_primary contents                                                        +
 Page 0: level = 0, maxKeyLen = 6, nVacatedBytes = 0                                +
 state = free, datoid equal, relnode equal, ix_type = primary, clean                +
     Leftmost, Rightmost                                                            +
   Chunk 0: offset = 0, location = 256, hikey location = 96, hikey = ('(0,2)')      +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,1)', '1', '{18,34}', '(6,6)')      +
   Chunk 1: offset = 1, location = 352, hikey location = 104, hikey = ('(0,3)')     +
     Item 1: offset = 360, tuple = ('(0,2)', '(0,2)', '2', '{19,35}', '(7,7)')      +
   Chunk 2: offset = 2, location = 448, hikey location = 112, hikey = ('(0,4)')     +
     Item 2: offset = 456, tuple = ('(0,3)', '(0,3)', '3', '{20,36}', '(8,8)')      +
   Chunk 3: offset = 3, location = 544, hikey location = 120, hikey = ('(0,5)')     +
     Item 3: offset = 552, tuple = ('(0,4)', '(0,4)', '4', '{21,37}', '(9,9)')      +
   Chunk 4: offset = 4, location = 640, hikey location = 128, hikey = ('(0,6)')     +
     Item 4: offset = 648, tuple = ('(0,5)', '(0,5)', '5', '{22,38}', '(10,10)')    +
   Chunk 5: offset = 5, location = 736, hikey location = 136, hikey = ('(0,7)')     +
     Item 5: offset = 744, tuple = ('(0,6)', '(0,6)', '6', '{23,39}', '(11,11)')    +
   Chunk 6: offset = 6, location = 832, hikey location = 144, hikey = ('(0,8)')     +
     Item 6: offset = 840, tuple = ('(0,7)', '(0,7)', '7', '{24,40}', '(12,12)')    +
   Chunk 7: offset = 7, location = 928, hikey location = 152, hikey = ('(0,9)')     +
     Item 7: offset = 936, tuple = ('(0,8)', '(0,8)', '8', '{25,41}', '(13,13)')    +
   Chunk 8: offset = 8, location = 1024, hikey location = 160, hikey = ('(0,10)')   +
     Item 8: offset = 1032, tuple = ('(0,9)', '(0,9)', '9', '{26,42}', '(14,14)')   +
   Chunk 9: offset = 9, location = 1120, hikey location = 168                       +
     Item 9: offset = 1128, tuple = ('(0,10)', '(0,10)', '10', '{27,43}', '(15,15)')+
                                                                                    +
 Index index_bridge: not loaded                                                     +
 Index toast: not loaded                                                            +
 
(1 row)

SELECT * FROM o_test_non_index_bridging_options;
 i  |    j    |    p    
----+---------+---------
  1 | {18,34} | (6,6)
  2 | {19,35} | (7,7)
  3 | {20,36} | (8,8)
  4 | {21,37} | (9,9)
  5 | {22,38} | (10,10)
  6 | {23,39} | (11,11)
  7 | {24,40} | (12,12)
  8 | {25,41} | (13,13)
  9 | {26,42} | (14,14)
 10 | {27,43} | (15,15)
(10 rows)

CREATE INDEX o_test_non_index_bridging_options_ix2 ON o_test_non_index_bridging_options USING btree (i) WITH (orioledb_index = off);
WARNING:  using bridged btree index for orioledb
DETAIL:  This feature is intended for testing purposes and is not recommended for normal usage.
\d+ o_test_non_index_bridging_options
                  Table "index_bridging.o_test_non_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_non_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
Options: index_bridging=true

BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_non_index_bridging_options ORDER BY i;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Index Scan using o_test_non_index_bridging_options_ix2 on o_test_non_index_bridging_options
(1 row)

SELECT * FROM o_test_non_index_bridging_options ORDER BY i;
 i  |    j    |    p    
----+---------+---------
  1 | {18,34} | (6,6)
  2 | {19,35} | (7,7)
  3 | {20,36} | (8,8)
  4 | {21,37} | (9,9)
  5 | {22,38} | (10,10)
  6 | {23,39} | (11,11)
  7 | {24,40} | (12,12)
  8 | {25,41} | (13,13)
  9 | {26,42} | (14,14)
 10 | {27,43} | (15,15)
(10 rows)

COMMIT;
ALTER TABLE o_test_non_index_bridging_options RESET (index_bridging);
ERROR:  cannot disable 'index_bridging' for a table with bridged indices
\d+ o_test_non_index_bridging_options
                  Table "index_bridging.o_test_non_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_non_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
Options: index_bridging=true

DROP INDEX o_test_non_index_bridging_options_ix2;
ALTER TABLE o_test_non_index_bridging_options RESET (index_bridging);
\d+ o_test_non_index_bridging_options
                  Table "index_bridging.o_test_non_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 

SELECT orioledb_tbl_indices('o_test_non_index_bridging_options'::regclass, true);
                orioledb_tbl_indices                 
-----------------------------------------------------
 Index ctid_primary                                 +
     Index type: primary, unique, ctid              +
     Leaf tuple size: 4, non-leaf tuple size: 1     +
     Non-leaf tuple fields: ctid                    +
     Leaf tuple fields: ctid, i, j, p               +
 Index toast                                        +
     Index type: secondary                          +
     Leaf tuple size: 4, non-leaf tuple size: 3     +
     Non-leaf tuple fields: ctid, attnum, chunknum  +
     Leaf tuple fields: ctid, attnum, chunknum, data+
 
(1 row)

SELECT orioledb_tbl_structure('o_test_non_index_bridging_options'::regclass, 'ne');
                              orioledb_tbl_structure                              
----------------------------------------------------------------------------------
 Index ctid_primary contents                                                     +
 Page 0: level = 0, maxKeyLen = 6, nVacatedBytes = 0                             +
 state = free, datoid equal, relnode equal, ix_type = primary, clean             +
     Leftmost, Rightmost                                                         +
   Chunk 0: offset = 0, location = 256, hikey location = 96, hikey = ('(0,2)')   +
     Item 0: offset = 264, tuple = ('(0,1)', '1', '{18,34}', '(6,6)')            +
   Chunk 1: offset = 1, location = 352, hikey location = 104, hikey = ('(0,3)')  +
     Item 1: offset = 360, tuple = ('(0,2)', '2', '{19,35}', '(7,7)')            +
   Chunk 2: offset = 2, location = 448, hikey location = 112, hikey = ('(0,4)')  +
     Item 2: offset = 456, tuple = ('(0,3)', '3', '{20,36}', '(8,8)')            +
   Chunk 3: offset = 3, location = 544, hikey location = 120, hikey = ('(0,5)')  +
     Item 3: offset = 552, tuple = ('(0,4)', '4', '{21,37}', '(9,9)')            +
   Chunk 4: offset = 4, location = 640, hikey location = 128, hikey = ('(0,6)')  +
     Item 4: offset = 648, tuple = ('(0,5)', '5', '{22,38}', '(10,10)')          +
   Chunk 5: offset = 5, location = 736, hikey location = 136, hikey = ('(0,7)')  +
     Item 5: offset = 744, tuple = ('(0,6)', '6', '{23,39}', '(11,11)')          +
   Chunk 6: offset = 6, location = 832, hikey location = 144, hikey = ('(0,8)')  +
     Item 6: offset = 840, tuple = ('(0,7)', '7', '{24,40}', '(12,12)')          +
   Chunk 7: offset = 7, location = 928, hikey location = 152, hikey = ('(0,9)')  +
     Item 7: offset = 936, tuple = ('(0,8)', '8', '{25,41}', '(13,13)')          +
   Chunk 8: offset = 8, location = 1024, hikey location = 160, hikey = ('(0,10)')+
     Item 8: offset = 1032, tuple = ('(0,9)', '9', '{26,42}', '(14,14)')         +
   Chunk 9: offset = 9, location = 1120, hikey location = 168                    +
     Item 9: offset = 1128, tuple = ('(0,10)', '10', '{27,43}', '(15,15)')       +
                                                                                 +
 Index toast: not loaded                                                         +
 
(1 row)

SELECT * FROM o_test_non_index_bridging_options;
 i  |    j    |    p    
----+---------+---------
  1 | {18,34} | (6,6)
  2 | {19,35} | (7,7)
  3 | {20,36} | (8,8)
  4 | {21,37} | (9,9)
  5 | {22,38} | (10,10)
  6 | {23,39} | (11,11)
  7 | {24,40} | (12,12)
  8 | {25,41} | (13,13)
  9 | {26,42} | (14,14)
 10 | {27,43} | (15,15)
(10 rows)

INSERT INTO o_test_non_index_bridging_options
	SELECT v, ARRAY[v+17,v+33], point(v + 5, v + 5) FROM generate_series(11, 15) v;
SELECT orioledb_tbl_structure('o_test_non_index_bridging_options'::regclass, 'ne');
                              orioledb_tbl_structure                              
----------------------------------------------------------------------------------
 Index ctid_primary contents                                                     +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                             +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty             +
     Leftmost, Rightmost                                                         +
   Chunk 0: offset = 0, location = 256, hikey location = 96, hikey = ('(0,2)')   +
     Item 0: offset = 264, tuple = ('(0,1)', '1', '{18,34}', '(6,6)')            +
   Chunk 1: offset = 1, location = 352, hikey location = 104, hikey = ('(0,3)')  +
     Item 1: offset = 360, tuple = ('(0,2)', '2', '{19,35}', '(7,7)')            +
   Chunk 2: offset = 2, location = 448, hikey location = 112, hikey = ('(0,4)')  +
     Item 2: offset = 456, tuple = ('(0,3)', '3', '{20,36}', '(8,8)')            +
   Chunk 3: offset = 3, location = 544, hikey location = 120, hikey = ('(0,5)')  +
     Item 3: offset = 552, tuple = ('(0,4)', '4', '{21,37}', '(9,9)')            +
   Chunk 4: offset = 4, location = 640, hikey location = 128, hikey = ('(0,6)')  +
     Item 4: offset = 648, tuple = ('(0,5)', '5', '{22,38}', '(10,10)')          +
   Chunk 5: offset = 5, location = 736, hikey location = 136, hikey = ('(0,7)')  +
     Item 5: offset = 744, tuple = ('(0,6)', '6', '{23,39}', '(11,11)')          +
   Chunk 6: offset = 6, location = 832, hikey location = 144, hikey = ('(0,8)')  +
     Item 6: offset = 840, tuple = ('(0,7)', '7', '{24,40}', '(12,12)')          +
   Chunk 7: offset = 7, location = 928, hikey location = 152, hikey = ('(0,9)')  +
     Item 7: offset = 936, tuple = ('(0,8)', '8', '{25,41}', '(13,13)')          +
   Chunk 8: offset = 8, location = 1024, hikey location = 160, hikey = ('(0,10)')+
     Item 8: offset = 1032, tuple = ('(0,9)', '9', '{26,42}', '(14,14)')         +
   Chunk 9: offset = 9, location = 1120, hikey location = 168                    +
     Item 9: offset = 1136, tuple = ('(0,10)', '10', '{27,43}', '(15,15)')       +
     Item 10: offset = 1224, tuple = ('(0,11)', '11', '{28,44}', '(16,16)')      +
     Item 11: offset = 1312, tuple = ('(0,12)', '12', '{29,45}', '(17,17)')      +
     Item 12: offset = 1400, tuple = ('(0,13)', '13', '{30,46}', '(18,18)')      +
     Item 13: offset = 1488, tuple = ('(0,14)', '14', '{31,47}', '(19,19)')      +
     Item 14: offset = 1576, tuple = ('(0,15)', '15', '{32,48}', '(20,20)')      +
                                                                                 +
 Index toast: not loaded                                                         +
 
(1 row)

SELECT * FROM o_test_non_index_bridging_options;
 i  |    j    |    p    
----+---------+---------
  1 | {18,34} | (6,6)
  2 | {19,35} | (7,7)
  3 | {20,36} | (8,8)
  4 | {21,37} | (9,9)
  5 | {22,38} | (10,10)
  6 | {23,39} | (11,11)
  7 | {24,40} | (12,12)
  8 | {25,41} | (13,13)
  9 | {26,42} | (14,14)
 10 | {27,43} | (15,15)
 11 | {28,44} | (16,16)
 12 | {29,45} | (17,17)
 13 | {30,46} | (18,18)
 14 | {31,47} | (19,19)
 15 | {32,48} | (20,20)
(15 rows)

CREATE INDEX o_test_non_index_bridging_options_ix1 ON o_test_non_index_bridging_options USING btree (i);
\d+ o_test_non_index_bridging_options
                  Table "index_bridging.o_test_non_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_non_index_bridging_options_ix1" btree (i)

CREATE INDEX o_test_non_index_bridging_options_ix2 ON o_test_non_index_bridging_options USING btree (i) WITH (orioledb_index = off);
WARNING:  using bridged btree index for orioledb
DETAIL:  This feature is intended for testing purposes and is not recommended for normal usage.
NOTICE:  index bridging is enabled for orioledb table 'o_test_non_index_bridging_options'
DETAIL:  index access method 'btree' is requested with index bridging for OrioleDB table
\d+ o_test_non_index_bridging_options
                  Table "index_bridging.o_test_non_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_non_index_bridging_options_ix1" btree (i)
    "o_test_non_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
Options: index_bridging=true

ALTER INDEX o_test_non_index_bridging_options_ix2 RESET (orioledb_index);
ERROR:  Cannot change 'orioledb_index' option for existing indices
\d+ o_test_non_index_bridging_options
                  Table "index_bridging.o_test_non_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_non_index_bridging_options_ix1" btree (i)
    "o_test_non_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
Options: index_bridging=true

ALTER INDEX o_test_non_index_bridging_options_ix1 SET (orioledb_index = off);
ERROR:  Cannot change 'orioledb_index' option for existing indices
\d+ o_test_non_index_bridging_options
                  Table "index_bridging.o_test_non_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_non_index_bridging_options_ix1" btree (i)
    "o_test_non_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
Options: index_bridging=true

ALTER TABLE o_test_non_index_bridging_options SET (index_bridging);
\d+ o_test_non_index_bridging_options
                  Table "index_bridging.o_test_non_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_non_index_bridging_options_ix1" btree (i)
    "o_test_non_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
Options: index_bridging=true

SELECT orioledb_tbl_indices('o_test_non_index_bridging_options'::regclass, true);
                   orioledb_tbl_indices                    
-----------------------------------------------------------
 Index ctid_primary                                       +
     Index type: primary, unique, ctid                    +
     Leaf tuple size: 5, non-leaf tuple size: 1           +
     Non-leaf tuple fields: ctid                          +
     Leaf tuple fields: ctid, index_bridging_ctid, i, j, p+
 Index o_test_non_index_bridging_options_ix1              +
     Index type: secondary                                +
     Leaf tuple size: 2, non-leaf tuple size: 2           +
     Non-leaf tuple fields: i, ctid                       +
     Leaf tuple fields: i, ctid                           +
 Index index_bridge                                       +
     Index type: secondary                                +
     Leaf tuple size: 2, non-leaf tuple size: 1           +
     Non-leaf tuple fields: index_bridging_ctid           +
     Leaf tuple fields: index_bridging_ctid, ctid         +
 Index toast                                              +
     Index type: secondary                                +
     Leaf tuple size: 4, non-leaf tuple size: 3           +
     Non-leaf tuple fields: ctid, attnum, chunknum        +
     Leaf tuple fields: ctid, attnum, chunknum, data      +
 
(1 row)

ALTER TABLE o_test_non_index_bridging_options RESET (index_bridging);
ERROR:  cannot disable 'index_bridging' for a table with bridged indices
\d+ o_test_non_index_bridging_options
                  Table "index_bridging.o_test_non_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_non_index_bridging_options_ix1" btree (i)
    "o_test_non_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
Options: index_bridging=true

SELECT orioledb_tbl_indices('o_test_non_index_bridging_options'::regclass, true);
                   orioledb_tbl_indices                    
-----------------------------------------------------------
 Index ctid_primary                                       +
     Index type: primary, unique, ctid                    +
     Leaf tuple size: 5, non-leaf tuple size: 1           +
     Non-leaf tuple fields: ctid                          +
     Leaf tuple fields: ctid, index_bridging_ctid, i, j, p+
 Index o_test_non_index_bridging_options_ix1              +
     Index type: secondary                                +
     Leaf tuple size: 2, non-leaf tuple size: 2           +
     Non-leaf tuple fields: i, ctid                       +
     Leaf tuple fields: i, ctid                           +
 Index index_bridge                                       +
     Index type: secondary                                +
     Leaf tuple size: 2, non-leaf tuple size: 1           +
     Non-leaf tuple fields: index_bridging_ctid           +
     Leaf tuple fields: index_bridging_ctid, ctid         +
 Index toast                                              +
     Index type: secondary                                +
     Leaf tuple size: 4, non-leaf tuple size: 3           +
     Non-leaf tuple fields: ctid, attnum, chunknum        +
     Leaf tuple fields: ctid, attnum, chunknum, data      +
 
(1 row)

SELECT orioledb_tbl_structure('o_test_non_index_bridging_options'::regclass, 'ne');
                                orioledb_tbl_structure                                
--------------------------------------------------------------------------------------
 Index ctid_primary contents                                                         +
 Page 0: level = 0, maxKeyLen = 6, nVacatedBytes = 0                                 +
 state = free, datoid equal, relnode equal, ix_type = primary, clean                 +
     Leftmost, Rightmost                                                             +
   Chunk 0: offset = 0, location = 256, hikey location = 120, hikey = ('(0,2)')      +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,1)', '1', '{18,34}', '(6,6)')       +
   Chunk 1: offset = 1, location = 352, hikey location = 128, hikey = ('(0,3)')      +
     Item 1: offset = 360, tuple = ('(0,2)', '(0,2)', '2', '{19,35}', '(7,7)')       +
   Chunk 2: offset = 2, location = 448, hikey location = 136, hikey = ('(0,4)')      +
     Item 2: offset = 456, tuple = ('(0,3)', '(0,3)', '3', '{20,36}', '(8,8)')       +
   Chunk 3: offset = 3, location = 544, hikey location = 144, hikey = ('(0,5)')      +
     Item 3: offset = 552, tuple = ('(0,4)', '(0,4)', '4', '{21,37}', '(9,9)')       +
   Chunk 4: offset = 4, location = 640, hikey location = 152, hikey = ('(0,6)')      +
     Item 4: offset = 648, tuple = ('(0,5)', '(0,5)', '5', '{22,38}', '(10,10)')     +
   Chunk 5: offset = 5, location = 736, hikey location = 160, hikey = ('(0,7)')      +
     Item 5: offset = 744, tuple = ('(0,6)', '(0,6)', '6', '{23,39}', '(11,11)')     +
   Chunk 6: offset = 6, location = 832, hikey location = 168, hikey = ('(0,8)')      +
     Item 6: offset = 840, tuple = ('(0,7)', '(0,7)', '7', '{24,40}', '(12,12)')     +
   Chunk 7: offset = 7, location = 928, hikey location = 176, hikey = ('(0,9)')      +
     Item 7: offset = 936, tuple = ('(0,8)', '(0,8)', '8', '{25,41}', '(13,13)')     +
   Chunk 8: offset = 8, location = 1024, hikey location = 184, hikey = ('(0,10)')    +
     Item 8: offset = 1032, tuple = ('(0,9)', '(0,9)', '9', '{26,42}', '(14,14)')    +
   Chunk 9: offset = 9, location = 1120, hikey location = 192, hikey = ('(0,11)')    +
     Item 9: offset = 1128, tuple = ('(0,10)', '(0,10)', '10', '{27,43}', '(15,15)') +
   Chunk 10: offset = 10, location = 1216, hikey location = 200, hikey = ('(0,12)')  +
     Item 10: offset = 1224, tuple = ('(0,11)', '(0,11)', '11', '{28,44}', '(16,16)')+
   Chunk 11: offset = 11, location = 1312, hikey location = 208, hikey = ('(0,13)')  +
     Item 11: offset = 1320, tuple = ('(0,12)', '(0,12)', '12', '{29,45}', '(17,17)')+
   Chunk 12: offset = 12, location = 1408, hikey location = 216, hikey = ('(0,14)')  +
     Item 12: offset = 1416, tuple = ('(0,13)', '(0,13)', '13', '{30,46}', '(18,18)')+
   Chunk 13: offset = 13, location = 1504, hikey location = 224, hikey = ('(0,15)')  +
     Item 13: offset = 1512, tuple = ('(0,14)', '(0,14)', '14', '{31,47}', '(19,19)')+
   Chunk 14: offset = 14, location = 1600, hikey location = 232                      +
     Item 14: offset = 1608, tuple = ('(0,15)', '(0,15)', '15', '{32,48}', '(20,20)')+
                                                                                     +
 Index o_test_non_index_bridging_options_ix1: not loaded                             +
 Index index_bridge: not loaded                                                      +
 Index toast: not loaded                                                             +
 
(1 row)

SELECT * FROM o_test_non_index_bridging_options;
 i  |    j    |    p    
----+---------+---------
  1 | {18,34} | (6,6)
  2 | {19,35} | (7,7)
  3 | {20,36} | (8,8)
  4 | {21,37} | (9,9)
  5 | {22,38} | (10,10)
  6 | {23,39} | (11,11)
  7 | {24,40} | (12,12)
  8 | {25,41} | (13,13)
  9 | {26,42} | (14,14)
 10 | {27,43} | (15,15)
 11 | {28,44} | (16,16)
 12 | {29,45} | (17,17)
 13 | {30,46} | (18,18)
 14 | {31,47} | (19,19)
 15 | {32,48} | (20,20)
(15 rows)

ALTER TABLE o_test_non_index_bridging_options ADD PRIMARY KEY (i);
\d+ o_test_non_index_bridging_options
                  Table "index_bridging.o_test_non_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_non_index_bridging_options_pkey" PRIMARY KEY, btree (i)
    "o_test_non_index_bridging_options_ix1" btree (i)
    "o_test_non_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
Options: index_bridging=true

SELECT orioledb_tbl_indices('o_test_non_index_bridging_options'::regclass, true);
                orioledb_tbl_indices                 
-----------------------------------------------------
 Index o_test_non_index_bridging_options_pkey       +
     Index type: primary, unique                    +
     Leaf tuple size: 4, non-leaf tuple size: 1     +
     Non-leaf tuple fields: i                       +
     Leaf tuple fields: index_bridging_ctid, i, j, p+
 Index o_test_non_index_bridging_options_ix1        +
     Index type: secondary                          +
     Leaf tuple size: 1, non-leaf tuple size: 1     +
     Non-leaf tuple fields: i                       +
     Leaf tuple fields: i                           +
 Index index_bridge                                 +
     Index type: secondary                          +
     Leaf tuple size: 2, non-leaf tuple size: 1     +
     Non-leaf tuple fields: index_bridging_ctid     +
     Leaf tuple fields: index_bridging_ctid, i      +
 Index toast                                        +
     Index type: secondary                          +
     Leaf tuple size: 4, non-leaf tuple size: 3     +
     Non-leaf tuple fields: i, attnum, chunknum     +
     Leaf tuple fields: i, attnum, chunknum, data   +
 
(1 row)

SELECT orioledb_tbl_structure('o_test_non_index_bridging_options'::regclass, 'ne');
                             orioledb_tbl_structure                             
--------------------------------------------------------------------------------
 Index o_test_non_index_bridging_options_pkey contents                         +
 Page 0: level = 0, maxKeyLen = 4, nVacatedBytes = 0                           +
 state = free, datoid equal, relnode equal, ix_type = primary, clean           +
     Leftmost, Rightmost                                                       +
   Chunk 0: offset = 0, location = 256, hikey location = 120, hikey = ('2')    +
     Item 0: offset = 264, tuple = ('(0,1)', '1', '{18,34}', '(6,6)')          +
   Chunk 1: offset = 1, location = 352, hikey location = 128, hikey = ('3')    +
     Item 1: offset = 360, tuple = ('(0,2)', '2', '{19,35}', '(7,7)')          +
   Chunk 2: offset = 2, location = 448, hikey location = 136, hikey = ('4')    +
     Item 2: offset = 456, tuple = ('(0,3)', '3', '{20,36}', '(8,8)')          +
   Chunk 3: offset = 3, location = 544, hikey location = 144, hikey = ('5')    +
     Item 3: offset = 552, tuple = ('(0,4)', '4', '{21,37}', '(9,9)')          +
   Chunk 4: offset = 4, location = 640, hikey location = 152, hikey = ('6')    +
     Item 4: offset = 648, tuple = ('(0,5)', '5', '{22,38}', '(10,10)')        +
   Chunk 5: offset = 5, location = 736, hikey location = 160, hikey = ('7')    +
     Item 5: offset = 744, tuple = ('(0,6)', '6', '{23,39}', '(11,11)')        +
   Chunk 6: offset = 6, location = 832, hikey location = 168, hikey = ('8')    +
     Item 6: offset = 840, tuple = ('(0,7)', '7', '{24,40}', '(12,12)')        +
   Chunk 7: offset = 7, location = 928, hikey location = 176, hikey = ('9')    +
     Item 7: offset = 936, tuple = ('(0,8)', '8', '{25,41}', '(13,13)')        +
   Chunk 8: offset = 8, location = 1024, hikey location = 184, hikey = ('10')  +
     Item 8: offset = 1032, tuple = ('(0,9)', '9', '{26,42}', '(14,14)')       +
   Chunk 9: offset = 9, location = 1120, hikey location = 192, hikey = ('11')  +
     Item 9: offset = 1128, tuple = ('(0,10)', '10', '{27,43}', '(15,15)')     +
   Chunk 10: offset = 10, location = 1216, hikey location = 200, hikey = ('12')+
     Item 10: offset = 1224, tuple = ('(0,11)', '11', '{28,44}', '(16,16)')    +
   Chunk 11: offset = 11, location = 1312, hikey location = 208, hikey = ('13')+
     Item 11: offset = 1320, tuple = ('(0,12)', '12', '{29,45}', '(17,17)')    +
   Chunk 12: offset = 12, location = 1408, hikey location = 216, hikey = ('14')+
     Item 12: offset = 1416, tuple = ('(0,13)', '13', '{30,46}', '(18,18)')    +
   Chunk 13: offset = 13, location = 1504, hikey location = 224, hikey = ('15')+
     Item 13: offset = 1512, tuple = ('(0,14)', '14', '{31,47}', '(19,19)')    +
   Chunk 14: offset = 14, location = 1600, hikey location = 232                +
     Item 14: offset = 1608, tuple = ('(0,15)', '15', '{32,48}', '(20,20)')    +
                                                                               +
 Index o_test_non_index_bridging_options_ix1: not loaded                       +
 Index index_bridge: not loaded                                                +
 Index toast: not loaded                                                       +
 
(1 row)

SELECT * FROM o_test_non_index_bridging_options;
 i  |    j    |    p    
----+---------+---------
  1 | {18,34} | (6,6)
  2 | {19,35} | (7,7)
  3 | {20,36} | (8,8)
  4 | {21,37} | (9,9)
  5 | {22,38} | (10,10)
  6 | {23,39} | (11,11)
  7 | {24,40} | (12,12)
  8 | {25,41} | (13,13)
  9 | {26,42} | (14,14)
 10 | {27,43} | (15,15)
 11 | {28,44} | (16,16)
 12 | {29,45} | (17,17)
 13 | {30,46} | (18,18)
 14 | {31,47} | (19,19)
 15 | {32,48} | (20,20)
(15 rows)

INSERT INTO o_test_non_index_bridging_options
	SELECT v, ARRAY[v+17,v+33], point(v + 5, v + 5) FROM generate_series(16, 20) v;
SELECT orioledb_tbl_structure('o_test_non_index_bridging_options'::regclass, 'ne');
                              orioledb_tbl_structure                               
-----------------------------------------------------------------------------------
 Index o_test_non_index_bridging_options_pkey contents                            +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                              +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty              +
     Leftmost, Rightmost                                                          +
   Chunk 0: offset = 0, location = 256, hikey location = 120, hikey = ('2')       +
     Item 0: offset = 264, tuple = ('(0,1)', '1', '{18,34}', '(6,6)')             +
   Chunk 1: offset = 1, location = 352, hikey location = 128, hikey = ('3')       +
     Item 1: offset = 360, tuple = ('(0,2)', '2', '{19,35}', '(7,7)')             +
   Chunk 2: offset = 2, location = 448, hikey location = 136, hikey = ('4')       +
     Item 2: offset = 456, tuple = ('(0,3)', '3', '{20,36}', '(8,8)')             +
   Chunk 3: offset = 3, location = 544, hikey location = 144, hikey = ('5')       +
     Item 3: offset = 552, tuple = ('(0,4)', '4', '{21,37}', '(9,9)')             +
   Chunk 4: offset = 4, location = 640, hikey location = 152, hikey = ('6')       +
     Item 4: offset = 648, tuple = ('(0,5)', '5', '{22,38}', '(10,10)')           +
   Chunk 5: offset = 5, location = 736, hikey location = 160, hikey = ('7')       +
     Item 5: offset = 744, tuple = ('(0,6)', '6', '{23,39}', '(11,11)')           +
   Chunk 6: offset = 6, location = 832, hikey location = 168, hikey = ('8')       +
     Item 6: offset = 840, tuple = ('(0,7)', '7', '{24,40}', '(12,12)')           +
   Chunk 7: offset = 7, location = 928, hikey location = 176, hikey = ('9')       +
     Item 7: offset = 936, tuple = ('(0,8)', '8', '{25,41}', '(13,13)')           +
   Chunk 8: offset = 8, location = 1024, hikey location = 184, hikey = ('10')     +
     Item 8: offset = 1032, tuple = ('(0,9)', '9', '{26,42}', '(14,14)')          +
   Chunk 9: offset = 9, location = 1120, hikey location = 192, hikey = ('11')     +
     Item 9: offset = 1128, tuple = ('(0,10)', '10', '{27,43}', '(15,15)')        +
   Chunk 10: offset = 10, location = 1216, hikey location = 200, hikey = ('12')   +
     Item 10: offset = 1224, tuple = ('(0,11)', '11', '{28,44}', '(16,16)')       +
   Chunk 11: offset = 11, location = 1312, hikey location = 208, hikey = ('13')   +
     Item 11: offset = 1320, tuple = ('(0,12)', '12', '{29,45}', '(17,17)')       +
   Chunk 12: offset = 12, location = 1408, hikey location = 216, hikey = ('14')   +
     Item 12: offset = 1416, tuple = ('(0,13)', '13', '{30,46}', '(18,18)')       +
   Chunk 13: offset = 13, location = 1504, hikey location = 224, hikey = ('15')   +
     Item 13: offset = 1512, tuple = ('(0,14)', '14', '{31,47}', '(19,19)')       +
   Chunk 14: offset = 14, location = 1600, hikey location = 232                   +
     Item 14: offset = 1616, tuple = ('(0,15)', '15', '{32,48}', '(20,20)')       +
     Item 15: offset = 1704, tuple = ('(0,16)', '16', '{33,49}', '(21,21)')       +
     Item 16: offset = 1792, tuple = ('(0,17)', '17', '{34,50}', '(22,22)')       +
     Item 17: offset = 1880, tuple = ('(0,18)', '18', '{35,51}', '(23,23)')       +
     Item 18: offset = 1968, tuple = ('(0,19)', '19', '{36,52}', '(24,24)')       +
     Item 19: offset = 2056, tuple = ('(0,20)', '20', '{37,53}', '(25,25)')       +
                                                                                  +
 Index o_test_non_index_bridging_options_ix1 contents                             +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                              +
 state = free, datoid equal, relnode equal, ix_type = regular, dirty              +
     Leftmost, Rightmost                                                          +
   Chunk 0: offset = 0, location = 256, hikey location = 120, hikey = ('2')       +
     Item 0: offset = 264, tuple = ('1')                                          +
   Chunk 1: offset = 1, location = 288, hikey location = 128, hikey = ('3')       +
     Item 1: offset = 296, tuple = ('2')                                          +
   Chunk 2: offset = 2, location = 320, hikey location = 136, hikey = ('4')       +
     Item 2: offset = 328, tuple = ('3')                                          +
   Chunk 3: offset = 3, location = 352, hikey location = 144, hikey = ('5')       +
     Item 3: offset = 360, tuple = ('4')                                          +
   Chunk 4: offset = 4, location = 384, hikey location = 152, hikey = ('6')       +
     Item 4: offset = 392, tuple = ('5')                                          +
   Chunk 5: offset = 5, location = 416, hikey location = 160, hikey = ('7')       +
     Item 5: offset = 424, tuple = ('6')                                          +
   Chunk 6: offset = 6, location = 448, hikey location = 168, hikey = ('8')       +
     Item 6: offset = 456, tuple = ('7')                                          +
   Chunk 7: offset = 7, location = 480, hikey location = 176, hikey = ('9')       +
     Item 7: offset = 488, tuple = ('8')                                          +
   Chunk 8: offset = 8, location = 512, hikey location = 184, hikey = ('10')      +
     Item 8: offset = 520, tuple = ('9')                                          +
   Chunk 9: offset = 9, location = 544, hikey location = 192, hikey = ('11')      +
     Item 9: offset = 552, tuple = ('10')                                         +
   Chunk 10: offset = 10, location = 576, hikey location = 200, hikey = ('12')    +
     Item 10: offset = 584, tuple = ('11')                                        +
   Chunk 11: offset = 11, location = 608, hikey location = 208, hikey = ('13')    +
     Item 11: offset = 616, tuple = ('12')                                        +
   Chunk 12: offset = 12, location = 640, hikey location = 216, hikey = ('14')    +
     Item 12: offset = 648, tuple = ('13')                                        +
   Chunk 13: offset = 13, location = 672, hikey location = 224, hikey = ('15')    +
     Item 13: offset = 680, tuple = ('14')                                        +
   Chunk 14: offset = 14, location = 704, hikey location = 232                    +
     Item 14: offset = 720, tuple = ('15')                                        +
     Item 15: offset = 744, tuple = ('16')                                        +
     Item 16: offset = 768, tuple = ('17')                                        +
     Item 17: offset = 792, tuple = ('18')                                        +
     Item 18: offset = 816, tuple = ('19')                                        +
     Item 19: offset = 840, tuple = ('20')                                        +
                                                                                  +
 Index index_bridge contents                                                      +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                              +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty               +
     Leftmost, Rightmost                                                          +
   Chunk 0: offset = 0, location = 256, hikey location = 120, hikey = ('(0,2)')   +
     Item 0: offset = 264, tuple = ('(0,1)', '1')                                 +
   Chunk 1: offset = 1, location = 296, hikey location = 128, hikey = ('(0,3)')   +
     Item 1: offset = 304, tuple = ('(0,2)', '2')                                 +
   Chunk 2: offset = 2, location = 336, hikey location = 136, hikey = ('(0,4)')   +
     Item 2: offset = 344, tuple = ('(0,3)', '3')                                 +
   Chunk 3: offset = 3, location = 376, hikey location = 144, hikey = ('(0,5)')   +
     Item 3: offset = 384, tuple = ('(0,4)', '4')                                 +
   Chunk 4: offset = 4, location = 416, hikey location = 152, hikey = ('(0,6)')   +
     Item 4: offset = 424, tuple = ('(0,5)', '5')                                 +
   Chunk 5: offset = 5, location = 456, hikey location = 160, hikey = ('(0,7)')   +
     Item 5: offset = 464, tuple = ('(0,6)', '6')                                 +
   Chunk 6: offset = 6, location = 496, hikey location = 168, hikey = ('(0,8)')   +
     Item 6: offset = 504, tuple = ('(0,7)', '7')                                 +
   Chunk 7: offset = 7, location = 536, hikey location = 176, hikey = ('(0,9)')   +
     Item 7: offset = 544, tuple = ('(0,8)', '8')                                 +
   Chunk 8: offset = 8, location = 576, hikey location = 184, hikey = ('(0,10)')  +
     Item 8: offset = 584, tuple = ('(0,9)', '9')                                 +
   Chunk 9: offset = 9, location = 616, hikey location = 192, hikey = ('(0,11)')  +
     Item 9: offset = 624, tuple = ('(0,10)', '10')                               +
   Chunk 10: offset = 10, location = 656, hikey location = 200, hikey = ('(0,12)')+
     Item 10: offset = 664, tuple = ('(0,11)', '11')                              +
   Chunk 11: offset = 11, location = 696, hikey location = 208, hikey = ('(0,13)')+
     Item 11: offset = 704, tuple = ('(0,12)', '12')                              +
   Chunk 12: offset = 12, location = 736, hikey location = 216, hikey = ('(0,14)')+
     Item 12: offset = 744, tuple = ('(0,13)', '13')                              +
   Chunk 13: offset = 13, location = 776, hikey location = 224, hikey = ('(0,15)')+
     Item 13: offset = 784, tuple = ('(0,14)', '14')                              +
   Chunk 14: offset = 14, location = 816, hikey location = 232                    +
     Item 14: offset = 832, tuple = ('(0,15)', '15')                              +
     Item 15: offset = 864, tuple = ('(0,16)', '16')                              +
     Item 16: offset = 896, tuple = ('(0,17)', '17')                              +
     Item 17: offset = 928, tuple = ('(0,18)', '18')                              +
     Item 18: offset = 960, tuple = ('(0,19)', '19')                              +
     Item 19: offset = 992, tuple = ('(0,20)', '20')                              +
                                                                                  +
 Index toast: not loaded                                                          +
 
(1 row)

DROP INDEX o_test_non_index_bridging_options_ix1;
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_non_index_bridging_options ORDER BY i;
                           QUERY PLAN                            
-----------------------------------------------------------------
 Custom Scan (o_scan) on o_test_non_index_bridging_options
   Forward index scan of: o_test_non_index_bridging_options_pkey
(2 rows)

SELECT * FROM o_test_non_index_bridging_options ORDER BY i;
 i  |    j    |    p    
----+---------+---------
  1 | {18,34} | (6,6)
  2 | {19,35} | (7,7)
  3 | {20,36} | (8,8)
  4 | {21,37} | (9,9)
  5 | {22,38} | (10,10)
  6 | {23,39} | (11,11)
  7 | {24,40} | (12,12)
  8 | {25,41} | (13,13)
  9 | {26,42} | (14,14)
 10 | {27,43} | (15,15)
 11 | {28,44} | (16,16)
 12 | {29,45} | (17,17)
 13 | {30,46} | (18,18)
 14 | {31,47} | (19,19)
 15 | {32,48} | (20,20)
 16 | {33,49} | (21,21)
 17 | {34,50} | (22,22)
 18 | {35,51} | (23,23)
 19 | {36,52} | (24,24)
 20 | {37,53} | (25,25)
(20 rows)

COMMIT;
DROP INDEX o_test_non_index_bridging_options_ix2;
ALTER TABLE o_test_non_index_bridging_options RESET (index_bridging);
\d+ o_test_non_index_bridging_options
                  Table "index_bridging.o_test_non_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_non_index_bridging_options_pkey" PRIMARY KEY, btree (i)

ALTER TABLE o_test_non_index_bridging_options DROP CONSTRAINT o_test_non_index_bridging_options_pkey;
\d+ o_test_non_index_bridging_options
                  Table "index_bridging.o_test_non_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 

SELECT orioledb_tbl_indices('o_test_non_index_bridging_options'::regclass, true);
                orioledb_tbl_indices                 
-----------------------------------------------------
 Index ctid_primary                                 +
     Index type: primary, unique, ctid              +
     Leaf tuple size: 4, non-leaf tuple size: 1     +
     Non-leaf tuple fields: ctid                    +
     Leaf tuple fields: ctid, i, j, p               +
 Index toast                                        +
     Index type: secondary                          +
     Leaf tuple size: 4, non-leaf tuple size: 3     +
     Non-leaf tuple fields: ctid, attnum, chunknum  +
     Leaf tuple fields: ctid, attnum, chunknum, data+
 
(1 row)

SELECT orioledb_tbl_structure('o_test_non_index_bridging_options'::regclass, 'ne');
                              orioledb_tbl_structure                               
-----------------------------------------------------------------------------------
 Index ctid_primary contents                                                      +
 Page 0: level = 0, maxKeyLen = 6, nVacatedBytes = 0                              +
 state = free, datoid equal, relnode equal, ix_type = primary, clean              +
     Leftmost, Rightmost                                                          +
   Chunk 0: offset = 0, location = 256, hikey location = 96, hikey = ('(0,3)')    +
     Item 0: offset = 264, tuple = ('(0,1)', '1', '{18,34}', '(6,6)')             +
     Item 1: offset = 352, tuple = ('(0,2)', '2', '{19,35}', '(7,7)')             +
   Chunk 1: offset = 2, location = 440, hikey location = 104, hikey = ('(0,5)')   +
     Item 2: offset = 448, tuple = ('(0,3)', '3', '{20,36}', '(8,8)')             +
     Item 3: offset = 536, tuple = ('(0,4)', '4', '{21,37}', '(9,9)')             +
   Chunk 2: offset = 4, location = 624, hikey location = 112, hikey = ('(0,7)')   +
     Item 4: offset = 632, tuple = ('(0,5)', '5', '{22,38}', '(10,10)')           +
     Item 5: offset = 720, tuple = ('(0,6)', '6', '{23,39}', '(11,11)')           +
   Chunk 3: offset = 6, location = 808, hikey location = 120, hikey = ('(0,9)')   +
     Item 6: offset = 816, tuple = ('(0,7)', '7', '{24,40}', '(12,12)')           +
     Item 7: offset = 904, tuple = ('(0,8)', '8', '{25,41}', '(13,13)')           +
   Chunk 4: offset = 8, location = 992, hikey location = 128, hikey = ('(0,11)')  +
     Item 8: offset = 1000, tuple = ('(0,9)', '9', '{26,42}', '(14,14)')          +
     Item 9: offset = 1088, tuple = ('(0,10)', '10', '{27,43}', '(15,15)')        +
   Chunk 5: offset = 10, location = 1176, hikey location = 136, hikey = ('(0,13)')+
     Item 10: offset = 1184, tuple = ('(0,11)', '11', '{28,44}', '(16,16)')       +
     Item 11: offset = 1272, tuple = ('(0,12)', '12', '{29,45}', '(17,17)')       +
   Chunk 6: offset = 12, location = 1360, hikey location = 144, hikey = ('(0,15)')+
     Item 12: offset = 1368, tuple = ('(0,13)', '13', '{30,46}', '(18,18)')       +
     Item 13: offset = 1456, tuple = ('(0,14)', '14', '{31,47}', '(19,19)')       +
   Chunk 7: offset = 14, location = 1544, hikey location = 152, hikey = ('(0,17)')+
     Item 14: offset = 1552, tuple = ('(0,15)', '15', '{32,48}', '(20,20)')       +
     Item 15: offset = 1640, tuple = ('(0,16)', '16', '{33,49}', '(21,21)')       +
   Chunk 8: offset = 16, location = 1728, hikey location = 160, hikey = ('(0,19)')+
     Item 16: offset = 1736, tuple = ('(0,17)', '17', '{34,50}', '(22,22)')       +
     Item 17: offset = 1824, tuple = ('(0,18)', '18', '{35,51}', '(23,23)')       +
   Chunk 9: offset = 18, location = 1912, hikey location = 168                    +
     Item 18: offset = 1920, tuple = ('(0,19)', '19', '{36,52}', '(24,24)')       +
     Item 19: offset = 2008, tuple = ('(0,20)', '20', '{37,53}', '(25,25)')       +
                                                                                  +
 Index toast: not loaded                                                          +
 
(1 row)

SELECT * FROM o_test_non_index_bridging_options;
 i  |    j    |    p    
----+---------+---------
  1 | {18,34} | (6,6)
  2 | {19,35} | (7,7)
  3 | {20,36} | (8,8)
  4 | {21,37} | (9,9)
  5 | {22,38} | (10,10)
  6 | {23,39} | (11,11)
  7 | {24,40} | (12,12)
  8 | {25,41} | (13,13)
  9 | {26,42} | (14,14)
 10 | {27,43} | (15,15)
 11 | {28,44} | (16,16)
 12 | {29,45} | (17,17)
 13 | {30,46} | (18,18)
 14 | {31,47} | (19,19)
 15 | {32,48} | (20,20)
 16 | {33,49} | (21,21)
 17 | {34,50} | (22,22)
 18 | {35,51} | (23,23)
 19 | {36,52} | (24,24)
 20 | {37,53} | (25,25)
(20 rows)

INSERT INTO o_test_non_index_bridging_options
	SELECT v, ARRAY[v+17,v+33], point(v + 5, v + 5) FROM generate_series(21, 25) v;
SELECT orioledb_tbl_structure('o_test_non_index_bridging_options'::regclass, 'ne');
                              orioledb_tbl_structure                               
-----------------------------------------------------------------------------------
 Index ctid_primary contents                                                      +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                              +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty              +
     Leftmost, Rightmost                                                          +
   Chunk 0: offset = 0, location = 256, hikey location = 96, hikey = ('(0,3)')    +
     Item 0: offset = 264, tuple = ('(0,1)', '1', '{18,34}', '(6,6)')             +
     Item 1: offset = 352, tuple = ('(0,2)', '2', '{19,35}', '(7,7)')             +
   Chunk 1: offset = 2, location = 440, hikey location = 104, hikey = ('(0,5)')   +
     Item 2: offset = 448, tuple = ('(0,3)', '3', '{20,36}', '(8,8)')             +
     Item 3: offset = 536, tuple = ('(0,4)', '4', '{21,37}', '(9,9)')             +
   Chunk 2: offset = 4, location = 624, hikey location = 112, hikey = ('(0,7)')   +
     Item 4: offset = 632, tuple = ('(0,5)', '5', '{22,38}', '(10,10)')           +
     Item 5: offset = 720, tuple = ('(0,6)', '6', '{23,39}', '(11,11)')           +
   Chunk 3: offset = 6, location = 808, hikey location = 120, hikey = ('(0,9)')   +
     Item 6: offset = 816, tuple = ('(0,7)', '7', '{24,40}', '(12,12)')           +
     Item 7: offset = 904, tuple = ('(0,8)', '8', '{25,41}', '(13,13)')           +
   Chunk 4: offset = 8, location = 992, hikey location = 128, hikey = ('(0,11)')  +
     Item 8: offset = 1000, tuple = ('(0,9)', '9', '{26,42}', '(14,14)')          +
     Item 9: offset = 1088, tuple = ('(0,10)', '10', '{27,43}', '(15,15)')        +
   Chunk 5: offset = 10, location = 1176, hikey location = 136, hikey = ('(0,13)')+
     Item 10: offset = 1184, tuple = ('(0,11)', '11', '{28,44}', '(16,16)')       +
     Item 11: offset = 1272, tuple = ('(0,12)', '12', '{29,45}', '(17,17)')       +
   Chunk 6: offset = 12, location = 1360, hikey location = 144, hikey = ('(0,15)')+
     Item 12: offset = 1368, tuple = ('(0,13)', '13', '{30,46}', '(18,18)')       +
     Item 13: offset = 1456, tuple = ('(0,14)', '14', '{31,47}', '(19,19)')       +
   Chunk 7: offset = 14, location = 1544, hikey location = 152, hikey = ('(0,17)')+
     Item 14: offset = 1552, tuple = ('(0,15)', '15', '{32,48}', '(20,20)')       +
     Item 15: offset = 1640, tuple = ('(0,16)', '16', '{33,49}', '(21,21)')       +
   Chunk 8: offset = 16, location = 1728, hikey location = 160, hikey = ('(0,19)')+
     Item 16: offset = 1736, tuple = ('(0,17)', '17', '{34,50}', '(22,22)')       +
     Item 17: offset = 1824, tuple = ('(0,18)', '18', '{35,51}', '(23,23)')       +
   Chunk 9: offset = 18, location = 1912, hikey location = 168                    +
     Item 18: offset = 1928, tuple = ('(0,19)', '19', '{36,52}', '(24,24)')       +
     Item 19: offset = 2016, tuple = ('(0,20)', '20', '{37,53}', '(25,25)')       +
     Item 20: offset = 2104, tuple = ('(0,21)', '21', '{38,54}', '(26,26)')       +
     Item 21: offset = 2192, tuple = ('(0,22)', '22', '{39,55}', '(27,27)')       +
     Item 22: offset = 2280, tuple = ('(0,23)', '23', '{40,56}', '(28,28)')       +
     Item 23: offset = 2368, tuple = ('(0,24)', '24', '{41,57}', '(29,29)')       +
     Item 24: offset = 2456, tuple = ('(0,25)', '25', '{42,58}', '(30,30)')       +
                                                                                  +
 Index toast: not loaded                                                          +
 
(1 row)

CREATE INDEX o_test_non_index_bridging_options_ix2 ON o_test_non_index_bridging_options USING btree (i) WITH (orioledb_index = off);
WARNING:  using bridged btree index for orioledb
DETAIL:  This feature is intended for testing purposes and is not recommended for normal usage.
NOTICE:  index bridging is enabled for orioledb table 'o_test_non_index_bridging_options'
DETAIL:  index access method 'btree' is requested with index bridging for OrioleDB table
\d+ o_test_non_index_bridging_options
                  Table "index_bridging.o_test_non_index_bridging_options"
 Column |   Type    | Collation | Nullable | Default | Storage  | Stats target | Description 
--------+-----------+-----------+----------+---------+----------+--------------+-------------
 i      | integer   |           | not null |         | plain    |              | 
 j      | integer[] |           |          |         | extended |              | 
 p      | point     |           |          |         | plain    |              | 
Indexes:
    "o_test_non_index_bridging_options_ix2" btree (i) WITH (orioledb_index=off)
Options: index_bridging=true

SELECT orioledb_tbl_indices('o_test_non_index_bridging_options'::regclass, true);
                   orioledb_tbl_indices                    
-----------------------------------------------------------
 Index ctid_primary                                       +
     Index type: primary, unique, ctid                    +
     Leaf tuple size: 5, non-leaf tuple size: 1           +
     Non-leaf tuple fields: ctid                          +
     Leaf tuple fields: ctid, index_bridging_ctid, i, j, p+
 Index index_bridge                                       +
     Index type: secondary                                +
     Leaf tuple size: 2, non-leaf tuple size: 1           +
     Non-leaf tuple fields: index_bridging_ctid           +
     Leaf tuple fields: index_bridging_ctid, ctid         +
 Index toast                                              +
     Index type: secondary                                +
     Leaf tuple size: 4, non-leaf tuple size: 3           +
     Non-leaf tuple fields: ctid, attnum, chunknum        +
     Leaf tuple fields: ctid, attnum, chunknum, data      +
 
(1 row)

BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_non_index_bridging_options ORDER BY i;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Index Scan using o_test_non_index_bridging_options_ix2 on o_test_non_index_bridging_options
(1 row)

SELECT * FROM o_test_non_index_bridging_options ORDER BY i;
 i  |    j    |    p    
----+---------+---------
  1 | {18,34} | (6,6)
  2 | {19,35} | (7,7)
  3 | {20,36} | (8,8)
  4 | {21,37} | (9,9)
  5 | {22,38} | (10,10)
  6 | {23,39} | (11,11)
  7 | {24,40} | (12,12)
  8 | {25,41} | (13,13)
  9 | {26,42} | (14,14)
 10 | {27,43} | (15,15)
 11 | {28,44} | (16,16)
 12 | {29,45} | (17,17)
 13 | {30,46} | (18,18)
 14 | {31,47} | (19,19)
 15 | {32,48} | (20,20)
 16 | {33,49} | (21,21)
 17 | {34,50} | (22,22)
 18 | {35,51} | (23,23)
 19 | {36,52} | (24,24)
 20 | {37,53} | (25,25)
 21 | {38,54} | (26,26)
 22 | {39,55} | (27,27)
 23 | {40,56} | (28,28)
 24 | {41,57} | (29,29)
 25 | {42,58} | (30,30)
(25 rows)

COMMIT;
create table o_test_toastable_offset(i int, b int, a text, m int) using orioledb;
alter table o_test_toastable_offset set (index_bridging=on);
insert into o_test_toastable_offset values (4,6,'X',11);
insert into o_test_toastable_offset values (1,3,'Y',12);
delete from o_test_toastable_offset;
CREATE TABLE o_test_bridged_hash_btree_bitmap_scans (
	id integer NOT NULL,
	t text NOT NULL,
	v int4[],
	PRIMARY KEY(id)
) USING orioledb;
SELECT orioledb_tbl_indices('o_test_bridged_hash_btree_bitmap_scans'::regclass, true);
               orioledb_tbl_indices                
---------------------------------------------------
 Index o_test_bridged_hash_btree_bitmap_scans_pkey+
     Index type: primary, unique                  +
     Leaf tuple size: 3, non-leaf tuple size: 1   +
     Non-leaf tuple fields: id                    +
     Leaf tuple fields: id, t, v                  +
 Index toast                                      +
     Index type: secondary                        +
     Leaf tuple size: 4, non-leaf tuple size: 3   +
     Non-leaf tuple fields: id, attnum, chunknum  +
     Leaf tuple fields: id, attnum, chunknum, data+
 
(1 row)

CREATE INDEX o_test_bridged_hash_btree_bitmap_scans_ix1
	ON o_test_bridged_hash_btree_bitmap_scans USING hash (t);
NOTICE:  index bridging is enabled for orioledb table 'o_test_bridged_hash_btree_bitmap_scans'
DETAIL:  index access method 'hash' is supported only via index bridging for OrioleDB table
CREATE INDEX o_test_bridged_hash_btree_bitmap_scans_ix2
	ON o_test_bridged_hash_btree_bitmap_scans USING hash (v);
CREATE INDEX o_test_bridged_hash_btree_bitmap_scans_ix3
	ON o_test_bridged_hash_btree_bitmap_scans USING btree (v) WITH (orioledb_index = off);
WARNING:  using bridged btree index for orioledb
DETAIL:  This feature is intended for testing purposes and is not recommended for normal usage.
SELECT orioledb_tbl_indices('o_test_bridged_hash_btree_bitmap_scans'::regclass, true);
                 orioledb_tbl_indices                 
------------------------------------------------------
 Index o_test_bridged_hash_btree_bitmap_scans_pkey   +
     Index type: primary, unique                     +
     Leaf tuple size: 4, non-leaf tuple size: 1      +
     Non-leaf tuple fields: id                       +
     Leaf tuple fields: index_bridging_ctid, id, t, v+
 Index index_bridge                                  +
     Index type: secondary                           +
     Leaf tuple size: 2, non-leaf tuple size: 1      +
     Non-leaf tuple fields: index_bridging_ctid      +
     Leaf tuple fields: index_bridging_ctid, id      +
 Index toast                                         +
     Index type: secondary                           +
     Leaf tuple size: 4, non-leaf tuple size: 3      +
     Non-leaf tuple fields: id, attnum, chunknum     +
     Leaf tuple fields: id, attnum, chunknum, data   +
 
(1 row)

INSERT INTO o_test_bridged_hash_btree_bitmap_scans VALUES (1, 'D', ARRAY[47,16]);
INSERT INTO o_test_bridged_hash_btree_bitmap_scans VALUES (2, 'A', ARRAY[48,17]);
INSERT INTO o_test_bridged_hash_btree_bitmap_scans VALUES (3, 'C', ARRAY[49,18]);
INSERT INTO o_test_bridged_hash_btree_bitmap_scans VALUES (4, 'F', ARRAY[50,19]);
INSERT INTO o_test_bridged_hash_btree_bitmap_scans VALUES (5, 'B', ARRAY[51,20]);
SELECT orioledb_tbl_structure('o_test_bridged_hash_btree_bitmap_scans'::regclass, 'nue');
                       orioledb_tbl_structure                        
---------------------------------------------------------------------
 Index o_test_bridged_hash_btree_bitmap_scans_pkey contents         +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty+
     Leftmost, Rightmost                                            +
   Chunk 0: offset = 0, location = 256, hikey location = 64         +
     Item 0: offset = 272, tuple = ('(0,1)', '1', 'D', '{47,16}')   +
     Item 1: offset = 344, tuple = ('(0,2)', '2', 'A', '{48,17}')   +
     Item 2: offset = 416, tuple = ('(0,3)', '3', 'C', '{49,18}')   +
     Item 3: offset = 488, tuple = ('(0,4)', '4', 'F', '{50,19}')   +
     Item 4: offset = 560, tuple = ('(0,5)', '5', 'B', '{51,20}')   +
                                                                    +
 Index index_bridge contents                                        +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty +
     Leftmost, Rightmost                                            +
   Chunk 0: offset = 0, location = 256, hikey location = 64         +
     Item 0: offset = 272, tuple = ('(0,1)', '1')                   +
     Item 1: offset = 304, tuple = ('(0,2)', '2')                   +
     Item 2: offset = 336, tuple = ('(0,3)', '3')                   +
     Item 3: offset = 368, tuple = ('(0,4)', '4')                   +
     Item 4: offset = 400, tuple = ('(0,5)', '5')                   +
                                                                    +
 Index toast: not loaded                                            +
 
(1 row)

SELECT * FROM hash_index_content('o_test_bridged_hash_btree_bitmap_scans_ix1');
ERROR:  function hash_index_content(unknown) does not exist
LINE 1: SELECT * FROM hash_index_content('o_test_bridged_hash_btree_...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
SELECT * FROM hash_index_content('o_test_bridged_hash_btree_bitmap_scans_ix2');
ERROR:  function hash_index_content(unknown) does not exist
LINE 1: SELECT * FROM hash_index_content('o_test_bridged_hash_btree_...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
SELECT * FROM btree_index_content('o_test_bridged_hash_btree_bitmap_scans_ix3');
ERROR:  function btree_index_content(unknown) does not exist
LINE 1: SELECT * FROM btree_index_content('o_test_bridged_hash_btree...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_bridged_hash_btree_bitmap_scans
		WHERE v = ARRAY[48, 17] OR v = ARRAY[49, 18];
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Custom Scan (o_scan) on o_test_bridged_hash_btree_bitmap_scans
   Bitmap heap scan
   Recheck Cond: ((v = '{48,17}'::integer[]) OR (v = '{49,18}'::integer[]))
   ->  BitmapOr
         ->  Bitmap Index Scan on o_test_bridged_hash_btree_bitmap_scans_ix2
               Index Cond: (v = '{48,17}'::integer[])
         ->  Bitmap Index Scan on o_test_bridged_hash_btree_bitmap_scans_ix2
               Index Cond: (v = '{49,18}'::integer[])
(8 rows)

SELECT * FROM o_test_bridged_hash_btree_bitmap_scans
	WHERE v = ARRAY[48, 17] OR v = ARRAY[49, 18];
 id | t |    v    
----+---+---------
  2 | A | {48,17}
  3 | C | {49,18}
(2 rows)

EXPLAIN (COSTS OFF)
	SELECT * FROM o_test_bridged_hash_btree_bitmap_scans WHERE t = 'C';
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Custom Scan (o_scan) on o_test_bridged_hash_btree_bitmap_scans
   Bitmap heap scan
   Recheck Cond: (t = 'C'::text)
   ->  Bitmap Index Scan on o_test_bridged_hash_btree_bitmap_scans_ix1
         Index Cond: (t = 'C'::text)
(5 rows)

SELECT * FROM o_test_bridged_hash_btree_bitmap_scans WHERE t = 'C';
 id | t |    v    
----+---+---------
  3 | C | {49,18}
(1 row)

COMMIT;
CREATE TABLE o_test_bridged_index_only_scan (
       id integer NOT NULL,
	   id2 integer,
       t text NOT NULL,
       PRIMARY KEY(id)
) USING orioledb;
SELECT orioledb_tbl_indices('o_test_bridged_index_only_scan'::regclass, true);
               orioledb_tbl_indices                
---------------------------------------------------
 Index o_test_bridged_index_only_scan_pkey        +
     Index type: primary, unique                  +
     Leaf tuple size: 3, non-leaf tuple size: 1   +
     Non-leaf tuple fields: id                    +
     Leaf tuple fields: id, id2, t                +
 Index toast                                      +
     Index type: secondary                        +
     Leaf tuple size: 4, non-leaf tuple size: 3   +
     Non-leaf tuple fields: id, attnum, chunknum  +
     Leaf tuple fields: id, attnum, chunknum, data+
 
(1 row)

CREATE INDEX o_test_bridged_index_only_scan_ix1 ON o_test_bridged_index_only_scan USING btree (t) WITH (orioledb_index = off);
WARNING:  using bridged btree index for orioledb
DETAIL:  This feature is intended for testing purposes and is not recommended for normal usage.
NOTICE:  index bridging is enabled for orioledb table 'o_test_bridged_index_only_scan'
DETAIL:  index access method 'btree' is requested with index bridging for OrioleDB table
CREATE INDEX o_test_bridged_index_only_scan_ix2 ON o_test_bridged_index_only_scan USING btree (id2) WITH (orioledb_index = off);
WARNING:  using bridged btree index for orioledb
DETAIL:  This feature is intended for testing purposes and is not recommended for normal usage.
SELECT orioledb_tbl_indices('o_test_bridged_index_only_scan'::regclass, true);
                  orioledb_tbl_indices                  
--------------------------------------------------------
 Index o_test_bridged_index_only_scan_pkey             +
     Index type: primary, unique                       +
     Leaf tuple size: 4, non-leaf tuple size: 1        +
     Non-leaf tuple fields: id                         +
     Leaf tuple fields: index_bridging_ctid, id, id2, t+
 Index index_bridge                                    +
     Index type: secondary                             +
     Leaf tuple size: 2, non-leaf tuple size: 1        +
     Non-leaf tuple fields: index_bridging_ctid        +
     Leaf tuple fields: index_bridging_ctid, id        +
 Index toast                                           +
     Index type: secondary                             +
     Leaf tuple size: 4, non-leaf tuple size: 3        +
     Non-leaf tuple fields: id, attnum, chunknum       +
     Leaf tuple fields: id, attnum, chunknum, data     +
 
(1 row)

INSERT INTO o_test_bridged_index_only_scan VALUES (1, 56, 'x');
INSERT INTO o_test_bridged_index_only_scan VALUES (2, 27, repeat('x', 2600));
CREATE INDEX o_test_bridged_index_only_scan_ix1 ON o_test_bridged_index_only_scan USING btree (t) WITH (orioledb_index = off);
ERROR:  relation "o_test_bridged_index_only_scan_ix1" already exists
SELECT orioledb_tbl_structure('o_test_bridged_index_only_scan'::regclass, 'nue');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       orioledb_tbl_structure                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Index o_test_bridged_index_only_scan_pkey contents                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +
     Leftmost, Rightmost                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
   Chunk 0: offset = 0, location = 256, hikey location = 64, hikey = ('2')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +
     Item 0: offset = 264, tuple = ('(0,1)', '1', '56', 'x')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
   Chunk 1: offset = 1, location = 312, hikey location = 72                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +
     Item 1: offset = 320, tuple = ('(0,2)', '2', '27', 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx')+
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +
 Index index_bridge contents                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
     Leftmost, Rightmost                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +
     Item 0: offset = 264, tuple = ('(0,1)', '1')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
     Item 1: offset = 296, tuple = ('(0,2)', '2')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +
 Index toast: not loaded                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
 
(1 row)

SELECT * FROM btree_index_content('o_test_bridged_index_only_scan_ix1');
ERROR:  function btree_index_content(unknown) does not exist
LINE 1: SELECT * FROM btree_index_content('o_test_bridged_index_only...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF) SELECT * FROM o_test_bridged_index_only_scan ORDER BY t;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Index Scan using o_test_bridged_index_only_scan_ix1 on o_test_bridged_index_only_scan
(1 row)

SELECT * FROM o_test_bridged_index_only_scan ORDER BY t;
 id | id2 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
----+-----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  56 | x
  2 |  27 | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
(2 rows)

SET LOCAL enable_bitmapscan = off;
EXPLAIN (COSTS OFF)
	SELECT t FROM o_test_bridged_index_only_scan WHERE t = 'x';
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Index Only Scan using o_test_bridged_index_only_scan_ix1 on o_test_bridged_index_only_scan
   Index Cond: (t = 'x'::text)
(2 rows)

SELECT t FROM o_test_bridged_index_only_scan WHERE t = 'x';
 t 
---
 x
(1 row)

COMMIT;
CREATE FUNCTION generate_string(seed integer, length integer) RETURNS text
	AS $$
		SELECT substr(string_agg(
						substr(encode(sha256(seed::text::bytea || '_' || i::text::bytea), 'hex'), 1, 21),
				''), 1, length)
		FROM generate_series(1, (length + 20) / 21) i; $$
LANGUAGE SQL;
CREATE TABLE o_test_toast_with_bridged (
	id integer NOT NULL,
	t text NOT NULL,
	id2 integer
) USING orioledb;
SELECT orioledb_tbl_indices('o_test_toast_with_bridged'::regclass, true);
                orioledb_tbl_indices                 
-----------------------------------------------------
 Index ctid_primary                                 +
     Index type: primary, unique, ctid              +
     Leaf tuple size: 4, non-leaf tuple size: 1     +
     Non-leaf tuple fields: ctid                    +
     Leaf tuple fields: ctid, id, t, id2            +
 Index toast                                        +
     Index type: secondary                          +
     Leaf tuple size: 4, non-leaf tuple size: 3     +
     Non-leaf tuple fields: ctid, attnum, chunknum  +
     Leaf tuple fields: ctid, attnum, chunknum, data+
 
(1 row)

CREATE INDEX o_test_toast_with_bridged_ix1 ON o_test_toast_with_bridged USING btree (id) WITH (orioledb_index = off);
WARNING:  using bridged btree index for orioledb
DETAIL:  This feature is intended for testing purposes and is not recommended for normal usage.
NOTICE:  index bridging is enabled for orioledb table 'o_test_toast_with_bridged'
DETAIL:  index access method 'btree' is requested with index bridging for OrioleDB table
SELECT orioledb_tbl_indices('o_test_toast_with_bridged'::regclass, true);
                     orioledb_tbl_indices                     
--------------------------------------------------------------
 Index ctid_primary                                          +
     Index type: primary, unique, ctid                       +
     Leaf tuple size: 5, non-leaf tuple size: 1              +
     Non-leaf tuple fields: ctid                             +
     Leaf tuple fields: ctid, index_bridging_ctid, id, t, id2+
 Index index_bridge                                          +
     Index type: secondary                                   +
     Leaf tuple size: 2, non-leaf tuple size: 1              +
     Non-leaf tuple fields: index_bridging_ctid              +
     Leaf tuple fields: index_bridging_ctid, ctid            +
 Index toast                                                 +
     Index type: secondary                                   +
     Leaf tuple size: 4, non-leaf tuple size: 3              +
     Non-leaf tuple fields: ctid, attnum, chunknum           +
     Leaf tuple fields: ctid, attnum, chunknum, data         +
 
(1 row)

INSERT INTO o_test_toast_with_bridged VALUES (1, 'x', 10);
INSERT INTO o_test_toast_with_bridged VALUES (2, repeat('x', 2600), 78);
INSERT INTO o_test_toast_with_bridged VALUES (3, generate_string(1, 2690), 66);
INSERT INTO o_test_toast_with_bridged VALUES (4, generate_string(2, 2690), 56);
INSERT INTO o_test_toast_with_bridged VALUES (5, generate_string(3, 2690), 12);
SELECT orioledb_tbl_structure('o_test_toast_with_bridged'::regclass, 'nue');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           orioledb_tbl_structure                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Index ctid_primary contents                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +
 state = free, datoid equal, relnode equal, ix_type = primary, dirty                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +
     Leftmost, Rightmost                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
   Chunk 0: offset = 0, location = 256, hikey location = 72, hikey = ('(0,2)')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +
     Item 0: offset = 264, tuple = ('(0,1)', '(0,1)', '1', 'x', '10')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
   Chunk 1: offset = 1, location = 312, hikey location = 80, hikey = ('(0,3)')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +
     Item 1: offset = 320, tuple = ('(0,2)', '(0,2)', '2', 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx', '78')+
   Chunk 2: offset = 2, location = 2968, hikey location = 88                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
     Item 2: offset = 2976, tuple = ('(0,3)', '(0,3)', '3', TOASTed, '66')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
     Item 3: offset = 3032, tuple = ('(0,4)', '(0,4)', '4', TOASTed, '56')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
     Item 4: offset = 3088, tuple = ('(0,5)', '(0,5)', '5', TOASTed, '12')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
 Index index_bridge contents                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
 Page 0: level = 0, maxKeyLen = 8, nVacatedBytes = 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +
 state = free, datoid equal, relnode equal, ix_type = bridge, dirty                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +
     Leftmost, Rightmost                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
   Chunk 0: offset = 0, location = 256, hikey location = 64                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
     Item 0: offset = 272, tuple = ('(0,1)', '(0,1)')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
     Item 1: offset = 304, tuple = ('(0,2)', '(0,2)')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
     Item 2: offset = 336, tuple = ('(0,3)', '(0,3)')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
     Item 3: offset = 368, tuple = ('(0,4)', '(0,4)')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
     Item 4: offset = 400, tuple = ('(0,5)', '(0,5)')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
 Index toast contents                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
 Page 0: level = 1, maxKeyLen = 16                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
 state = free, datoid equal, relnode equal, ix_type = toast, dirty                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
     Leftmost, Rightmost                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
   Chunk 0: offset = 0, location = 512, hikey location = 64                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
     Item 0: offset = 520, downlink = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
     Item 1: offset = 528, downlink = 2, key = (PK: ('(0,5)'), attnum 4, chunknum 0)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
 Page 1: level = 0, maxKeyLen = 16, nVacatedBytes = 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
 state = free, datoid equal, relnode equal, ix_type = toast, dirty                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
     Leftmost, Rightlink is invalid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +
     Hikey: offset = 104, key = (PK: ('(0,5)'), attnum 4, chunknum 0)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
   Chunk 0: offset = 0, location = 256, hikey location = 72, hikey = (PK: ('(0,3)'), attnum 4, chunknum 1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
     Item 0: offset = 264, tuple = (PK: ('(0,3)'), attnum 4, chunknum 0, data_length 2657)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
   Chunk 1: offset = 1, location = 2968, hikey location = 88, hikey = (PK: ('(0,4)'), attnum 4, chunknum 1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
     Item 1: offset = 2976, tuple = (PK: ('(0,3)'), attnum 4, chunknum 1, data_length 37)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +
     Item 2: offset = 3056, tuple = (PK: ('(0,4)'), attnum 4, chunknum 0, data_length 2657)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
   Chunk 2: offset = 3, location = 5760, hikey location = 104, hikey = (PK: ('(0,5)'), attnum 4, chunknum 0)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
     Item 3: offset = 5768, tuple = (PK: ('(0,4)'), attnum 4, chunknum 1, data_length 37)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
 Page 2: level = 0, maxKeyLen = 16, nVacatedBytes = 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
 state = free, datoid equal, relnode equal, ix_type = toast, dirty                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
     Rightmost                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +
   Chunk 0: offset = 0, location = 256, hikey location = 64, hikey = (PK: ('(0,5)'), attnum 4, chunknum 1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
     Item 0: offset = 264, tuple = (PK: ('(0,5)'), attnum 4, chunknum 0, data_length 2657)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
   Chunk 1: offset = 1, location = 2968, hikey location = 80                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
     Item 1: offset = 2976, tuple = (PK: ('(0,5)'), attnum 4, chunknum 1, data_length 37)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
 
(1 row)

SELECT * FROM btree_index_content('o_test_toast_with_bridged_ix1');
ERROR:  function btree_index_content(unknown) does not exist
LINE 1: SELECT * FROM btree_index_content('o_test_toast_with_bridged...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF) SELECT * FROM o_test_toast_with_bridged ORDER BY id;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Index Scan using o_test_toast_with_bridged_ix1 on o_test_toast_with_bridged
(1 row)

SELECT * FROM o_test_toast_with_bridged ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | id2 
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----
  1 | x                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  10
  2 | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx                                                                                           |  78
  3 | 551e8b15be547418fbf590c79023f435b2e9e6ceae7dd8da7c62f0a74071d4ea921eeedc8c29ecd667e57d288b89132c2623411305352849a23a56da226d4c9d21ef536a074f046f121cfc381d2397da977137de1e3462d86105158877c4975784175aeec4328db2ae8afb3f0f3bce90661377912e25ef84d0a444560eb25fb147bc381cef72def876c01d64ec146d17b87df386a61a2c9dbf0cb44dee81268195e54ae668b3b178ac059e71473c20cfe0b4c7b1023aea1573dbd6e7984399f1397f00f2715072061179fb3e62006b0dfd58814826761284aa062be32c3fd46c8100d4c9f64004d64beb67b6c6fb3692065f5aee0a956890cc7b1849c69d893b51f43151bdc541a12575c22c894133d5d47a5557de984ab04b0591d756b48403bf27fc48662612a8f22ca22a9861d4503b8b142c1ac496a6296549aa614019592af9620b3b66699af44b7b9deb7f11f96b0619e1568c15f12870cb3ade059e96ea4bb151e1766ebcda420ec04e064dbc48005dd1872b80dab6e7f68e235f190afbe9a47cac5263df029867f7208de89c61611be4c30be9f9d1aaa6ae473cfca9b6fcdf3f1fb7fced7ed0867e17af95cf1c8e047c33031cf492ea43ea4eea83793941dbf123dc937d7f812decd703033cd6ab43ee51dbcaf8ff51cd779ab4de09fd77037458a73b97a40c3eeafe200e0534e910f4b4b93064b566591b9ca9dc9763067bb5c0e35287d563388ebef687f6c34409b31e8161062fb8d14233ba7ba66e11faab72ef3953cc9ce60eaa92f7ba13f7ad64efd0634bf6eca83840b100749b4d9a57a5e475a97092864bc40da3dee9fca5bc1d6ef7c7ed95fe14edaac5203933a9862d0dd1889d01359e8980041d9f081f323e08808606de0d3e7158be1e69e3e638352fa8e796a5e625f30248d948117c6dcd75037475e23fb96dee84346752ea74dcb9de7e99244e2f710f111e2ea824327f4cfebc203a2c2b9355c01d5ec20a0a4c52f9d7de117ff94a1e49fc5216af072c09453ac394d4a8f47dd03906c91dc358bb3320566b242fbc02662d59b36408528033ed00afcb00894f8302d4dc0cb839f76ad1f9cb0d2ba2ed3c87c623839ceee2113c9861862a15c842d351d12be0a41ddcf0e68cd3dc10ccacf8b7dfa11a76fcca96bcc5226f10c96bdaf1cdb88c4ead866290ea2046de4e17ebe43f09a47aef6bf1d444c6f370a4acff9eedbd895a6990d9573c96d220dec156bfdf3da928305509de856d842bd0d3e966c27f87164a1872fa8fe299412ec3d8bc37a2eaaa63bd48d1d2db931140483a09291a98fa3c5ccf4ac2ad4984fb7468a686fa65d77dfb0280ab660fd38c8c734ec1fd475cddaac21d028cade401b7a53aa04ffe813c9f983810a3bf66c9e47981ee07694374f48f7adfe2edd665a1dc04c12cc4180c9fdf45240a4b5b1c28353d1dbae63434b7bf4e816e06473aa159da5ef179ea6f2c0b5ae4488d16e6423092e31b516bb2c042c1407c53da28f81884409c4d1880c2cd9d314232ba34a465934096a821f11e33ac1e692628b6e2ef0cceb8b6064a36ffcbc7d9ae1e18c423292db5066666f9b1fa03e6995d160fbee71584374770a017166a71582d9f372292b797c383cd99b5d336b75a1c5776fe27ec81926b4394214a1a0a529280625bf25c4c7b2e4fbe70dda95cfe9c176ff82a29369c977578f9c29735e64d7457371839171406b4f642066c7cbc9c45f9f8f7055e28d51ebfdfb5a71c689808a426d9f2361bb76b7b871dbce69e2a65b80b761c4e09f18ef82ec60efe1ac70f2f98f8fad8875d07e25f4060f564d17bfc437d405b766a888a05b4a7bf94c5679d76cb73fca979dfd05acc9aa8add0c573fefe39a550aab81d9af360323ee3bf101ce0 |  66
  4 | 420cf95170c6ba2f9564e48fccc7ee00b729591402c6e542833f2d3fb47e24327a0c5dc9f4e06caf214ccbe2701f7c7762728279bdb9fe95a939d34ec792105f46d0ae6fe0d74a3d5db450aef5c767817403a38e0c6a239925d383f68d5afd7b2caedc56690126055d0ae4ce45685c7fde2a2ea748398935b647e4b420a601e501791dabe8377fe5e573c1db3e4fa72b86c7f7c9dfd7e33e42cc40b5ccd4ef5d5fdcb9604af9b71eca08bce0955f4a91b12934d166df31860e6ef21babf8637938aa8cb657aa834dd606038da2c225eea2e29b02eaa3207598f05fbc36b27697b2bec56910c1241f706d3af9908d4559047fdf376d6ef865f28cf8c961b6553fdcca1f38234cc799e34c1ab769dde795875af989b159af0461c5821ea2ea6a26d658564ed5f8b2843a2c4d9ab2dada25bf5670a2c2ecd859492eec355ef08e38dd6964ef67cd4bfd95b18659f950602b7d73fcf72d303eeba5aa85c5a155f573fcfafaf80f086c82bbd216ee544c0524ba81e5ff2269e0e687533d6b5eaa084ed7bb24ed583fd0d2ab4ff50444bbae72e532f76da2cbf034873029035a1493794021c8c8d9266e05cf089f39fa6eacb418dee58ceac058dbebf9a9e5c994832d15d836123c1bf986a9bc68ee8dda32fc11fd9d5cbebd81e16f421bd902ff16da16a93d914da0f7f87add622b3162f06e1c46379abc1bebce05fadfa7904a8f94d25ce8500cdaa65e735928181f93bebab1b16ef56e7ae79591797e08a9a358a1ba61a3e7cd2319fbb3088e9e3ea77f905dfb2584a71c056db79a8b26efeaeca9d6828298c4f3d05cbf5707190734e7f747f3036ddc7daec389765dba95e5dfc268cf34f9da750485784d15a3182c0b2c44a5a2c0dc3f870cc01f4687c2b49227a6edcb37e993d0099131884190f5cbb7b86e4475a1c563a19bfaf289e14d5980b54dacfeaba514a8bf4e200a98ce851032c3b36bddb5259a1b0eedc45585be7cc6c59cba55ce84e9f257f132018ba1dda70ea5381abb8d16cbb8d8156565991d7c68992ec7cf40a368d16960b1741ae4cfee3235768d854e29a95c6fe580d533a77967431cd16ee879462f7ea8e4203b6f461c3947a4edf0c3bb2044a11ab772a4b199a33c364b95dbc2dd3e0e1eeadeea97b832ecfaa4bd9a7eded13a2acef1b4ee35dd99c9ba7602b4abb95d83f83357a18d98cde1a72836e9cd1ff3c5135e497ef9a7bc78a59ce75ea6208489f3a320b285ba03d938b1964f475fa417ceaf7ee92a58c63e2b545f4bc3366dc4ff8cd81189c86d05a3badaa648f5ca51b4b50589fdb69906da1421cc8af3b09364fb4de074e66cfb4f40122f32400fdb016313a1dc9e5663f20f12debb43091a15847a30815e082e75a9eb72d3c5f135a69e844dd02973eae8eddf66fc942dcb6bc9c953a31b5a0e32992a8b615e8934f47fdea6d4cca3f22c5c8ee5c3135bdefe8bc8df01cbf1fd41ab19ac9ed8d81623c7aa07276ac06d4a320a55cfb2826963d97e1b30063e91980d6c9709c1b3943073f10dc23d7f89d23d20f5a4eac4b76a3a4735e112bfbdee252e364e451395484905369660bc69bac1997b5f80e6e5f667a26d75b7fe5ff8307da45a04377fcda666c761a619ced3cdb3e86391b1e80fc40557894f817938ee4c8a91e5737d482b94720007b67a33a5382fc36d45f8020ab72675b685e723c82abdf3f27ea6a2ddcbca295729f45cef583f23b9cf516f8f8f75dae283070d6e87512ee29950480cd427426627135b4e9e20111ac1d720c17a267a36d97ca1d20276f3343c9f881aab83fd6200fb2b0897e7b374fd308687e5304bbf0bdb87d5de1c2bb0e0586ffce78a568462e7e519a5129de95cd6a2966a259d78bb9d181d1ae34241cd271b2d74 |  56
  5 | a9a8d7170b9ee2c655e43ad9a5c5fb1bc135d8cb879d41a1d48dbe9766befe3015ad051bab9daab2d0b92eddabf93b63764cd5899f9f5e9eef1389d27209dd66a207f819b23ff90dc3d15cbad3a3e8994e01761c26ec8abdd1d8449d2c90685ddd434ab20cded902a94dc877db0c695492c97571e19ffd7041c364304ee9c87032564c0aed3bee4d253460c6253e1203ca5107aa4ddd98502fc311688150ca084820e879772fc8a3b32e6e521b3b3d0878f9a2ed2d3f459c37638ff72b4b46196e4cc7be2a7eb9eff8f0d1ac8d3f452e34497bdb2cff4cb1f42efed87c2e1aa1fdf8e61ac10b407103bf4ab1c58a9e15f2445759ef4b0af89796643837e8e9f48205cfc1aec8529ace6d7f1ccefd8802dd24139704e6fe6784c37682817f86d4a2c187abf0c70afd57dcc6813456c9fd8edb177a36e36b83b2852334ce5c04a55da155c6481d454da732f99a6692a78110825fdda799a10e2560bc3fa7e4be22767bbf936999afa8395e10e118b32cb66d045e12944045ad394c45268e16ec39b80a21b7db0c66c8ae78786eaeedc09bd77053d9d94e914f146862e61d9f3f45b5804ec5c94b1728ff80152601c82070c9e8edb48be65e47ca8af63cfb68a687dba57dbdcc7421329c5e7700e6d36f6ebe1a6f076e3189d3bc7198e96714938904e19f44fb0622f9b7b5a98d264166aa06b1b45422893d84a1b49c2c12133634ba302b03dc0665bd326639c7f7d835e2c2917fbf9353e868d6e3a1cf3edb9b9908b52d1d506b5259cfa44baf338a7a8882fc05d67c370fbf3ed55b8d574c0978dbc31bb940f0480c1d1de7efef9dd092a4c73686bb4d2c5840c85aa43daa4121c67b18959d0a2d6a382ffc43582730f1db59e42a07aeac7ba801ef26d4e46f4412045ba724c1b008963db6423e1687ab092312bc116d7d6c872a0ac8f9fd0ee8d9152d50af0f890c74e56d45e4f6360e54feed900b76252bdd43e8e139f954109f1f952333d9627e26adbe5aa7a92f0acf687490d042c0c25b59896fdd728de7cdcf679857bf934ccde276f9a8deec755aba153c3573c6dcfdd6feecfc825791459c5bb65a204504930cd2409e6d66037fad6269d7384ed4db305b0a6241664203ddecdcb09e13e1564de9e41f60723f249bbbe1f24d213cb69a7ab4ea677bdd14693db986d43b82a78c1edf2a09f224c74c4e874125ab0999a109565da6716f9622750a13bc5685db4dcd4a902c351491c279b3af0e538714e3cc373dac7632880eaa7f7b97a7622f991469839bffe7047f98b0db5f5de336d3dfedfcfbcb3a804eb8df0e5d8bee2c14d409ba3d0dfea221006590d0b494e204393e44cb650c2aee1aed0edeafdb2a4a16f136e1ee239891d962296a2c1049ffc64ff5fd3fddfcf04c9b346563b4c1dd2c2594cedff54ba2173e9a500c4e8c5830b8d1aa56bc0cb6b264a5889150bd7d8dcad23f8f66401019440236e812c68c0adc2b9347e4df717bbc7bd3a39ec5e53cef4ccfae1b4d8034a6d48d823a9d8c6ea4e5126e10d3f9909a0301ddf4905d3f8f65bccca810dcf2452cf63b80fbe6878ba2978bcadf5f6ce1223c177bd9df584f2115a933fae6d345d7e550477daeb318845c2cd80d671c117b4cc87e29ebaf918ef875243587c98605620575845cfc0bdc9334ed930ab1e3879771bfdb81f1d9232ddaa78216175296e4a5af4fd67093d5e25aaf42a210c69d34716d5ebe6de1ff6bdcbd6248913b095d862a960c82d34153dd9a885f975291c3336069a1da64ba8e7fe4d3c4fa8f402ad52c0cc4897056023107f0e02c8935d00adebee183b9b6482a2c0ab9651b3ef83754ff166fe89d358c4a10693ba3fe8009117b31d94c8c113fcc34a5a57252120708a1ff364572f6a8ff08 |  12
(5 rows)

COMMIT;
UPDATE o_test_toast_with_bridged SET t = generate_string(5, 2690) WHERE id = 4;
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF) SELECT * FROM o_test_toast_with_bridged ORDER BY id;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Index Scan using o_test_toast_with_bridged_ix1 on o_test_toast_with_bridged
(1 row)

SELECT * FROM o_test_toast_with_bridged ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | id2 
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----
  1 | x                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  10
  2 | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx                                                                                           |  78
  3 | 551e8b15be547418fbf590c79023f435b2e9e6ceae7dd8da7c62f0a74071d4ea921eeedc8c29ecd667e57d288b89132c2623411305352849a23a56da226d4c9d21ef536a074f046f121cfc381d2397da977137de1e3462d86105158877c4975784175aeec4328db2ae8afb3f0f3bce90661377912e25ef84d0a444560eb25fb147bc381cef72def876c01d64ec146d17b87df386a61a2c9dbf0cb44dee81268195e54ae668b3b178ac059e71473c20cfe0b4c7b1023aea1573dbd6e7984399f1397f00f2715072061179fb3e62006b0dfd58814826761284aa062be32c3fd46c8100d4c9f64004d64beb67b6c6fb3692065f5aee0a956890cc7b1849c69d893b51f43151bdc541a12575c22c894133d5d47a5557de984ab04b0591d756b48403bf27fc48662612a8f22ca22a9861d4503b8b142c1ac496a6296549aa614019592af9620b3b66699af44b7b9deb7f11f96b0619e1568c15f12870cb3ade059e96ea4bb151e1766ebcda420ec04e064dbc48005dd1872b80dab6e7f68e235f190afbe9a47cac5263df029867f7208de89c61611be4c30be9f9d1aaa6ae473cfca9b6fcdf3f1fb7fced7ed0867e17af95cf1c8e047c33031cf492ea43ea4eea83793941dbf123dc937d7f812decd703033cd6ab43ee51dbcaf8ff51cd779ab4de09fd77037458a73b97a40c3eeafe200e0534e910f4b4b93064b566591b9ca9dc9763067bb5c0e35287d563388ebef687f6c34409b31e8161062fb8d14233ba7ba66e11faab72ef3953cc9ce60eaa92f7ba13f7ad64efd0634bf6eca83840b100749b4d9a57a5e475a97092864bc40da3dee9fca5bc1d6ef7c7ed95fe14edaac5203933a9862d0dd1889d01359e8980041d9f081f323e08808606de0d3e7158be1e69e3e638352fa8e796a5e625f30248d948117c6dcd75037475e23fb96dee84346752ea74dcb9de7e99244e2f710f111e2ea824327f4cfebc203a2c2b9355c01d5ec20a0a4c52f9d7de117ff94a1e49fc5216af072c09453ac394d4a8f47dd03906c91dc358bb3320566b242fbc02662d59b36408528033ed00afcb00894f8302d4dc0cb839f76ad1f9cb0d2ba2ed3c87c623839ceee2113c9861862a15c842d351d12be0a41ddcf0e68cd3dc10ccacf8b7dfa11a76fcca96bcc5226f10c96bdaf1cdb88c4ead866290ea2046de4e17ebe43f09a47aef6bf1d444c6f370a4acff9eedbd895a6990d9573c96d220dec156bfdf3da928305509de856d842bd0d3e966c27f87164a1872fa8fe299412ec3d8bc37a2eaaa63bd48d1d2db931140483a09291a98fa3c5ccf4ac2ad4984fb7468a686fa65d77dfb0280ab660fd38c8c734ec1fd475cddaac21d028cade401b7a53aa04ffe813c9f983810a3bf66c9e47981ee07694374f48f7adfe2edd665a1dc04c12cc4180c9fdf45240a4b5b1c28353d1dbae63434b7bf4e816e06473aa159da5ef179ea6f2c0b5ae4488d16e6423092e31b516bb2c042c1407c53da28f81884409c4d1880c2cd9d314232ba34a465934096a821f11e33ac1e692628b6e2ef0cceb8b6064a36ffcbc7d9ae1e18c423292db5066666f9b1fa03e6995d160fbee71584374770a017166a71582d9f372292b797c383cd99b5d336b75a1c5776fe27ec81926b4394214a1a0a529280625bf25c4c7b2e4fbe70dda95cfe9c176ff82a29369c977578f9c29735e64d7457371839171406b4f642066c7cbc9c45f9f8f7055e28d51ebfdfb5a71c689808a426d9f2361bb76b7b871dbce69e2a65b80b761c4e09f18ef82ec60efe1ac70f2f98f8fad8875d07e25f4060f564d17bfc437d405b766a888a05b4a7bf94c5679d76cb73fca979dfd05acc9aa8add0c573fefe39a550aab81d9af360323ee3bf101ce0 |  66
  4 | e2af2ac479786b8ca94a7185f2a92edbb31672ea96b21c03eeb4a4fb569c90f279a77410296881ddd54da7bf5ef6960d00c76ccaa803d01846d73bb7d889187a07ce24690400c26de1a5dd16cf491b05e0bce7b5cfbea359d0d79fb8d4c8dce0ec8fdb80448974cbf3a1756c3944d0479c3358e15971561ff0f548b5a45e109bb59f0927e2b3c59b18515fc95e713ad60b677ef9c8e698b458df3764f91f946cab980b40d0de84c93f9436046a336525a76d8ed656277d0355d9891438a4d316bceefa8bb09baadc5becacf1a1703eab465a0dbfc3c2516c5e91faf904a6a228f6e6a2424c357d235a3964318f17ae94981cf9c2d35ed957190305d76d242bf34bb0d256be98a3f3d770594dcb1e8f003b08ddef685ca3958b7865cfdb33d3a09a8dac5ad603ae15925049f21236f9a223cd9ad67b9cbcaa7eee47fe09011dc30d7d312ea4967ad76d5d0e8513a3751e1652d0949fa852c0ef62bcfeadcd9d8dfac4c9f26740177b77f17b02a2dbd42f139b7922e32c019c4a0f0cff9c6a54c24c57cfebc5231433c31828bff5cd6b1f55ffca7de7a212fb701cff40f46dc5f82a67d579d6ee74ccbaf9038b1d8301b79770f37b0897b8747d82e80438b888eea4ff7081731b943a5f6d89c62b5d74d89c54c9070e021d582ee1a73cbd2c1d06acfee51d21f508978e0908fe43a590ed48dfc0bcf15b56c4f6310d6926f84121328c99e26f62e9dbadcb25f3b98a71b4cb73c569b68f1f2e6d5ba0522dde05d2a7e879a1ea5164222b05654be981633fb4ba67dce7975f20c0b5ee06fec6e503c12361c1a6eadb5a55520c4ddb61580e70369654ac78a0cc5c1d7d18212d3383e92041217424be9bfd240f09b9e39d91a26af74f441c5cc7242c6ca80f79099b40e594343297c27d3258ad93c88d680e407db9df682b64efc4ef11ad75f45509752a69a1388759e317a651be0fc4ca39ecad8d3060e3d11246beb942586a51befce58ad3cb161d5ee7b555ed57fd9ea8b289eff11bccb2a8fd0639944cd762ffa1cc5fb6e394f3b7f5b6ec8bc28a02f11c79dce2b5a0fe651df8594219f2b8352118a9492e4374c04c836981b39c3f457b9242f2d5d3802e8e9f9ac5921ffe8af8072385133014af34ffd10ee623cdd0f9ebf895bdba3cfb90931cc5e0c870fe65efeea6f2bcf77f9be5da02097696e840a4833e0b94c7a3fc6572f03c24c6d603f071e7f31cdb6c72d9c722d05998f1947ad1d0ce970d89dd8955de97def5b36b86b0f1f8380ae998a6051549d3ce46687b943ac1f248521d701af26895ae681e7db37cf32385c109d7804b2d7d7f1b07151d8954780af6cb7114c73fd7025d3563a3e43267b79a62a0291d567c92508afc748d586e2d5e170cca557ebad337cd06fb783895f24182b9b4c76389a4cd0143b2118be0212aa607d3330539078d1affbecce62d7a813b70cf18cddf256d6221565a6c885ac6d8d02aabeb853708118d0ab55a74908e10f732b53b98410a096acfee7c5a7d751e9efe561418bc5c0e362333b1de34f032a524aaaf696abdb4c28220414e7c7fbc8fa44a2c62d2f8e78faee4061466847fa348cbb414e734e812ee487f0ab4e9a734999cf2006bb8b4f240067d11093b1c9f9898c3a8501b8ef432a655e9a44848ee4a647d8f6b97f8d7e6b787bd645b65b8385715a9d723d2da33d4ee6c77c25f4fecdd72f6e376add1dc0d531c010915aef51ac842a1616bacfe9fd6c9c401a55d71f85a685f5a52dc86055e8b16b674e96c1576019c3a8c1bd71d3a1e1c70dab612b14d5fd5b1277cc4e4f7ec7eb1fafa1a0b28d1a6c9727886503047f7301c87946fe13a0392e6112f0d2b448f2e15568dfcffc544bd33abd997789164d363f64ba2b0eadb8496 |  56
  5 | a9a8d7170b9ee2c655e43ad9a5c5fb1bc135d8cb879d41a1d48dbe9766befe3015ad051bab9daab2d0b92eddabf93b63764cd5899f9f5e9eef1389d27209dd66a207f819b23ff90dc3d15cbad3a3e8994e01761c26ec8abdd1d8449d2c90685ddd434ab20cded902a94dc877db0c695492c97571e19ffd7041c364304ee9c87032564c0aed3bee4d253460c6253e1203ca5107aa4ddd98502fc311688150ca084820e879772fc8a3b32e6e521b3b3d0878f9a2ed2d3f459c37638ff72b4b46196e4cc7be2a7eb9eff8f0d1ac8d3f452e34497bdb2cff4cb1f42efed87c2e1aa1fdf8e61ac10b407103bf4ab1c58a9e15f2445759ef4b0af89796643837e8e9f48205cfc1aec8529ace6d7f1ccefd8802dd24139704e6fe6784c37682817f86d4a2c187abf0c70afd57dcc6813456c9fd8edb177a36e36b83b2852334ce5c04a55da155c6481d454da732f99a6692a78110825fdda799a10e2560bc3fa7e4be22767bbf936999afa8395e10e118b32cb66d045e12944045ad394c45268e16ec39b80a21b7db0c66c8ae78786eaeedc09bd77053d9d94e914f146862e61d9f3f45b5804ec5c94b1728ff80152601c82070c9e8edb48be65e47ca8af63cfb68a687dba57dbdcc7421329c5e7700e6d36f6ebe1a6f076e3189d3bc7198e96714938904e19f44fb0622f9b7b5a98d264166aa06b1b45422893d84a1b49c2c12133634ba302b03dc0665bd326639c7f7d835e2c2917fbf9353e868d6e3a1cf3edb9b9908b52d1d506b5259cfa44baf338a7a8882fc05d67c370fbf3ed55b8d574c0978dbc31bb940f0480c1d1de7efef9dd092a4c73686bb4d2c5840c85aa43daa4121c67b18959d0a2d6a382ffc43582730f1db59e42a07aeac7ba801ef26d4e46f4412045ba724c1b008963db6423e1687ab092312bc116d7d6c872a0ac8f9fd0ee8d9152d50af0f890c74e56d45e4f6360e54feed900b76252bdd43e8e139f954109f1f952333d9627e26adbe5aa7a92f0acf687490d042c0c25b59896fdd728de7cdcf679857bf934ccde276f9a8deec755aba153c3573c6dcfdd6feecfc825791459c5bb65a204504930cd2409e6d66037fad6269d7384ed4db305b0a6241664203ddecdcb09e13e1564de9e41f60723f249bbbe1f24d213cb69a7ab4ea677bdd14693db986d43b82a78c1edf2a09f224c74c4e874125ab0999a109565da6716f9622750a13bc5685db4dcd4a902c351491c279b3af0e538714e3cc373dac7632880eaa7f7b97a7622f991469839bffe7047f98b0db5f5de336d3dfedfcfbcb3a804eb8df0e5d8bee2c14d409ba3d0dfea221006590d0b494e204393e44cb650c2aee1aed0edeafdb2a4a16f136e1ee239891d962296a2c1049ffc64ff5fd3fddfcf04c9b346563b4c1dd2c2594cedff54ba2173e9a500c4e8c5830b8d1aa56bc0cb6b264a5889150bd7d8dcad23f8f66401019440236e812c68c0adc2b9347e4df717bbc7bd3a39ec5e53cef4ccfae1b4d8034a6d48d823a9d8c6ea4e5126e10d3f9909a0301ddf4905d3f8f65bccca810dcf2452cf63b80fbe6878ba2978bcadf5f6ce1223c177bd9df584f2115a933fae6d345d7e550477daeb318845c2cd80d671c117b4cc87e29ebaf918ef875243587c98605620575845cfc0bdc9334ed930ab1e3879771bfdb81f1d9232ddaa78216175296e4a5af4fd67093d5e25aaf42a210c69d34716d5ebe6de1ff6bdcbd6248913b095d862a960c82d34153dd9a885f975291c3336069a1da64ba8e7fe4d3c4fa8f402ad52c0cc4897056023107f0e02c8935d00adebee183b9b6482a2c0ab9651b3ef83754ff166fe89d358c4a10693ba3fe8009117b31d94c8c113fcc34a5a57252120708a1ff364572f6a8ff08 |  12
(5 rows)

COMMIT;
DELETE FROM o_test_toast_with_bridged WHERE id BETWEEN 2 AND 4;
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF) SELECT * FROM o_test_toast_with_bridged ORDER BY id;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Index Scan using o_test_toast_with_bridged_ix1 on o_test_toast_with_bridged
(1 row)

SELECT * FROM o_test_toast_with_bridged ORDER BY id;
 id |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | id2 
----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----
  1 | x                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  10
  5 | a9a8d7170b9ee2c655e43ad9a5c5fb1bc135d8cb879d41a1d48dbe9766befe3015ad051bab9daab2d0b92eddabf93b63764cd5899f9f5e9eef1389d27209dd66a207f819b23ff90dc3d15cbad3a3e8994e01761c26ec8abdd1d8449d2c90685ddd434ab20cded902a94dc877db0c695492c97571e19ffd7041c364304ee9c87032564c0aed3bee4d253460c6253e1203ca5107aa4ddd98502fc311688150ca084820e879772fc8a3b32e6e521b3b3d0878f9a2ed2d3f459c37638ff72b4b46196e4cc7be2a7eb9eff8f0d1ac8d3f452e34497bdb2cff4cb1f42efed87c2e1aa1fdf8e61ac10b407103bf4ab1c58a9e15f2445759ef4b0af89796643837e8e9f48205cfc1aec8529ace6d7f1ccefd8802dd24139704e6fe6784c37682817f86d4a2c187abf0c70afd57dcc6813456c9fd8edb177a36e36b83b2852334ce5c04a55da155c6481d454da732f99a6692a78110825fdda799a10e2560bc3fa7e4be22767bbf936999afa8395e10e118b32cb66d045e12944045ad394c45268e16ec39b80a21b7db0c66c8ae78786eaeedc09bd77053d9d94e914f146862e61d9f3f45b5804ec5c94b1728ff80152601c82070c9e8edb48be65e47ca8af63cfb68a687dba57dbdcc7421329c5e7700e6d36f6ebe1a6f076e3189d3bc7198e96714938904e19f44fb0622f9b7b5a98d264166aa06b1b45422893d84a1b49c2c12133634ba302b03dc0665bd326639c7f7d835e2c2917fbf9353e868d6e3a1cf3edb9b9908b52d1d506b5259cfa44baf338a7a8882fc05d67c370fbf3ed55b8d574c0978dbc31bb940f0480c1d1de7efef9dd092a4c73686bb4d2c5840c85aa43daa4121c67b18959d0a2d6a382ffc43582730f1db59e42a07aeac7ba801ef26d4e46f4412045ba724c1b008963db6423e1687ab092312bc116d7d6c872a0ac8f9fd0ee8d9152d50af0f890c74e56d45e4f6360e54feed900b76252bdd43e8e139f954109f1f952333d9627e26adbe5aa7a92f0acf687490d042c0c25b59896fdd728de7cdcf679857bf934ccde276f9a8deec755aba153c3573c6dcfdd6feecfc825791459c5bb65a204504930cd2409e6d66037fad6269d7384ed4db305b0a6241664203ddecdcb09e13e1564de9e41f60723f249bbbe1f24d213cb69a7ab4ea677bdd14693db986d43b82a78c1edf2a09f224c74c4e874125ab0999a109565da6716f9622750a13bc5685db4dcd4a902c351491c279b3af0e538714e3cc373dac7632880eaa7f7b97a7622f991469839bffe7047f98b0db5f5de336d3dfedfcfbcb3a804eb8df0e5d8bee2c14d409ba3d0dfea221006590d0b494e204393e44cb650c2aee1aed0edeafdb2a4a16f136e1ee239891d962296a2c1049ffc64ff5fd3fddfcf04c9b346563b4c1dd2c2594cedff54ba2173e9a500c4e8c5830b8d1aa56bc0cb6b264a5889150bd7d8dcad23f8f66401019440236e812c68c0adc2b9347e4df717bbc7bd3a39ec5e53cef4ccfae1b4d8034a6d48d823a9d8c6ea4e5126e10d3f9909a0301ddf4905d3f8f65bccca810dcf2452cf63b80fbe6878ba2978bcadf5f6ce1223c177bd9df584f2115a933fae6d345d7e550477daeb318845c2cd80d671c117b4cc87e29ebaf918ef875243587c98605620575845cfc0bdc9334ed930ab1e3879771bfdb81f1d9232ddaa78216175296e4a5af4fd67093d5e25aaf42a210c69d34716d5ebe6de1ff6bdcbd6248913b095d862a960c82d34153dd9a885f975291c3336069a1da64ba8e7fe4d3c4fa8f402ad52c0cc4897056023107f0e02c8935d00adebee183b9b6482a2c0ab9651b3ef83754ff166fe89d358c4a10693ba3fe8009117b31d94c8c113fcc34a5a57252120708a1ff364572f6a8ff08 |  12
(2 rows)

COMMIT;
-- Test bug https://github.com/orioledb/orioledb/issues/524
-- add a column to existing table
CREATE TABLE IF NOT EXISTS refresh_tokens();
ALTER TABLE refresh_tokens ADD COLUMN IF NOT EXISTS parent text;
-- create a separate table with default value
CREATE TABLE IF NOT EXISTS one_time_tokens (
  token_hash text,
  created_at timestamp without time zone NOT NULL DEFAULT now()
);
-- now create a hash index with bridge index
CREATE INDEX IF NOT EXISTS one_time_tokens_token_hash_hash_idx
	ON one_time_tokens USING hash (token_hash);
create table size_test(i1 int, i2 int, t text) using orioledb;
INSERT INTO size_test (SELECT id, id, generate_string(id, 3000) FROM generate_series(1, 1000) id);
create index size_test_i2_brin_idx on size_test using brin (i2);
NOTICE:  index bridging is enabled for orioledb table 'size_test'
DETAIL:  index access method 'brin' is supported only via index bridging for OrioleDB table
select pg_size_pretty(pg_relation_size('size_test'::regclass));
 pg_size_pretty 
----------------
 72 kB
(1 row)

select pg_size_pretty(pg_table_size('size_test'::regclass));
 pg_size_pretty 
----------------
 4072 kB
(1 row)

select pg_size_pretty(pg_indexes_size('size_test'::regclass));
 pg_size_pretty 
----------------
 0 bytes
(1 row)

select pg_size_pretty(pg_total_relation_size('size_test'::regclass));
 pg_size_pretty 
----------------
 4072 kB
(1 row)

select pg_size_pretty(pg_table_size('size_test_i2_brin_idx'::regclass));
 pg_size_pretty 
----------------
 48 kB
(1 row)

CREATE TABLE tbl_with_pkey_bridged_toast (
	i1 int,
	i2 int,
	i3 int,
	i4 int,
	t text,
	PRIMARY KEY(i1)
) USING orioledb;
INSERT INTO tbl_with_pkey_bridged_toast
	(SELECT id, id, id * 12, id * 17 % 31 + id*2, generate_string(id, 3000) FROM generate_series(11, 650) id);
INSERT INTO tbl_with_pkey_bridged_toast
	(SELECT id, id, id * 12, id * 17 % 20, generate_string(id, 3000) FROM generate_series(1, 10) id);
CREATE INDEX tbl_with_pkey_bridged_toast_idx1 ON tbl_with_pkey_bridged_toast USING brin (i2) WITH (pages_per_range=1);
NOTICE:  index bridging is enabled for orioledb table 'tbl_with_pkey_bridged_toast'
DETAIL:  index access method 'brin' is supported only via index bridging for OrioleDB table
CREATE INDEX tbl_with_pkey_bridged_toast_idx2 ON tbl_with_pkey_bridged_toast USING hash (i3);
CREATE INDEX tbl_with_pkey_bridged_toast_idx3 ON tbl_with_pkey_bridged_toast USING btree (i4) WITH (orioledb_index=true);
BEGIN;
SET LOCAL enable_seqscan = off;
EXPLAIN (COSTS OFF) SELECT * FROM tbl_with_pkey_bridged_toast
	WHERE
		i4 BETWEEN 8 AND 13
		-- ;
		OR
		i2 BETWEEN 299 AND 305
		-- ;
		OR
		i3 IN (7356, 6996, 7692)
		-- ;
		OR
		i4 BETWEEN 13 AND 17
		;
                                                                         QUERY PLAN                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (o_scan) on tbl_with_pkey_bridged_toast
   Bitmap heap scan
   Recheck Cond: (((i4 >= 8) AND (i4 <= 13)) OR ((i2 >= 299) AND (i2 <= 305)) OR (i3 = ANY ('{7356,6996,7692}'::integer[])) OR ((i4 >= 13) AND (i4 <= 17)))
   ->  BitmapOr
         ->  Bitmap Index Scan on tbl_with_pkey_bridged_toast_idx3
               Index Cond: ((i4 >= 8) AND (i4 <= 13))
         ->  Bitmap Index Scan on tbl_with_pkey_bridged_toast_idx1
               Index Cond: ((i2 >= 299) AND (i2 <= 305))
         ->  Bitmap Index Scan on tbl_with_pkey_bridged_toast_idx2
               Index Cond: (i3 = ANY ('{7356,6996,7692}'::integer[]))
         ->  Bitmap Index Scan on tbl_with_pkey_bridged_toast_idx3
               Index Cond: ((i4 >= 13) AND (i4 <= 17))
(12 rows)

	ORDER BY i2;
ERROR:  syntax error at or near "ORDER"
LINE 1: ORDER BY i2;
        ^
SELECT * FROM tbl_with_pkey_bridged_toast
	WHERE
		i4 BETWEEN 8 AND 13
		-- ;
		OR
		i2 BETWEEN 299 AND 305
		-- ;
		OR
		i3 IN (7356, 6996, 7692)
		-- ;
		OR
		i4 BETWEEN 13 AND 17
		;
ERROR:  current transaction is aborted, commands ignored until end of transaction block
	ORDER BY i2;
ERROR:  syntax error at or near "ORDER"
LINE 1: ORDER BY i2;
        ^
COMMIT;
CREATE TABLE bitmap_test
(
	id serial primary key,
	i int4,
	j int4,
	k int4,
	h int4
) USING orioledb;
INSERT INTO bitmap_test (i, j, k, h)
	SELECT
		(v * 1032 + 1854) % 2000,
		(v * 5011 + 2159) % 2000,
		(v * 5011 + 2102) % 2000,
		(v * 4102 + 5857) % 2000
		FROM generate_series(1,5000) v;
CREATE INDEX bitmap_test_ix1 ON bitmap_test (i);
CREATE INDEX bitmap_test_ix2 ON bitmap_test (j);
CREATE INDEX bitmap_test_ix3 ON bitmap_test (k) WITH (orioledb_index=false);
WARNING:  using bridged btree index for orioledb
DETAIL:  This feature is intended for testing purposes and is not recommended for normal usage.
NOTICE:  index bridging is enabled for orioledb table 'bitmap_test'
DETAIL:  index access method 'btree' is requested with index bridging for OrioleDB table
CREATE INDEX bitmap_test_ix4 ON bitmap_test (h);
ANALYZE bitmap_test;
SET enable_seqscan = off;
CREATE VIEW bitmap_test_mv AS (SELECT * FROM bitmap_test WHERE i < 100 AND h < 100 OR j < 100 LIMIT 20);
EXPLAIN (COSTS OFF) SELECT count(*) FROM bitmap_test_mv;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Aggregate
   ->  Limit
         ->  Result
               ->  Custom Scan (o_scan) on bitmap_test
                     Bitmap heap scan
                     Recheck Cond: (((i < 100) AND (h < 100)) OR (j < 100))
                     ->  BitmapOr
                           ->  BitmapAnd
                                 ->  Bitmap Index Scan on bitmap_test_ix1
                                       Index Cond: (i < 100)
                                 ->  Bitmap Index Scan on bitmap_test_ix4
                                       Index Cond: (h < 100)
                           ->  Bitmap Index Scan on bitmap_test_ix2
                                 Index Cond: (j < 100)
(14 rows)

SELECT count(*) FROM bitmap_test_mv;
 count 
-------
    20
(1 row)

SELECT * FROM bitmap_test_mv;
 id  |  i   | j  |  k   |  h   
-----+------+----+------+------
  77 | 1318 |  6 | 1949 | 1711
  79 | 1382 | 28 | 1971 | 1915
  81 | 1446 | 50 | 1993 |  119
  83 | 1510 | 72 |   15 |  323
  85 | 1574 | 94 |   37 |  527
 168 | 1230 |  7 | 1950 |  993
 170 | 1294 | 29 | 1972 | 1197
 172 | 1358 | 51 | 1994 | 1401
 174 | 1422 | 73 |   16 | 1605
 176 | 1486 | 95 |   38 | 1809
 259 | 1142 |  8 | 1951 |  275
 261 | 1206 | 30 | 1973 |  479
 263 | 1270 | 52 | 1995 |  683
 265 | 1334 | 74 |   17 |  887
 267 | 1398 | 96 |   39 | 1091
 350 | 1054 |  9 | 1952 | 1557
 352 | 1118 | 31 | 1974 | 1761
 354 | 1182 | 53 | 1996 | 1965
 356 | 1246 | 75 |   18 |  169
 358 | 1310 | 97 |   40 |  373
(20 rows)

DROP VIEW bitmap_test_mv;
CREATE VIEW bitmap_test_mv AS (SELECT * FROM bitmap_test WHERE i < 100 AND j < 100 OR h < 100 LIMIT 20);
EXPLAIN (COSTS OFF) SELECT count(*) FROM bitmap_test_mv;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Aggregate
   ->  Limit
         ->  Result
               ->  Custom Scan (o_scan) on bitmap_test
                     Bitmap heap scan
                     Recheck Cond: (((i < 100) AND (j < 100)) OR (h < 100))
                     ->  BitmapOr
                           ->  BitmapAnd
                                 ->  Bitmap Index Scan on bitmap_test_ix1
                                       Index Cond: (i < 100)
                                 ->  Bitmap Index Scan on bitmap_test_ix2
                                       Index Cond: (j < 100)
                           ->  Bitmap Index Scan on bitmap_test_ix4
                                 Index Cond: (h < 100)
(14 rows)

SELECT count(*) FROM bitmap_test_mv;
 count 
-------
    20
(1 row)

SELECT * FROM bitmap_test_mv;
 id  |  i   |  j   |  k   | h  
-----+------+------+------+----
   2 | 1918 |  181 |  124 | 61
  41 |  166 | 1610 | 1553 | 39
  61 |  806 | 1830 | 1773 | 79
  80 |  414 | 1039 |  982 | 17
 100 | 1054 | 1259 | 1202 | 57
 120 | 1694 | 1479 | 1422 | 97
 139 | 1302 |  688 |  631 | 35
 159 | 1942 |  908 |  851 | 75
 178 | 1550 |  117 |   60 | 13
 198 |  190 |  337 |  280 | 53
 218 |  830 |  557 |  500 | 93
 237 |  438 | 1766 | 1709 | 31
 257 | 1078 | 1986 | 1929 | 71
 276 |  686 | 1195 | 1138 |  9
 296 | 1326 | 1415 | 1358 | 49
 316 | 1966 | 1635 | 1578 | 89
 335 | 1574 |  844 |  787 | 27
 355 |  214 | 1064 | 1007 | 67
 374 | 1822 |  273 |  216 |  5
 394 |  462 |  493 |  436 | 45
(20 rows)

DROP VIEW bitmap_test_mv;
CREATE VIEW bitmap_test_mv AS (SELECT * FROM bitmap_test WHERE i < 100 AND j < 100 AND k < 200 OR h < 100 LIMIT 20);
EXPLAIN (COSTS OFF) SELECT count(*) FROM bitmap_test_mv;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Aggregate
   ->  Limit
         ->  Result
               ->  Custom Scan (o_scan) on bitmap_test
                     Bitmap heap scan
                     Recheck Cond: (((i < 100) AND (j < 100) AND (k < 200)) OR (h < 100))
                     ->  BitmapOr
                           ->  BitmapAnd
                                 ->  Bitmap Index Scan on bitmap_test_ix1
                                       Index Cond: (i < 100)
                                 ->  Bitmap Index Scan on bitmap_test_ix2
                                       Index Cond: (j < 100)
                                 ->  Bitmap Index Scan on bitmap_test_ix3
                                       Index Cond: (k < 200)
                           ->  Bitmap Index Scan on bitmap_test_ix4
                                 Index Cond: (h < 100)
(16 rows)

SELECT count(*) FROM bitmap_test_mv;
 count 
-------
    20
(1 row)

SELECT * FROM bitmap_test_mv;
 id  |  i   |  j   |  k   | h  
-----+------+------+------+----
   2 | 1918 |  181 |  124 | 61
  41 |  166 | 1610 | 1553 | 39
  61 |  806 | 1830 | 1773 | 79
  80 |  414 | 1039 |  982 | 17
 100 | 1054 | 1259 | 1202 | 57
 120 | 1694 | 1479 | 1422 | 97
 139 | 1302 |  688 |  631 | 35
 159 | 1942 |  908 |  851 | 75
 178 | 1550 |  117 |   60 | 13
 198 |  190 |  337 |  280 | 53
 218 |  830 |  557 |  500 | 93
 237 |  438 | 1766 | 1709 | 31
 257 | 1078 | 1986 | 1929 | 71
 276 |  686 | 1195 | 1138 |  9
 296 | 1326 | 1415 | 1358 | 49
 316 | 1966 | 1635 | 1578 | 89
 335 | 1574 |  844 |  787 | 27
 355 |  214 | 1064 | 1007 | 67
 374 | 1822 |  273 |  216 |  5
 394 |  462 |  493 |  436 | 45
(20 rows)

DROP VIEW bitmap_test_mv;
RESET enable_seqscan;
CREATE TABLE test_no_bmscan_on_text_pkey (data1 text PRIMARY KEY, data2 text, data3 text, i int) USING orioledb;
CREATE INDEX ON test_no_bmscan_on_text_pkey USING spgist (data2);
NOTICE:  index bridging is enabled for orioledb table 'test_no_bmscan_on_text_pkey'
DETAIL:  index access method 'spgist' is supported only via index bridging for OrioleDB table
INSERT INTO test_no_bmscan_on_text_pkey VALUES('foofoo','barbar', 'aaaaaa', 1);
INSERT INTO test_no_bmscan_on_text_pkey VALUES('mmm','nnn', 'ooo', 2);
SELECT data3 from test_no_bmscan_on_text_pkey where data3 = 'aaaaaa';
 data3  
--------
 aaaaaa
(1 row)

SELECT orioledb_tbl_indices('test_no_bmscan_on_text_pkey'::regclass, true);
                        orioledb_tbl_indices                        
--------------------------------------------------------------------
 Index test_no_bmscan_on_text_pkey_pkey                            +
     Index type: primary, unique                                   +
     Leaf tuple size: 5, non-leaf tuple size: 1                    +
     Non-leaf tuple fields: data1                                  +
     Leaf tuple fields: index_bridging_ctid, data1, data2, data3, i+
 Index index_bridge                                                +
     Index type: secondary                                         +
     Leaf tuple size: 2, non-leaf tuple size: 1                    +
     Non-leaf tuple fields: index_bridging_ctid                    +
     Leaf tuple fields: index_bridging_ctid, data1                 +
 Index toast                                                       +
     Index type: secondary                                         +
     Leaf tuple size: 4, non-leaf tuple size: 3                    +
     Non-leaf tuple fields: data1, attnum, chunknum                +
     Leaf tuple fields: data1, attnum, chunknum, data              +
 
(1 row)

EXPLAIN (COSTS OFF) SELECT data2 from test_no_bmscan_on_text_pkey where data2 = 'barbar';
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Index Only Scan using test_no_bmscan_on_text_pkey_data2_idx on test_no_bmscan_on_text_pkey
   Index Cond: (data2 = 'barbar'::text)
(2 rows)

SELECT data2 from test_no_bmscan_on_text_pkey where data2 = 'barbar';
 data2  
--------
 barbar
(1 row)

-- Test bridge index behavior when table is truncated.
CREATE TABLE brin_test_multi (a INT, b BIGINT) using orioledb WITH (fillfactor=10) ;
INSERT INTO brin_test_multi
SELECT i/5 + mod(911 * i + 483, 25),
       i/10 + mod(751 * i + 221, 41)
  FROM generate_series(1,1000) s(i);
SELECT COUNT(*) FROM brin_test_multi WHERE a < 37;
 count 
-------
   124
(1 row)

CREATE INDEX brin_test_multi_idx ON brin_test_multi USING brin (a int4_minmax_multi_ops) WITH (pages_per_range=5);
NOTICE:  index bridging is enabled for orioledb table 'brin_test_multi'
DETAIL:  index access method 'brin' is supported only via index bridging for OrioleDB table
SELECT orioledb_tbl_indices('brin_test_multi'::regclass, true);
                  orioledb_tbl_indices                  
--------------------------------------------------------
 Index ctid_primary                                    +
     Index type: primary, unique, ctid                 +
     Leaf tuple size: 4, non-leaf tuple size: 1        +
     Non-leaf tuple fields: ctid                       +
     Leaf tuple fields: ctid, index_bridging_ctid, a, b+
 Index index_bridge                                    +
     Index type: secondary                             +
     Leaf tuple size: 2, non-leaf tuple size: 1        +
     Non-leaf tuple fields: index_bridging_ctid        +
     Leaf tuple fields: index_bridging_ctid, ctid      +
 Index toast                                           +
     Index type: secondary                             +
     Leaf tuple size: 4, non-leaf tuple size: 3        +
     Non-leaf tuple fields: ctid, attnum, chunknum     +
     Leaf tuple fields: ctid, attnum, chunknum, data   +
 
(1 row)

\d+ brin_test_multi
                          Table "index_bridging.brin_test_multi"
 Column |  Type   | Collation | Nullable | Default | Storage | Stats target | Description 
--------+---------+-----------+----------+---------+---------+--------------+-------------
 a      | integer |           |          |         | plain   |              | 
 b      | bigint  |           |          |         | plain   |              | 
Indexes:
    "brin_test_multi_idx" brin (a int4_minmax_multi_ops) WITH (pages_per_range='5')
Options: fillfactor=10, index_bridging=true

TRUNCATE brin_test_multi;
SELECT orioledb_tbl_indices('brin_test_multi'::regclass, true);
                  orioledb_tbl_indices                  
--------------------------------------------------------
 Index ctid_primary                                    +
     Index type: primary, unique, ctid                 +
     Leaf tuple size: 4, non-leaf tuple size: 1        +
     Non-leaf tuple fields: ctid                       +
     Leaf tuple fields: ctid, index_bridging_ctid, a, b+
 Index index_bridge                                    +
     Index type: secondary                             +
     Leaf tuple size: 2, non-leaf tuple size: 1        +
     Non-leaf tuple fields: index_bridging_ctid        +
     Leaf tuple fields: index_bridging_ctid, ctid      +
 Index toast                                           +
     Index type: secondary                             +
     Leaf tuple size: 4, non-leaf tuple size: 3        +
     Non-leaf tuple fields: ctid, attnum, chunknum     +
     Leaf tuple fields: ctid, attnum, chunknum, data   +
 
(1 row)

\d+ brin_test_multi
                          Table "index_bridging.brin_test_multi"
 Column |  Type   | Collation | Nullable | Default | Storage | Stats target | Description 
--------+---------+-----------+----------+---------+---------+--------------+-------------
 a      | integer |           |          |         | plain   |              | 
 b      | bigint  |           |          |         | plain   |              | 
Indexes:
    "brin_test_multi_idx" brin (a int4_minmax_multi_ops) WITH (pages_per_range='5')
Options: fillfactor=10, index_bridging=true

INSERT INTO brin_test_multi
SELECT i/5 + mod(911 * i + 483, 25),
       i/10 + mod(751 * i + 221, 41)
  FROM generate_series(1,1000) s(i);
set enable_seqscan = off;
EXPLAIN SELECT COUNT(*) FROM brin_test_multi WHERE a < 37;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Aggregate  (cost=244.38..244.39 rows=1 width=8)
   ->  Custom Scan (o_scan) on brin_test_multi  (cost=13.07..233.80 rows=4233 width=0)
         Bitmap heap scan
         Recheck Cond: (a < 37)
         ->  Bitmap Index Scan on brin_test_multi_idx  (cost=0.00..12.02 rows=12698 width=0)
               Index Cond: (a < 37)
(6 rows)

SELECT COUNT(*) FROM brin_test_multi WHERE a < 37;
 count 
-------
   124
(1 row)

CREATE TEMP TABLE hash_i4_heap (
    seqno   int4,
    random  int4
) USING orioledb;
INSERT INTO hash_i4_heap VALUES (20000, 1492795354);
CREATE INDEX hash_i4_index ON hash_i4_heap USING hash (random int4_ops);
NOTICE:  index bridging is enabled for orioledb table 'hash_i4_heap'
DETAIL:  index access method 'hash' is supported only via index bridging for OrioleDB table
SELECT * FROM hash_index_content('hash_i4_index');
ERROR:  function hash_index_content(unknown) does not exist
LINE 1: SELECT * FROM hash_index_content('hash_i4_index');
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
UPDATE hash_i4_heap
   SET seqno = 20000
 WHERE random = 1492795354;
SELECT * FROM hash_index_content('hash_i4_index');
ERROR:  function hash_index_content(unknown) does not exist
LINE 1: SELECT * FROM hash_index_content('hash_i4_index');
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
BEGIN;
SET LOCAL enable_seqscan = OFF;
SET LOCAL enable_bitmapscan = OFF;
EXPLAIN (COSTS OFF) SELECT h.seqno AS i20000
  FROM hash_i4_heap h
 WHERE h.random = 1492795354;
                    QUERY PLAN                    
--------------------------------------------------
 Index Scan using hash_i4_index on hash_i4_heap h
   Index Cond: (random = 1492795354)
(2 rows)

SELECT h.seqno AS i20000
  FROM hash_i4_heap h
 WHERE h.random = 1492795354;
 i20000 
--------
  20000
(1 row)

COMMIT;
SELECT * FROM hash_i4_heap ORDER BY seqno;
 seqno |   random   
-------+------------
 20000 | 1492795354
(1 row)

CREATE TEMP TABLE gin_test_table (
    id   serial PRIMARY KEY,
    tags int4[]
) USING orioledb;
INSERT INTO gin_test_table (id, tags) VALUES
(411, '{802, 654}'::int[]),
(412, '{814, 738}'::int[]);  -- This row will be updated
CREATE INDEX idx_gin_tags ON gin_test_table USING gin (tags);
NOTICE:  index bridging is enabled for orioledb table 'gin_test_table'
DETAIL:  index access method 'gin' is supported only via index bridging for OrioleDB table
UPDATE gin_test_table
SET id = 20000
WHERE tags @> '{814}';
BEGIN;
SET LOCAL enable_seqscan = OFF;
-- SET LOCAL enable_bitmapscan = OFF;
EXPLAIN (COSTS OFF) SELECT id, tags
FROM gin_test_table
WHERE tags @> '{814}';
                    QUERY PLAN                    
--------------------------------------------------
 Custom Scan (o_scan) on gin_test_table
   Bitmap heap scan
   Recheck Cond: (tags @> '{814}'::integer[])
   ->  Bitmap Index Scan on idx_gin_tags
         Index Cond: (tags @> '{814}'::integer[])
(5 rows)

SELECT id, tags
FROM gin_test_table
WHERE tags @> '{814}';
  id   |   tags    
-------+-----------
 20000 | {814,738}
(1 row)

COMMIT;
DROP EXTENSION pageinspect;
ERROR:  extension "pageinspect" does not exist
DROP EXTENSION orioledb CASCADE;
NOTICE:  drop cascades to 17 other objects
DETAIL:  drop cascades to table o_test_ix_ams
drop cascades to table o_test_bridging_with_regular_no_pkey
drop cascades to table o_test_bridging_with_regular_pkey
drop cascades to table o_test_bitmap_scans
drop cascades to table o_test_index_bridging_options
drop cascades to table o_test_non_index_bridging_options
drop cascades to table o_test_toastable_offset
drop cascades to table o_test_bridged_hash_btree_bitmap_scans
drop cascades to table o_test_bridged_index_only_scan
drop cascades to table o_test_toast_with_bridged
drop cascades to table size_test
drop cascades to table tbl_with_pkey_bridged_toast
drop cascades to table bitmap_test
drop cascades to table test_no_bmscan_on_text_pkey
drop cascades to table brin_test_multi
drop cascades to table hash_i4_heap
drop cascades to table gin_test_table
DROP SCHEMA index_bridging CASCADE;
NOTICE:  drop cascades to 3 other objects
DETAIL:  drop cascades to function generate_string(integer,integer)
drop cascades to table refresh_tokens
drop cascades to table one_time_tokens
RESET search_path;
